using System;
using System.Collections;
using System.ComponentModel;
using System.Drawing;
using System.Web;
using System.Web.SessionState;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using System.Data.SqlClient;

namespace eform
{
	/// <summary>
	/// Summary description for submit.
	/// </summary>

	public class submit : System.Web.UI.Page
	{
		protected PlaceHolder Survey;
		protected PlaceHolder SurveyButtons;
		protected Label SurveyIntro;
		protected PlaceHolder FixedButtons;

		// total completed count
		int totalCompletedCX = 0;

		int surveyID = 0;
		int langID = 0;
		int projectID = 0;
		int projectRoundID = 0;
		int projectRoundUnitID = 0;
		int projectRoundUserID = 0;
		int answerID = 0;
		string userKey = "";
		bool finished = false;
		bool save = false;
		bool newAnswer = true;
		string answerKey = "";
		bool repeated = false;
		bool first = true;
		int currentPage = 1;
		bool changePage = false;
		bool showMode = false;
		bool warn = false;
		bool useCode = false;
		bool allInOnePage = false;
		bool sftp = false, sendSurveyAsEmail = false;

		string surveyURL = projectSetup.appURL;

		int missingOnCurrentPage = 0;
		int warnOnCurrentPage = 0;

		System.Collections.ArrayList missingValues = new System.Collections.ArrayList();
		System.Collections.ArrayList missingQuestions = new System.Collections.ArrayList();
		System.Collections.ArrayList warnQuestions = new System.Collections.ArrayList();
		System.Collections.ArrayList dependentQuestions = new System.Collections.ArrayList();
		System.Collections.ArrayList preQuestions = new System.Collections.ArrayList();
		System.Collections.Hashtable oldValues = new System.Collections.Hashtable();
		System.Collections.Hashtable preValues = new System.Collections.Hashtable();

		int sessionID = 0;

		public int layout = 0;
		string surveyName = "", surveyIntro = "", thankYou = "";
		bool hasEmail = false;

		public int lang(){return langID;}
		public static string strFloatToStr(string s)
		{
			s = s.Trim();
			s = s.Replace(",",System.Globalization.NumberFormatInfo.CurrentInfo.NumberDecimalSeparator);
			s = s.Replace(".",System.Globalization.NumberFormatInfo.CurrentInfo.NumberDecimalSeparator);
			return s;
		}

		public static string strFloatToSqlStr(string s)
		{
			s = s.Trim();
			s = s.Replace("'","");
			s = s.Replace(",",".");
			return (s == "" ? "NULL" : s);
		}
		public string printLogo()
		{
			return printLogo(projectID);
		}
		public static string printLogo(int pid)
		{
			string logo = "";

			if(System.IO.File.Exists(HttpContext.Current.Server.MapPath("img\\project\\logo" + pid + ".gif")))
			{
				logo = "<img src=\"img/project/logo" + pid + ".gif?Rnd=" + (new Random(unchecked((int)DateTime.Now.Ticks))).Next() + "\">";
			}

			return logo;
		}
		public string printRoundLogo()
		{
			return printRoundLogo(projectID,projectRoundID);
		}
		public static string printRoundLogo(int pid, int prid)
		{
			string logo = "<img src=\"submitImages/eform_logga.gif\">";

			if(prid != 0 && System.IO.File.Exists(HttpContext.Current.Server.MapPath("img\\project\\logo" + pid + "_" + prid + ".gif")))
			{
				logo = "<img src=\"img/project/logo" + pid + "_" + prid + ".gif?Rnd=" + (new Random(unchecked((int)DateTime.Now.Ticks))).Next() + "\">";
			}

			return logo;
		}

		public static string version()
		{
			return System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.ToString().Replace(".","").Replace(",",".");
		}

		public string printSurveyName()
		{
			return surveyName;
		}

		private void Page_Load(object sender, System.EventArgs e)
		{
			HttpContext.Current.Response.Charset = "UTF-8";
			HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.UTF8;
//			HttpContext.Current.Response.Charset = "ISO-8859-1";
//			HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.GetEncoding("ISO-8859-1");
			HttpContext.Current.Response.Cache.SetCacheability(System.Web.HttpCacheability.NoCache);

			if(HttpContext.Current.Request.Form != null)
			{
				System.Text.StringBuilder debug = new System.Text.StringBuilder();
				try
				{
					foreach(string d in HttpContext.Current.Request.Form.AllKeys)
					{
						debug.Append(d + " = " + (HttpContext.Current.Request.Form[d] != null ? HttpContext.Current.Request.Form[d] : "") + "\r\n");
					}
				}
				catch(Exception){}
				Db.sqlExecute("INSERT INTO Debug (DebugTxt) VALUES ('" + debug.Replace("'","''") + "')");
			}

			//HttpContext.Current.Response.ExpiresAbsolute = DateTime.UtcNow.Subtract(new TimeSpan(1,0,0,0));
			//HttpContext.Current.Response.Expires = -1;
			//HttpContext.Current.Response.CacheControl = "no-cache";

			if(HttpContext.Current.Request.QueryString["RL"] != null)
			{
				Page.RegisterStartupScript("RELOAD","<script type=\"text/JavaScript\" language=\"JavaScript\">if(window.opener){window.opener.location+='1';}</script>");
			}

			//HttpContext.Current.Session.Timeout = 60;

			SurveyIntro.Text = "";

			surveyID = (HttpContext.Current.Request.QueryString["SID"] != null ? Convert.ToInt32(HttpContext.Current.Request.QueryString["SID"]) : 0);
			langID = (HttpContext.Current.Request.QueryString["LID"] != null ? Convert.ToInt32(HttpContext.Current.Request.QueryString["LID"]) : 0);
			projectRoundID = (HttpContext.Current.Request.QueryString["PRID"] != null ? Convert.ToInt32(HttpContext.Current.Request.QueryString["PRID"]) : 0);
			projectID = (HttpContext.Current.Request.QueryString["PID"] != null ? Convert.ToInt32(HttpContext.Current.Request.QueryString["PID"]) : 0);
			layout = (HttpContext.Current.Request.QueryString["Layout"] != null ? Convert.ToInt32(HttpContext.Current.Request.QueryString["Layout"]) : 0);
			allInOnePage = (HttpContext.Current.Request.QueryString["AIOP"] != null);

			currentPage = (HttpContext.Current.Request.Form["CP"] != null ? Convert.ToInt32(HttpContext.Current.Request.Form["CP"]) : 1);

			warn = (HttpContext.Current.Request.Form["Warn"] != null && Convert.ToInt32(HttpContext.Current.Request.Form["Warn"]) == 1);

			userKey = (HttpContext.Current.Request.QueryString["K"] != null ? HttpContext.Current.Request.QueryString["K"] : "");
			if(userKey.Length > 8)
			{
				try
				{
					if(userKey.StartsWith("U"))
					{
						#region By unit ID
						projectRoundUnitID = Convert.ToInt32(userKey.Substring(9));

						bool selfRegistration = false;

						#region Fetch ProjectRoundID, ProjectRoundUnitID, SurveyID, LangID
						SqlDataReader rs = Db.sqlRecordSet("SELECT " +
							"u.ProjectRoundUnitID, " +
							"dbo.cf_unitSurveyID(u.ProjectRoundUnitID), " +
							"dbo.cf_unitLangID(u.ProjectRoundUnitID), " +
							"r.SurveyID, " +
							"r.LangID, " +
							"u.ProjectRoundID, " +
							"r.Layout, " +
							"r.ProjectID, " +
							"r.SelfRegistration, " +
							"r.RepeatedEntry, " +
							"r.SFTPhost, " +
							"r.SendSurveyAsEmail " +
							"FROM ProjectRoundUnit u " +
							"INNER JOIN ProjectRound r ON u.ProjectRoundID = r.ProjectRoundID " +
							"WHERE u.ProjectRoundUnitID = " + projectRoundUnitID + " " +
							"AND LEFT(CONVERT(VARCHAR(255),u.UnitKey),8) = '" + userKey.Replace("'","").Substring(1,8) + "'");
						if(rs.Read())
						{
							surveyID = (rs.IsDBNull(1) ? rs.GetInt32(3) : rs.GetInt32(1));
							if(langID == 0)
							{
								langID = (rs.IsDBNull(2) ? rs.GetInt32(4) : rs.GetInt32(2));
							}
							projectRoundID = rs.GetInt32(5);
							layout = (!rs.IsDBNull(6) ? rs.GetInt32(6) : 0);
							projectID = rs.GetInt32(7);
							if(!rs.IsDBNull(8) && rs.GetInt32(8) == 1)
							{
								selfRegistration = true;
							}
							repeated = (rs.GetInt32(9) != 0);
							if(!rs.IsDBNull(10))
							{
								sftp = true;
							}
							if(!rs.IsDBNull(11))
							{
								sendSurveyAsEmail = true;
							}
						}
						rs.Close();
						#endregion

						if(!IsPostBack && selfRegistration)
						{
							projectRoundUserID = projectSetup.createUser(projectRoundID,projectRoundUnitID.ToString(),(HttpContext.Current.Request.QueryString["Email"] != null ? HttpContext.Current.Request.QueryString["Email"].ToString() : "notset"));
							rs = Db.sqlRecordSet("SELECT UserKey FROM ProjectRoundUser WHERE ProjectRoundUserID = " + projectRoundUserID);
							if(rs.Read())
							{
								userKey = "" + rs.GetGuid(0).ToString().Substring(0,8) + projectRoundUserID.ToString();
							}
							else
							{
								projectRoundUserID = 0;
							}
							rs.Close();

							if(userKey != "" && projectRoundUserID != 0)
							{
								int qo = 0;
								string qs = "";
								rs = Db.sqlRecordSet("SELECT QuestionID, OptionID FROM ProjectRoundQO WHERE ProjectRoundID = " + projectRoundID + " ORDER BY SortOrder");
								while(rs.Read())
								{
									qo++;
									if(HttpContext.Current.Request.QueryString["QO" + qo] != null && HttpContext.Current.Request.QueryString["QO" + qo].ToString() != "")
									{
										//qs += "&QO" + qo + "=" + HttpContext.Current.Request.QueryString["QO" + qo].ToString();
										Db.sqlExecute("INSERT INTO ProjectRoundUserQO (ProjectRoundUserID,QuestionID,OptionID,Answer) VALUES (" + projectRoundUserID + "," + rs.GetInt32(0) + "," + rs.GetInt32(1) + ",'" + HttpContext.Current.Request.QueryString["QO" + qo].ToString().Replace("'","''") + "')");
									}
								}
								rs.Close();
								HttpContext.Current.Response.Redirect("submit.aspx?K=" + userKey + qs,true);
							}
						}

						if(IsPostBack && HttpContext.Current.Request.Form["AK"] != null)
						{
							answerKey = HttpContext.Current.Request.Form["AK"].ToString();
							rs = Db.sqlRecordSet("SELECT EndDT, AnswerID FROM Answer WHERE REPLACE(CONVERT(VARCHAR(255),AnswerKey),'-','') = '" + answerKey.Replace("'","") + "'");
							if(rs.Read())
							{
								answerID = rs.GetInt32(1);
								if(!rs.IsDBNull(0))
								{
									finished = true;
								}
							}
							else
							{
								answerKey = "";
							}
							rs.Close();
						}
						#endregion
					}
					else
					{
						#region By user ID

						projectRoundUserID = Convert.ToInt32(userKey.Substring(8));

						#region Fetch ProjectRoundID, ProjectRoundUnitID, SurveyID, LangID
						SqlDataReader rs = Db.sqlRecordSet("SELECT " +
							"u.ProjectRoundUnitID, " +						// 0
							"dbo.cf_unitSurveyID(u.ProjectRoundUnitID), " +	// 1
							"dbo.cf_unitLangID(u.ProjectRoundUnitID), " +	// 2
							"r.SurveyID, " +								// 3
							"r.LangID, " +									// 4
							"u.ProjectRoundID, " +							// 5
							"r.Layout, " +									// 6
							"r.ProjectID, " +								// 7
							"(SELECT COUNT(*) FROM Answer a WHERE a.EndDT IS NOT NULL AND a.ProjectRoundUserID = u.ProjectRoundUserID), " +	// 8
							"r.RepeatedEntry, " +							// 9
							"u.Extended, " +								// 10
							"r.ExtendedSurveyID, " +						// 11
							"p.AppURL, " +									// 12
							"r.UseCode, " +									// 13
							"r.SFTPhost, " +								// 14
							"r.SendSurveyAsEmail, " +						// 15
							"u.Email " +									// 16
							"FROM ProjectRoundUser u " +
							"INNER JOIN ProjectRound r ON u.ProjectRoundID = r.ProjectRoundID " +
							"INNER JOIN Project p ON r.ProjectID = p.ProjectID " +
							"WHERE u.ProjectRoundUserID = " + projectRoundUserID + " " +
							"AND LEFT(CONVERT(VARCHAR(255),u.UserKey),8) = '" + userKey.Replace("'","").Substring(0,8) + "'");
						if(rs.Read())
						{
							projectRoundUnitID = (rs.IsDBNull(0) ? 0 : rs.GetInt32(0));
							surveyID = (!rs.IsDBNull(10) && !rs.IsDBNull(11) ? rs.GetInt32(11) : (rs.IsDBNull(1) ? rs.GetInt32(3) : rs.GetInt32(1)));
							if(langID == 0)
							{
								langID = (rs.IsDBNull(2) ? rs.GetInt32(4) : rs.GetInt32(2));
							}
							projectRoundID = rs.GetInt32(5);
							layout = (!rs.IsDBNull(6) ? rs.GetInt32(6) : 0);
							projectID = rs.GetInt32(7);
							first = (Convert.ToInt32(rs.GetValue(8)) == 0);
							repeated = (rs.GetInt32(9) != 0);
							if(!rs.IsDBNull(12))
							{
								surveyURL = rs.GetString(12);
							}
							useCode = (!rs.IsDBNull(13) && rs.GetInt32(13) == 1);
							if(!rs.IsDBNull(14))
							{
								sftp = true;
							}
							if(!rs.IsDBNull(15))
							{
								sendSurveyAsEmail = true;
							}
							hasEmail = (!rs.IsDBNull(16) && projectSetup.isEmail(rs.GetString(16)));
						}
						else
						{
							projectRoundUserID = 0;
						}
						rs.Close();
						#endregion

						if(projectRoundUserID != 0)
						{
							string SM = (HttpContext.Current.Request.QueryString["SM"] != null ? HttpContext.Current.Request.QueryString["SM"].ToString().Replace("'","").ToLower() : "");

							#region Fetch AnswerID and check for Finished
							rs = Db.sqlRecordSet("SELECT " +
								"TOP 1 " +
								"AnswerID, " +
								"EndDT, " +
								"REPLACE(CONVERT(VARCHAR(255),AnswerKey),'-','') AS AK, " +
								"CurrentPage, " +
								"ExtendedFirst " +
								"FROM Answer " +
								"WHERE ProjectRoundUserID = " + projectRoundUserID + " " +
								(SM != "" ? "AND LOWER(LEFT(REPLACE(CONVERT(VARCHAR(255),AnswerKey),'-',''),8)) = '" + SM + "' " : "") +
								"ORDER BY AnswerID DESC");
							if(rs.Read())
							{
								answerID = rs.GetInt32(0);
								answerKey = rs.GetString(2);

								if(!rs.IsDBNull(1) && HttpContext.Current.Request.QueryString["Edit"] != null)
								{
									Db.sqlExecute("UPDATE Answer SET EndDT = NULL WHERE AnswerID = " + answerID);
								}

								if(!rs.IsDBNull(1) && HttpContext.Current.Request.QueryString["Edit"] == null)
								{
									if(!IsPostBack && repeated && SM == "")
									{
										answerID = 0;
										answerKey = "";
									}
									else
									{
										if(SM == answerKey.Substring(0,8).ToLower())
										{
											showMode = true;
											first = (!rs.IsDBNull(4));
											if(!IsPostBack)
											{
												currentPage = 1;
											}
										}
										else
										{
											finished = true;
										}
									}
								}
								else if(!rs.IsDBNull(3) && !IsPostBack)
								{
									currentPage = rs.GetInt32(3);
								}
							}
							rs.Close();
							#endregion

							rs = Db.sqlRecordSet("SELECT DISTINCT QuestionID, OptionID, Answer FROM ProjectRoundUserQO WHERE Answer IS NOT NULL AND Answer <> '' AND ProjectRoundUserID = " + projectRoundUserID);
							while(rs.Read())
							{
								if(!preQuestions.Contains(rs.GetInt32(0)))
								{
									preQuestions.Add(rs.GetInt32(0));
								}
								if(!preValues.Contains("Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1)))
								{
									preValues.Add("Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1),rs.GetString(2));
								}
								if(answerID == 0)
								{
									if(!oldValues.Contains("Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1)))
									{
										oldValues.Add("Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1),rs.GetString(2));
									}
								}
							}
							rs.Close();
						}
						#endregion
					}

					if(projectRoundID != 0 && projectRoundUnitID != 0)
					{
						if(answerID == 0)
						{
							#region Create new AnswerID
							Db.sqlExecute("INSERT INTO Answer (" +
								"ProjectRoundID, " +
								"ProjectRoundUnitID, " +
								"ProjectRoundUserID, " +
								"ExtendedFirst" +
								") VALUES (" +
								"" + projectRoundID + "," +
								"" + projectRoundUnitID + "," +
								"" + (projectRoundUserID != 0 ? "" + projectRoundUserID : "NULL") + "," +
								"" + (first ? "1" : "NULL") + "" +
								")");
							SqlDataReader rs = Db.sqlRecordSet("SELECT " +
								"TOP 1 " +
								"AnswerID, " +
								"REPLACE(CONVERT(VARCHAR(255),AnswerKey),'-','') " +
								"FROM Answer " +
								"WHERE EndDT IS NULL " +
								"AND " + (projectRoundUserID != 0 ? "ProjectRoundUserID = " + projectRoundUserID : "ProjectRoundUnitID = " + projectRoundUnitID) + " " +
								"ORDER BY AnswerID DESC");
							if(rs.Read())
							{
								answerID = rs.GetInt32(0);
								answerKey = rs.GetString(1);
							}
							rs.Close();
							#endregion
						}
						else
						{
							#region Returning user/request
							newAnswer = false;

							int tempPageCX = 1;
							int tempSQ = 0;

							if(!showMode)
							{
								Db.sqlExecute("UPDATE Answer SET CurrentPage = " + currentPage + " WHERE AnswerID = " + answerID);
							}

							SqlDataReader rs = Db.sqlRecordSet("SELECT " +
								"sq.QuestionID, " +	// 0
								"qo.OptionID, " +	// 1
								"o.OptionType, " +	// 2
								"sqo.Forced, " +	// 3
								(allInOnePage ? "NULL, " : "sq.PageBreakBeforeQuestion, ") +		// 4
								"sq.SurveyQuestionID, " +				// 5
								"sqo.Warn " +		// 6
								"FROM SurveyQuestion sq " +
								"LEFT OUTER JOIN SurveyQuestionOption sqo ON sq.SurveyQuestionID = sqo.SurveyQuestionID " + 
								"LEFT OUTER JOIN QuestionOption qo ON sqo.QuestionOptionID = qo.QuestionOptionID AND qo.Hide IS NULL " + 
								"LEFT OUTER JOIN [Option] o ON qo.OptionID = o.OptionID " + 
								"WHERE sq.SurveyID = " + surveyID + " " +
								(!first ? "AND (sq.ExtendedFirst IS NULL OR sq.ExtendedFirst = 0) " : "" ) +
								"ORDER BY sq.SortOrder");
							while(rs.Read())
							{
								if(!rs.IsDBNull(4) && tempSQ != rs.GetInt32(0))
								{
									tempPageCX++;
								}
								tempSQ = rs.GetInt32(0);

								if(!rs.IsDBNull(1))
								{
									string val = "", newVal = "";

									bool hasPreVal = preValues.Contains("Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1));

									if(IsPostBack && !showMode)
									{
										newVal = (HttpContext.Current.Request.Form["Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1)] != null ? HttpContext.Current.Request.Form["Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1)].ToString() : "");

										switch(rs.GetInt32(2))
										{
											case 9:
											{
												//if(newVal != "")
												//{
													//newVal = (HttpContext.Current.Request.Form["VASvalue" + newVal] != null ? HttpContext.Current.Request.Form["VASvalue" + newVal].ToString() : "");
												//}
												newVal = newVal.Replace("NULL","");
											}
												break;
										}
									}

									if(tempPageCX == currentPage || !IsPostBack || showMode)
									{
										bool hasOldVal = false;

										if(hasPreVal && !IsPostBack)
										{
											hasOldVal = true;
										
											val = preValues["Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1)].ToString();
										}
										else
										{
											SqlDataReader rs2 = Db.sqlRecordSet("SELECT ValueInt, ISNULL(ValueTextJapaneseUnicode,ValueText), ValueDecimal FROM AnswerValue WHERE AnswerID = " + answerID + " AND QuestionID = " + rs.GetInt32(0) + " AND OptionID = " + rs.GetInt32(1) + " AND DeletedSessionID IS NULL");
											if(rs2.Read())
											{
												hasOldVal = true;

												#region Fetch previously stored value
												switch(rs.GetInt32(2))
												{
													case 1:
													{
														if(!rs.IsDBNull(0))
														{
															val = rs2.GetInt32(0).ToString();
														}
														break;
													}
													case 2:
													{
														if(!rs.IsDBNull(1))
														{
															val = rs2.GetString(1);
														}
														break;
													}
													case 3:
													{
														goto case 1;
													}
													case 4:
													{
														if(!rs.IsDBNull(2))
														{
															val = ((float)rs2.GetDecimal(2)).ToString();
														}
														break;
													}
													case 9:
													{
														goto case 1;
													}
												}
												#endregion
											}
											rs2.Close();
										}

										if(IsPostBack && !showMode)
										{
											if(newVal != val)
											{
												if(hasOldVal)
												{
													Db.sqlExecute("UPDATE AnswerValue SET DeletedSessionID = " + sessionID + " WHERE AnswerID = " + answerID + " AND QuestionID = " + rs.GetInt32(0) + " AND OptionID = " + rs.GetInt32(1) + " AND DeletedSessionID IS NULL");
												}
							
												if(newVal != "")
												{
													#region Save new value
													switch(rs.GetInt32(2))
													{
														case 1:
														{
															Db.sqlExecute("INSERT INTO AnswerValue (AnswerID,QuestionID,OptionID,ValueInt,CreatedSessionID) VALUES (" + answerID + "," + rs.GetInt32(0) + "," + rs.GetInt32(1) + "," + newVal.Replace("'","") + "," + sessionID + ")");
															break;
														}
														case 2:
														{
															/*System.Text.Encoding iso = System.Text.Encoding.GetEncoding("ISO-8859-1"); 
															System.Text.Encoding utf8 = System.Text.Encoding.UTF8;
															byte[] utfBytes = utf8.GetBytes(newVal); 
															byte[] isoBytes = System.Text.Encoding.Convert(utf8, iso, utfBytes); 
															string convertedVal = iso.GetString(isoBytes);*/
															string convertedVal = newVal;

//															string x1 = HttpContext.Current.Response.Charset;
//															System.Text.Encoding x2 = HttpContext.Current.Response.ContentEncoding;
//															HttpContext.Current.Response.Charset = "iso-8859-1";
//															HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.GetEncoding("iso-8859-1");

															Db.sqlExecute("INSERT INTO AnswerValue (AnswerID,QuestionID,OptionID,ValueText,CreatedSessionID,ValueTextJapaneseUnicode) VALUES (" + answerID + "," + rs.GetInt32(0) + "," + rs.GetInt32(1) + ",'" + convertedVal.Replace("'","''") + "'," + sessionID + ",N'" + convertedVal.Replace("'","''") + "')");

															//HttpContext.Current.Response.Write("<!-- " + HttpContext.Current.Request.Form["Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1)] + "-->");

//															HttpContext.Current.Response.Charset = x1;
//															HttpContext.Current.Response.ContentEncoding = x2;
															break;
														}
														case 3:
														{
															goto case 1;
														}
														case 4:
														{
															try
															{
																decimal newValIns = Convert.ToDecimal(strFloatToStr(newVal));
																SqlDataReader rs2 = Db.sqlRecordSet("SELECT RangeLow, RangeHigh FROM [Option] WHERE (RangeLow IS NOT NULL OR RangeHigh IS NOT NULL) AND OptionID = " + rs.GetInt32(1));
																if(rs2.Read())
																{
																	if(!rs2.IsDBNull(0) && newValIns < rs2.GetDecimal(0) || !rs2.IsDBNull(1) && newValIns > rs2.GetDecimal(1))
																	{
																		rs2.Close();
																		throw(new Exception());
																	}
																}
																rs2.Close();
																Db.sqlExecute("INSERT INTO AnswerValue (AnswerID,QuestionID,OptionID,ValueDecimal,CreatedSessionID) VALUES (" + answerID + "," + rs.GetInt32(0) + "," + rs.GetInt32(1) + "," + newValIns.ToString().Replace(",",".") + "," + sessionID + ")");
															}
															catch(Exception)
															{
																newVal = "";
															}
															break;
														}
														case 9:
														{
															goto case 1;
														}
													}
													#endregion
												}
											}
										}

										if(!hasPreVal && (IsPostBack && newVal != "" || !IsPostBack && hasOldVal))
										{
											totalCompletedCX++;
										}
									}
									else if(!hasPreVal && (tempPageCX < currentPage || newVal != ""))
									{
										totalCompletedCX++;
									}

									if(IsPostBack && !showMode)
									{
										val = newVal;
									}

									oldValues.Add("Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1), HttpUtility.HtmlEncode(val));
									if(val == "" && rs.GetInt32(3) == 1 && !showMode)
									{
										// No value and forced

										missingValues.Add("Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1));
										if(!missingQuestions.Contains("Q" + rs.GetInt32(0)))
										{
											missingQuestions.Add("Q" + rs.GetInt32(0));
											if(tempPageCX == currentPage)
											{
												bool show = true;
												if(HttpContext.Current.Request.QueryString["SAH"] == null)
												{
													SqlDataReader rs3 = Db.sqlRecordSet("SELECT " +
														"sqi.QuestionID, " +
														"sqi.OptionID, " +
														"sqi.OptionComponentID, " +
														"sqi.ConditionAnd " +
														"FROM SurveyQuestionIf sqi " +
														"WHERE sqi.SurveyQuestionID = " + rs.GetInt32(5));
													if(rs3.Read())
													{
														show = !rs3.IsDBNull(3);
														do
														{
															if(rs3.IsDBNull(3))
															{
																if(!show && oldValues.Contains("Q" + rs3.GetInt32(0) + "O" + rs3.GetInt32(1)) && Convert.ToInt32("0" + oldValues["Q" + rs3.GetInt32(0) + "O" + rs3.GetInt32(1)]) == rs3.GetInt32(2))
																{
																	show = true;
																}
															}
															else
															{
																if(show && (!oldValues.Contains("Q" + rs3.GetInt32(0) + "O" + rs3.GetInt32(1)) || Convert.ToInt32("0" + oldValues["Q" + rs3.GetInt32(0) + "O" + rs3.GetInt32(1)]) != rs3.GetInt32(2)))
																{
																	show = false;
																}
															}
														}
														while(rs3.Read());
													}
													rs3.Close();
												}

												if(show)
												{
													missingOnCurrentPage++;
												}
											}
										}
									}
									else if(val == "" && !rs.IsDBNull(6) && rs.GetInt32(6) == 1 && !showMode)
									{
										// Warn about this question

										if(!warnQuestions.Contains("Q" + rs.GetInt32(0)))
										{
											warnQuestions.Add("Q" + rs.GetInt32(0));

											if(tempPageCX == currentPage)
											{
												bool show = true;
												if(HttpContext.Current.Request.QueryString["SAH"] == null)
												{
													SqlDataReader rs3 = Db.sqlRecordSet("SELECT " +
														"sqi.QuestionID, " +
														"sqi.OptionID, " +
														"sqi.OptionComponentID, " +
														"sqi.ConditionAnd " +
														"FROM SurveyQuestionIf sqi " +
														"WHERE sqi.SurveyQuestionID = " + rs.GetInt32(5));
													if(rs3.Read())
													{
														show = !rs3.IsDBNull(3);
														do
														{
															if(rs3.IsDBNull(3))
															{
																if(!show && oldValues.Contains("Q" + rs3.GetInt32(0) + "O" + rs3.GetInt32(1)) && Convert.ToInt32("0" + oldValues["Q" + rs3.GetInt32(0) + "O" + rs3.GetInt32(1)]) == rs3.GetInt32(2))
																{
																	show = true;
																}
															}
															else
															{
																if(show && (!oldValues.Contains("Q" + rs3.GetInt32(0) + "O" + rs3.GetInt32(1)) || Convert.ToInt32("0" + oldValues["Q" + rs3.GetInt32(0) + "O" + rs3.GetInt32(1)]) != rs3.GetInt32(2)))
																{
																	show = false;
																}
															}
														}
														while(rs3.Read());
													}
													rs3.Close();
												}

												if(show)
												{
													warnOnCurrentPage++;
												}
											}
										}
									}
								}
							}
							rs.Close();
							#endregion
						}
					}
				}
				catch(Exception) {}
			}

			/*
			HtmlAnchor Cancel = new HtmlAnchor();
			Cancel.ID = "Cancel";
			Cancel.HRef = "JavaScript:void(closeWindow('Är du säker på att du vill avbryta utan att spara?'));";
			Cancel.InnerHtml = "<img id=\"CancelCtrl\" src=\"submitImages/button_cancel0.gif\" width=\"148\" height=\"36\" border=\"0\">";
			FixedButtons.Controls.Add(Cancel);
			*/

			HtmlAnchor Close = new HtmlAnchor();
			Close.ID = "Close";
			if(1 == 0 && HttpContext.Current.Request.QueryString["RL"] != null)
			{
				Close.HRef = "JavaScript:void(closeWindowRefreshParent(''));";
			}
			else
			{
				Close.HRef = "JavaScript:void(closeWindow(''));";
			}
			Close.InnerHtml = "<IMG SRC=\"submitImages/button_close" + langID + ".gif\" border=\"0\">";
			Close.Visible = false;
			FixedButtons.Controls.Add(Close);

			HtmlAnchor DownloadPDF = new HtmlAnchor();
			DownloadPDF.ID = "DownloadPDF";
			DownloadPDF.HRef = "JavaScript:void(location.href='downloadPDF.aspx?AK='+document.forms[0].AK.value);";
			DownloadPDF.InnerHtml = "<IMG SRC=\"submitImages/button_download_PDF_" + langID + ".gif\" border=\"0\">";
			DownloadPDF.Visible = false;
			FixedButtons.Controls.Add(DownloadPDF);

			HtmlAnchor SendPDF = new HtmlAnchor();
			SendPDF.ID = "SendPDF";
			SendPDF.HRef = "JavaScript:void(location.href='sendPDF.aspx?AK='+document.forms[0].AK.value);";
			SendPDF.InnerHtml = "<IMG SRC=\"submitImages/button_send_email.gif\" border=\"0\">";
			SendPDF.Visible = false;
			FixedButtons.Controls.Add(SendPDF);

			HtmlAnchor SendPDF2 = new HtmlAnchor();
			SendPDF2.ID = "SendPDF2";
			SendPDF2.HRef = "JavaScript:sendEmail(document.forms[0].AK.value);";
			SendPDF2.InnerHtml = "<IMG SRC=\"submitImages/button_send_email.gif\" border=\"0\">";
			SendPDF2.Visible = false;
			FixedButtons.Controls.Add(SendPDF2);

			HtmlAnchor SendLink = new HtmlAnchor();
			SendLink.ID = "SendLink";
			SendLink.HRef = "sendLink.aspx?UK=" + userKey;
			SendLink.InnerHtml = "<IMG SRC=\"submitImages/button_send_email.gif\" border=\"0\">";
			SendLink.Visible = false;
			FixedButtons.Controls.Add(SendLink);

			HtmlAnchor PrintPage = new HtmlAnchor();
			PrintPage.ID = "PrintPage";
			PrintPage.HRef = "JavaScript:void(print());";
			PrintPage.InnerHtml = "<IMG SRC=\"submitImages/button_print_" + langID + ".gif\" border=\"0\">";
			PrintPage.Visible = false;
			FixedButtons.Controls.Add(PrintPage);

			LinkButton FixedButton = new LinkButton();
			FixedButton.ID = "FixedButton";
			FixedButton.Text = "<img id=\"SaveCtrl\" src=\"submitImages/button_later" + langID + ".gif\" width=\"128\" height=\"47\" border=\"0\">";
			FixedButton.Visible = false;
			FixedButton.Click += new EventHandler(FixedButton_Click);
			FixedButtons.Controls.Add(FixedButton);

			SqlDataReader lang = Db.sqlRecordSet("SELECT " +
				"COUNT(sl.SurveyLangID), " +
				"s.NoTime " +
				"FROM Survey s " +
				"LEFT OUTER JOIN SurveyLang sl ON sl.SurveyID = s.SurveyID " +
				"WHERE s.SurveyID = " + surveyID + " " +
				"GROUP BY s.SurveyID, s.NoTime");
			if(lang.Read())
			{
				if(lang.GetInt32(0) > 1)
				{
					LinkButton LangButton = new LinkButton();
					LangButton.ID = "LangButton";
					LangButton.Text = "<img src=\"submitImages/button_lang_" + langID + ".gif\" border=\"0\">";
					LangButton.Click += new EventHandler(LangButton_Click);
					FixedButtons.Controls.Add(LangButton);
				}
				if(!lang.IsDBNull(1))
				{
					Page.RegisterStartupScript("NOTIME","<script type=\"text/JavaScript\" language=\"JavaScript\">document.getElementById('minutes').style.display='none';</script>");
				}
			}
			lang.Close();

			LinkButton SubmitButton = new LinkButton();
			SubmitButton.ID = "SubmitButton";
			SubmitButton.Text = "<img onclick=\"void(self.showProcessing());void(this.style.display='none');\" id=\"SendCtrl\" src=\"submitImages/button_send" + langID + "_0.gif\" width=\"148\" height=\"36\" border=\"0\">";
			SubmitButton.Click += new EventHandler(SubmitButton_Click);

			LinkButton PrevButton = new LinkButton();
			PrevButton.ID = "PrevButton";
			PrevButton.Text = "<img src=\"submitImages/button_previous" + langID + ".gif\" width=\"148\" height=\"36\" border=\"0\">";
			PrevButton.Click += new EventHandler(PrevButton_Click);

			LinkButton NextButton = new LinkButton();
			NextButton.ID = "NextButton";
			NextButton.Text = "<img id=\"NextCtrl\" src=\"submitImages/button_next" + langID + "_0.gif\" width=\"148\" height=\"36\" border=\"0\">";
			NextButton.Click += new EventHandler(NextButton_Click);

			SurveyButtons.Controls.Add(new LiteralControl("<div style=\"width:580px;\"><div style=\"float:left;\">"));
			SurveyButtons.Controls.Add(PrevButton);
			SurveyButtons.Controls.Add(new LiteralControl("</div><div style=\"float:right;\">"));
			SurveyButtons.Controls.Add(NextButton);
			SurveyButtons.Controls.Add(SubmitButton);
			SurveyButtons.Controls.Add(new LiteralControl("</div></div>"));
		}

		#region Web Form Designer generated code
		override protected void OnInit(EventArgs e)
		{
			//
			// CODEGEN: This call is required by the ASP.NET Web Form Designer.
			//
			InitializeComponent();
			base.OnInit(e);
		}
		
		/// <summary>
		/// Required method for Designer support - do not modify
		/// the contents of this method with the code editor.
		/// </summary>
		private void InitializeComponent()
		{    
			this.Load += new System.EventHandler(this.Page_Load);
		}
		#endregion

		private void SubmitButton_Click(object sender, EventArgs e)
		{
			if(missingOnCurrentPage == 0 && !(!warn && warnOnCurrentPage > 0))
			{
				Db.sqlExecute("UPDATE Answer SET EndDT = GETDATE() WHERE AnswerID = " + answerID);
				if(sftp)
				{
					System.Text.StringBuilder sbHead = new System.Text.StringBuilder();
					System.Text.StringBuilder sbData = new System.Text.StringBuilder();
					string lastVar = "", lastVal = "";
					SqlDataReader rs = Db.sqlRecordSet("SELECT " +
						"sq.QuestionID, " +
						"qo.OptionID, " +
						"ISNULL(ISNULL(NULLIF(sq.Variablename,''),q.Variablename),'Q'+CAST(sq.QuestionID AS CHAR)), " +
						"ISNULL(ISNULL(NULLIF(sqo.Variablename,''),ISNULL(NULLIF(qo.Variablename,''),o.Variablename)),'A'+CAST(qo.OptionID AS CHAR)), " +
						"(SELECT COUNT(*) FROM SurveyQuestionOption sqoX WHERE sq.SurveyQuestionID = sqoX.SurveyQuestionID), " +
						"o.OptionType " +	// 5
						"FROM SurveyQuestion sq " +
						"INNER JOIN Question q ON sq.QuestionID = q.QuestionID " +
						"INNER JOIN SurveyQuestionOption sqo ON sq.SurveyQuestionID = sqo.SurveyQuestionID " +
						"INNER JOIN QuestionOption qo ON sqo.QuestionOptionID = qo.QuestionOptionID " +
						"INNER JOIN [Option] o ON qo.OptionID = o.OptionID " +
						"WHERE sq.SurveyID = " + surveyID + " " +
						"ORDER BY sq.SortOrder, sqo.SortOrder");
					while(rs.Read())
					{
						string var = rs.GetString(2) + (rs.GetInt32(4) > 1 ? "_" + rs.GetString(3) : "");
						string val = (oldValues.Contains("Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1)) ? (string)oldValues["Q" + rs.GetInt32(0) + "O" + rs.GetInt32(1)] : "");
						if(val != "" && (rs.GetInt32(5) == 1 || rs.GetInt32(5) == 3 || rs.GetInt32(5) == 9))
						{
							SqlDataReader rs2 = Db.sqlRecordSet("SELECT ISNULL(ocs.ExportValue,oc.ExportValue) FROM OptionComponents ocs INNER JOIN OptionComponent oc ON ocs.OptionComponentID = oc.OptionComponentID WHERE ocs.OptionID = " + rs.GetInt32(1) + " AND oc.OptionComponentID = " + Convert.ToInt32(val));
							if(rs2.Read())
							{
								val = rs2.GetInt32(0).ToString();
							}
							rs2.Close();
						}

						if(var != lastVar)
						{
							sbHead.Append((sbHead.Length == 0 ? "" : ",") + "\"" + var + "\"");

							sbData.Append((sbData.Length == 0 ? "" : ",") + "\"" + val + "\"");
						}
						else if(val != "")
						{
							sbData.Insert(sbData.Length-1,(lastVal != "" ? "," : "") + val);
						}
						lastVar = var;
						lastVal = val;
					}
					rs.Close();

					rs = Db.sqlRecordSet("SELECT SFTPhost, SFTPpath, SFTPuser, SFTPpass FROM ProjectRound WHERE ProjectRoundID = " + projectRoundID);
					if(rs.Read() && !rs.IsDBNull(2) && !rs.IsDBNull(3))
					{
						string filename = Server.MapPath("tmp/" + DateTime.Now.ToString("yyyyMMddHHmmss") + "_" + (new Random(unchecked((int)DateTime.Now.Ticks))).Next(0,2000) + ".txt");
						System.IO.FileStream fs = new System.IO.FileStream(filename, System.IO.FileMode.Create);
						System.IO.StreamWriter f = new System.IO.StreamWriter(fs, System.Text.Encoding.Default);
						f.WriteLine(sbHead.ToString());
						f.WriteLine(sbData.ToString());
						f.Close();
						fs.Close();

						Tamir.SharpSsh.SshTransferProtocolBase sshCp = 
							new Tamir.SharpSsh.Sftp(rs.GetString(0),rs.GetString(2), rs.GetString(3));
						sshCp.Connect();
						try
						{
							sshCp.Put(filename, (rs.IsDBNull(1) || rs.GetString(1) == "" ? "/" : rs.GetString(1)));
						}
						catch(Exception ex) 
						{
							System.Web.Mail.MailMessage msg = new System.Web.Mail.MailMessage();
							msg.To = "noc@eform.se";
							msg.From = "system@eform.se";
							msg.Subject = "Failed to connect SFTP";
							msg.Body = filename + "\r\n" + ex.Message;
							msg.BodyFormat = System.Web.Mail.MailFormat.Text;
							msg.BodyEncoding = System.Text.Encoding.GetEncoding(1252);
							System.Web.Mail.SmtpMail.SmtpServer = System.Configuration.ConfigurationSettings.AppSettings["SmtpServer"];
							System.Web.Mail.SmtpMail.Send(msg);
						}
						sshCp.Close();
						sshCp = null;
					}
					rs.Close();
				}
				if(sendSurveyAsEmail)
				{
					//https://secure.eform.se/submit.aspx?K=26a0812f26349&AIOP=1&SM=42DB517A&MakePDF=åäö&Ident=Person ID_åäö$Initialer_LJP$Personnummer_1977-11-16$Inskickad_2010-08-09
					string fname = DateTime.Now.ToString("yyyyMMddHHmmss");
					try
					{
						fname = Db.webReqGet("http" + (HttpContext.Current.Request.IsSecureConnection ? "s" : "") + "://" + HttpContext.Current.Request.Url.Host + "/submit.aspx?" +
							"MakePDF=" + fname + "&" +
							"K=" + userKey + "&" +
							"SM=" + answerKey.Substring(0,8) + "&" +
							"ToDisk=1");
						SqlDataReader rs = Db.sqlRecordSet("SELECT SendSurveyAsPdfTo, SendSurveyAsPdfToQ, SendSurveyAsPdfToO, EmailFromAddress FROM ProjectRound WHERE ProjectRoundID = " + projectRoundID);
						if(rs.Read())
						{
							System.Web.Mail.MailAttachment attachment = new	System.Web.Mail.MailAttachment(fname);

							System.Web.Mail.MailMessage msg = new System.Web.Mail.MailMessage();
							msg.To = (rs.IsDBNull(0) ? "" : rs.GetString(0));

							string email = (rs.IsDBNull(1) ? "" : (oldValues.Contains("Q" + rs.GetInt32(1) + "O" + rs.GetInt32(2)) ? (string)oldValues["Q" + rs.GetInt32(1) + "O" + rs.GetInt32(2)] : ""));
							if(email != "" && projectSetup.isEmail(email))
							{
								if(msg.To != "")
								{
									msg.Bcc = msg.To;
								}
								msg.To = email;
							}
							
							msg.From = rs.GetString(3);
							msg.Subject = "Copy of submitted survey";
							msg.Body = "Attached please find the survey submitted";
							msg.Attachments.Add(attachment);
							msg.BodyFormat = System.Web.Mail.MailFormat.Text;
							msg.BodyEncoding = System.Text.Encoding.GetEncoding(1252);
							System.Web.Mail.SmtpMail.SmtpServer = System.Configuration.ConfigurationSettings.AppSettings["SmtpServer"];
							System.Web.Mail.SmtpMail.Send(msg);
						}
						rs.Close();
					}
					catch(Exception ex)
					{
						System.Web.Mail.MailMessage msg = new System.Web.Mail.MailMessage();
						msg.To = "noc@eform.se";
						msg.From = "system@eform.se";
						msg.Subject = "Failed to send PDF";
						msg.Body = fname + "\r\n" + ex.Message;
						msg.BodyFormat = System.Web.Mail.MailFormat.Text;
						msg.BodyEncoding = System.Text.Encoding.GetEncoding(1252);
						System.Web.Mail.SmtpMail.SmtpServer = System.Configuration.ConfigurationSettings.AppSettings["SmtpServer"];
						System.Web.Mail.SmtpMail.Send(msg);
					}
				}
				finished = true;
				warn = false;
			}
			else
			{
				SurveyIntro.Text = "";

				if(missingOnCurrentPage > 0)
				{
					switch(langID)
					{
						case 1:	SurveyIntro.Text += "<SPAN STYLE=\"color:#CC0000;\">" + missingOnCurrentPage + " " + (missingOnCurrentPage > 1 ? "obligatoriska frågor är obesvarade. Dessa är markerade" : "obligatorisk fråga är obesvarad. Denna är markerad") + " i rött nedan.</SPAN>"; break;
						default:	SurveyIntro.Text += "<SPAN STYLE=\"color:#CC0000;\">" + missingOnCurrentPage + " " + (missingOnCurrentPage > 1 ? "mandatory questions are not answered. These are marked" : "mandatory question is not answered. This is marked") + " in red below.</SPAN>"; break;
					}
				}

				if(warnOnCurrentPage > 0)
				{
					warn = true;

					if(missingOnCurrentPage > 0)
					{
						SurveyIntro.Text += "<BR><BR>";
						switch(langID)
						{
							case 1:	SurveyIntro.Text += "<SPAN STYLE=\"color:#0000CC;\">Utöver dessa finns " + warnOnCurrentPage + " " + (warnOnCurrentPage > 1 ? "icke-obligatoriska frågor som är obesvarade. Dessa är markerade" : "icke-obligatorisk fråga som är obesvarad. Denna är markerad") + " i blått nedan.</SPAN>"; break;
							default:	SurveyIntro.Text += "<SPAN STYLE=\"color:#0000CC;\">In addition, there " + (warnOnCurrentPage > 1 ? "are" : "is") + " " + warnOnCurrentPage + " " + (warnOnCurrentPage > 1 ? "non-mandatory questions unanswered. These are marked" : "non-mandatory question that is unanswered. This is marked") + " in blue below.</SPAN>"; break;
						}
					}
					else
					{
						switch(langID)
						{
							case 1:	SurveyIntro.Text += "<SPAN STYLE=\"color:#0000CC;\">Det finns " + warnOnCurrentPage + " " + (warnOnCurrentPage > 1 ? "icke-obligatoriska frågor som är obesvarade. Dessa är markerade" : "icke-obligatorisk fråga som är obesvarad. Denna är markerad") + " i blått nedan. Tryck på nästa/skicka igen för att lämna dessa obesvarade.</SPAN>"; break;
							default:	SurveyIntro.Text += "<SPAN STYLE=\"color:#0000CC;\">There " + (warnOnCurrentPage > 1 ? "are" : "is") + " " + warnOnCurrentPage + " " + (warnOnCurrentPage > 1 ? "non-mandatory questions unanswered. These are marked" : "non-mandatory question unanswered. This is marked") + " in blue below. Click next/submit again to leave these unanswered.</SPAN>"; break;
						}
					}
				}
			}
		}

		protected override void OnPreRender(EventArgs e)
		{
			base.OnPreRender (e);

			string vasArr = "";
			//int vasCX = 0;
			string vasDict = "";
			System.Text.StringBuilder globalDependency = new System.Text.StringBuilder();
			string clearFunctions = "";

			// page completed count
			int pageCompletedCX = 0;
			// page missing count
			int pageMissingCX = 0;
			// page mandatory count
			int pageMandatoryCX = 0;
			// total page count
			int pageCX = 1;
			// total question count
			int totalCX = 0;

			if(surveyID == 0 || langID == 0)
			{
				SurveyIntro.Text = "Incorrect key! Please contact <A HREF=\"mailto:info@eform.se\">info@eform.se</A>.";
			}
			else 
			{
				switch(langID)
				{
					case 1:	thankYou = "Tack för din medverkan!"; break;
					default: thankYou = "Thank you for your participation!"; break;
				}

				SqlDataReader rs = Db.sqlRecordSet("SELECT " +
					"" + (projectRoundUnitID != 0 ? "dbo.cf_unitSurveyIntro(" + projectRoundUnitID + ")" : "ISNULL(prl.SurveyIntroJapaneseUnicode,prl.SurveyIntro)") + ", " +
					"ISNULL(prl.SurveyNameJapaneseUnicode,prl.SurveyName), " +
					"ISNULL(prl.ThankyouTextJapaneseUnicode,prl.ThankyouText) " +
					"FROM ProjectRound pr " +
					"INNER JOIN ProjectRoundLang prl ON pr.ProjectRoundID = prl.ProjectRoundID AND prl.LangID = " + langID + " " +
					"WHERE pr.ProjectRoundID = " + projectRoundID);
				if(rs.Read())
				{
					surveyIntro = (rs.IsDBNull(0) || rs.GetString(0) == "" ? surveyIntro : rs.GetString(0).Replace("\r\n","<br>").Replace("\n","<br>"));
					surveyName = (rs.IsDBNull(1) ? surveyName : rs.GetString(1));
					thankYou = (rs.IsDBNull(2) || rs.GetString(2) == "" ? thankYou : rs.GetString(2).Replace("\r\n","<br>").Replace("\n","<br>"));
				}
				rs.Close();

				if(finished)
				{
					#region Finished
					bool showPDF = true;

					if(!IsPostBack && HttpContext.Current.Request.QueryString["GenerateDownloadFeedback"] == null)
					{
						switch(langID)
						{
							case 1:	SurveyIntro.Text = "Denna nyckel har redan använts för att skicka enkäten!"; break;
							default: SurveyIntro.Text = "This key has already been used to submit the survey!"; break;
						}
					}
					else
					{
						bool feedbackAlert = false;

						SurveyIntro.Text = "";

						System.Text.StringBuilder FB = new System.Text.StringBuilder();

						#region Hardcoded feedback
						if(surveyID == 10 || surveyID == 13)
						{
							#region Audit/Dudit (incomplete)
							SurveyIntro.Text += (SurveyIntro.Text != "" ? "<br><br>" : "") + "<b style=\"font-size:18px;\">Resultat</b><br>";

							SurveyIntro.Text += "<br>Eventuell text här... Eventuell text här... Eventuell text här... Eventuell text här... Eventuell text här... Eventuell text här... Eventuell text här... Eventuell text här... <br><br>";

							if(surveyID == 10)
							{
								SurveyIntro.Text += "<MAP NAME=\"AUDIT_Map\">" +
									"<AREA SHAPE=\"poly\" ALT=\"cirka 12 procent av befolkningen ligger på den allra lägsta risknivån\" COORDS=\"82,284, 62,288, 66,310, 101,317, 95,287\" HREF=\"#\">" +
									"<AREA SHAPE=\"poly\" ALT=\"här ligger genomsnittspoängen för kvinnor mellan 17-27 år\" COORDS=\"82,206, 62,211, 68,228, 93,229, 99,213\" HREF=\"#\">" +
									"<AREA SHAPE=\"poly\" ALT=\"här ligger genomsnittspoängen för män mellan 17-27 år\" COORDS=\"80,171, 68,173, 67,186, 95,189, 97,173\" HREF=\"#\">" +
									"<AREA SHAPE=\"poly\" ALT=\"bara cirka 5 procent av kvinnorna ligger över denna nivå\" COORDS=\"53,162, 43,162, 32,171, 50,179, 63,179, 69,166\" HREF=\"#\">" +
									"<AREA SHAPE=\"poly\" ALT=\"bara cirka 10 procent av männen ligger över denna nivå\" COORDS=\"26,148, 5,154, 3,170, 26,173, 40,157\" HREF=\"#\">" +
									"<AREA SHAPE=\"poly\" ALT=\"bara cirka 5 procent av männen ligger över denna nivå\" COORDS=\"85,122, 63,124, 67,141, 95,140, 96,124\" HREF=\"#\">" +
									"<AREA SHAPE=\"poly\" ALT=\"bland kvinnor är det mindre än 1 procent som dricker mer än så här\" COORDS=\"82,97, 68,99, 62,110, 85,116, 94,107, 94,99\" HREF=\"#\">" +
									"<AREA SHAPE=\"poly\" ALT=\"bland män är det mindre än 1 procent som dricker mer än så här\" COORDS=\"38,90, 57,83, 70,94, 57,107, 35,101\" HREF=\"#\">" +
									"</MAP>";
								SurveyIntro.Text += "<img border=\"0\" usemap=\"#AUDIT_Map\" src=\"reportImageStatic.aspx?SID=" + surveyID + "&AK=" + answerKey + "\"><br>";
							}
							else
							{
								SurveyIntro.Text += "<img src=\"reportImageStatic.aspx?SID=" + surveyID + "&AK=" + answerKey + "\"><br>";
							}
					
							SurveyIntro.Text += "Plats för riskbedömning och individualiserad rekommendation... Plats för riskbedömning och individualiserad rekommendation... Plats för riskbedömning och individualiserad rekommendation... Plats för riskbedömning och individualiserad rekommendation... Plats för riskbedömning och individualiserad rekommendation... Plats för riskbedömning och individualiserad rekommendation... Plats för riskbedömning och individualiserad rekommendation... <br>";
							#endregion
						}
						else if(surveyID == 14 || surveyID == 23 || surveyID == 24)
						{
							// KS
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Du rekommenderas att kontakta personalsjukgymnast.");
		
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sjukgymnastik</B>" +
										"<BR><BR>" +
										"Som en del av det förebyggande hälso- och arbetsmiljöarbetet finns det sjukgymnaster som arbetar med belastnings- och stressrelaterade besvär hos de anställda, både i Huddinge och i Solna. Syftet är att kunna göra en tidig insats vid arbetsrelaterade besvär." +
										"<BR><BR>" +
										"Du har möjlighet att få hjälp av en sjukgymnast om du har drabbats av smärta eller led-, rygg- eller muskelbesvär. Vi erbjuder en sjukgymnastisk bedömning, behandling och uppföljning. Du kan erbjudas olika former av friskvårdsträning alternativt remitteras till en annan vårdgivare." +
										"<BR>" +
										"Sjukgymnasterna arbetar på uppdrag av HR-avdelningen och samarbetar med Sektionen för arbetsmiljö och hälsa, samt med företagshälsovården." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Susanne Sandström och Eva Ajax, Leg sjukgymnast, 585 818 26." +
										"<BR>" +
										"Sjukgymnastikkliniken, R 41" +
										"<BR>" +
										"Telefontid: måndag kl. 12:30-13:30, torsdag kl. 10:30-11:30" +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Ulla Oxelbeck, Leg sjukgymnast 517 727 55." +
										"<BR>" +
										"Enheten för sjukgymnastik, en trappa ner (U1), i huvudentrén (röda hissarna)." +
										"</DIV>");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sluta röka med hjälp av internet</B>" +
										"<BR><BR>" +
										"Ni kommer att på egen hand arbeta med materialet &quot;Sluta nu&quot;, vilket Cancerfonden, Folkhälsoinstitutet, Hjärt- och Lungfonden samt Läkare mot tobak står bakom." +
										"<BR><BR>" +
										"Varje vecka får du ett veckobrev av oss och mellan dem arbetar du med en internetbaserad sluta-röka/snusa skola själv. Du kan när som helst få stöd av oss via e-post. Du kommer under den första hälften av kursen förbereda dig mentalt på att sluta röka eller snusa, samt få information om nikotinhjälpmedel. Fimpardatum sker efter några veckor. Efter &quot;fimpardatumet&quot; kommer du att lära dig vad som händer vid nikotinstoppet och hur du kan ta hand om dig själv." +
										"<BR><BR>" +
										"<B>Start</B>: 23/4" +
										"<BR>" +
										"<B>Anmälan</B>: senast 18/4" +
										"<BR><BR>" +
										"<B>Så här anmäler du dig till kursen</B>" +
										"<BR>" +
										"<A HREF=\"mailto:lisa.svensson@karolinska.se?Subject=Anmälan till sluta röka med hjälp av internet&Body=Namn:%0D%0AKontaktinformation:\">Klicka här</A> för att skicka anmälan via e-post till <A HREF=\"mailto:lisa.svensson@karolinska.se?Subject=Anmälan till sluta röka med hjälp av internet&Body=Namn:%0D%0AKontaktinformation:\">lisa.svensson@karolinska.se</A>." +
										"<BR><BR>" +
										"Har ni frågor om kursverksamheten kan ni ringa till någon av hälsopedagogerna Lisa Svensson 585 894 82 eller Mariette Veideskog, 585 868 43." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sluta röka grupp</B>" +
										"<BR><BR>" +
										"Under våren kommer vi att starta sluta röka/snusa grupper. Vi kommer att följa kursprogrammet &quot;Fimpa dig fri&quot; från Centrum för tobaksprevention. Dessutom kommer vi att prata om vikten av bra kost och motionsvanor för att inte gå upp i vikt vid ett nikotinstopp. Kursen är vid 9 tillfällen. Som kursdeltagare kommer du att arbeta med programmet mellan träffarna. Rök/snusstopp kommer först att ske i 22 maj. Tiden innan kommer vi att ägna åt förberedelser inför rök/snusstoppet. " +
										"<BR>" +
										"Kursen är avgiftsfri och du får gå den på arbetstid, och förutsätter medgivande av din närmsta chef. Du bekostar eventuella nikotinläkemedel själv." +
										"<BR>" +
										"<TABLE BORDER=0 CELLSPACING=5 CELLPADDING=0>" +
										"<TR><TD COLSPAN=3><B>Solna</B></TD></TR>" +
										"<TR><TD>Datum&nbsp;&nbsp;</TD><TD>Tid&nbsp;&nbsp;</TD><TD>Lokal</TD></TR>" +
										"<TR><TD>Tis 24/4&nbsp;&nbsp;</TD><TD>14:00-15:00&nbsp;&nbsp;</TD><TD>Eugeniahemmet, Granitsalen</TD></TR>" +
										"<TR><TD>Ons 2/5&nbsp;&nbsp;</TD><TD>14:00-15:00&nbsp;&nbsp;</TD><TD>Eugeniahemmet, Granitsalen</TD></TR>" +
										"<TR><TD>Mån 7/5&nbsp;&nbsp;</TD><TD>14.00-15.00&nbsp;&nbsp;</TD><TD>Eugeniahemmet, Glaxorummet</TD></TR>" +
										"<TR><TD>Tis 15/5&nbsp;&nbsp;</TD><TD>14.00-15.00&nbsp;&nbsp;</TD><TD>Norrbacka, Rehabsalen</TD></TR>" +
										"<TR><TD>Tis 22/5&nbsp;&nbsp;</TD><TD>14.00-15.00&nbsp;&nbsp;</TD><TD>Eugeniahemmet, Glaxorummet</TD></TR>" +
										"<TR><TD>Ons 30/5&nbsp;&nbsp;</TD><TD>14.00-15.00&nbsp;&nbsp;</TD><TD>Eugeniahemmet, Glaxorummet</TD></TR>" +
										"<TR><TD>Mån 4/6&nbsp;&nbsp;</TD><TD>14.00-15.00&nbsp;&nbsp;</TD><TD>Eugeniahemmet, Glaxorummet</TD></TR>" +
										"<TR><TD>Tis 12/6&nbsp;&nbsp;</TD><TD>14.00-15.00&nbsp;&nbsp;</TD><TD>Norrbacka, Rehabsalen</TD></TR>" +
										"<TR><TD>Tis 19/6&nbsp;&nbsp;</TD><TD>14.00-15.00&nbsp;&nbsp;</TD><TD>Eugeniahemmet, Glaxorummet</TD></TR>" +
										"<TR><TD COLSPAN=3>&nbsp;</TD></TR>" +
										"<TR><TD COLSPAN=3><B>Huddinge</B></TD></TR>" +
										"<TR><TD>Datum&nbsp;&nbsp;</TD><TD>Tid&nbsp;&nbsp;</TD><TD>Lokal</TD></TR>" +
										"<TR><TD>Tis 24/4&nbsp;&nbsp;</TD><TD>11:00-12:00&nbsp;&nbsp;</TD><TD>C1:77, konferensrum 2</TD></TR>" +
										"<TR><TD>Ons 2/5&nbsp;&nbsp;</TD><TD>11:00-12:00&nbsp;&nbsp;</TD><TD>C1:77, konferensrum 2</TD></TR>" +
										"<TR><TD>Mån 7/5&nbsp;&nbsp;</TD><TD>11.00-12.00&nbsp;&nbsp;</TD><TD>Konferensrummet, Personalgymmet, Novumhuset</TD></TR>" +
										"<TR><TD>Tis 15/5&nbsp;&nbsp;</TD><TD>11.00-12.00&nbsp;&nbsp;</TD><TD>Konferensrummet, Personalgymmet, Novumhuset</TD></TR>" +
										"<TR><TD>Tis 22/5&nbsp;&nbsp;</TD><TD>11.00-12.00&nbsp;&nbsp;</TD><TD>Konferensrummet, Personalgymmet, Novumhuset</TD></TR>" +
										"<TR><TD>Ons 30/5&nbsp;&nbsp;</TD><TD>11.00-12.00&nbsp;&nbsp;</TD><TD>Konferensrummet, Personalgymmet, Novumhuset</TD></TR>" +
										"<TR><TD>Mån 4/6&nbsp;&nbsp;</TD><TD>11.00-12.00&nbsp;&nbsp;</TD><TD>Konferensrummet, Personalgymmet, Novumhuset</TD></TR>" +
										"<TR><TD>Tis 12/6&nbsp;&nbsp;</TD><TD>11.00-12.00&nbsp;&nbsp;</TD><TD>Konferensrummet, Personalgymmet, Novumhuset</TD></TR>" +
										"<TR><TD>Tis 19/6&nbsp;&nbsp;</TD><TD>11.00-12.00&nbsp;&nbsp;</TD><TD>Konferensrummet, Personalgymmet, Novumhuset</TD></TR>" +
										"</TABLE>" +
										"<BR>" +
										"<B>Kursledare</B>" +
										"<BR>" +
										"Mariette Weideskog, Hälsopedagog, Sektionen för arbetsmiljö och hälsa, HR-avdelningen" +
										"<BR><BR>" +
										"<B>Anmälan</B>" +
										"<BR>" +
										"<A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan till sluta röka grupp&Body=Namn:%0D%0AKontaktinformation:%0A%0APlats: (ange Huddinge eller Solna)\">Klicka här</A> för att skicka anmälan via e-post till <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan till sluta röka grupp&Body=Namn:%0D%0AKontaktinformation:%0A%0APlats: (ange Huddinge eller Solna)\">mariette.veideskog@karolinska.se</A>. Glöm inte att meddela om du vill gå kursen i Solna eller Huddinge. Sista anmälningsdag är den 13/4. Efter anmälan kommer ni att få skriftlig information så att ni kan förbereda er mentalt för ett rök/snusstopp." +
										"<BR><BR>" +
										"Har ni frågor om kursverksamheten kan ni ringa till någon av hälsopedagogerna Lisa Svensson 585 894 82 eller Mariette Veideskog, 585 868 43." +
										"</DIV>");
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Previa</B>" +
										"<BR><BR>" +
										"Kontakta företagssköterskan för rådgivning i alkohol- och drogfrågor." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 2.75)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper och mindfulnessträning. " +
											"Båda dessa alternativ kommer att finnas tillgängliga på din arbetsplats. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper och mindfulnessträning. " +
											"Båda dessa alternativ kommer att finnas tillgängliga på din arbetsplats. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}

									#region Mindfulness
									FB.Append("<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Mindfulnessmeditation</B>" +
										"<BR><BR>" +
										"Mindfulness kan beskrivas som ett förhållningssätt. Ett sätt att vara, lyssna och relatera. Mindfulness är ett observerande, icke-värderande och accepterande av det som händer i nuet. Istället för att ryckas med av t.ex. smärtförnimmelser, oro och katastroftankar lär man sig att förhålla sig som en välvillig men opartisk observatör av sin egen mentala aktivitet. Detta förhållningssätt underlättas av meditation där man övar sin förmåga att rikta och behålla uppmärksamheten. Mindfulnessmeditationen utförs i olika kroppspositioner; sittande, stående, liggande och när kroppen är i rörelse såväl som i stillhet." +
										"<BR><BR>" +
										"Mindfulnessmeditationen har visat sig ha en stressreducerade effekt, vilket antyder att den skulle kunna vara användbar också för att förebygga stress och stressrelaterade sjukdomstillstånd." +
										"<BR><BR>" +
										"Kursprogrammet är upplagt i enlighet med MBSR-programmet (Mindfulness Based Stress Reduction) som det utarbetats av pionjären Jon Kabat-Zinn i USA. Inledningsvis hålls ett orienteringsseminarium om kursens innehåll och bakgrund. Tyngdpunkten i kursen ligger på praktiska meditationsövningar under åtta grupptillfällen. Du förväntas att delta praktiskt (efter egen förmåga) i alla formella mindfulnessövningar och reflektera i grupp kring dina erfarenheter av övningarna. Var och en för dessutom en reflektionsdagbok. MBSR-programmet inkluderar en tyst dag (7-8 timmar) som är förlagd till söndagen efter seminarietillfälle sex. Detta tillfälle får du gå på din fritid. Under denna dag hålls lärarledda meditationsövningar. Du förväntas att utföra dagliga mindfulnessövningar i hemmet under ca 30 min 6-7 dagar/vecka." +
										"<BR><BR>" +
										"Vi vill passa på att göra dig uppmärksam på att kursen kräver motivation och beslutsamhet. Det krävs att du gör meditationsövningarna oavsett om det tar emot. Det kan paradoxalt nog upplevas stressande att ta del av en stressreducerande kurs. Om du redan på förhand vet att du inte kommer att kunna avsätta tid för de dagliga praktiska hemövningarna, så är kanske denna kurs inte rätt för dig just nu." +
										"<BR><BR>" +
										"<B>Tider för mindfulnessgrupper</B>" +
										"<BR><BR>" +
										"<TABLE BORDER=0 CELLSPACING=5 CELLPADDING=0>" +
										"<TR><TD>Vecka</TD><TD>Dag och tid</TD><TD></TD></TR>" +
										"<TR><TD>17</TD><TD>Tisdag, kl 14-16</TD><TD>Solna</TD></TR>" +
										"<TR><TD></TD><TD>Onsdag, kl 14-16</TD><TD>Huddinge</TD></TR>" +
										"<TR><TD>18</TD><TD>Onsdag, kl 15-17</TD><TD>OBS! Solnagruppen i Huddinge</TD></TR>" +
										"<TR><TD></TD><TD>Onsdag, kl 13-15</TD><TD>Huddinge</TD></TR>" +
										"<TR><TD>19</TD><TD>Tisdag, kl 14-16</TD><TD>Solna</TD></TR>" +
										"<TR><TD></TD><TD>Onsdag, kl 14-16</TD><TD>Huddinge</TD></TR>" +
										"<TR><TD>20</TD><TD>Tisdag, kl 14-16</TD><TD>Solna</TD></TR>" +
										"<TR><TD></TD><TD>Onsdag, kl 14-16</TD><TD>Huddinge</TD></TR>" +
										"<TR><TD>21</TD><TD>Tisdag, kl 14-16</TD><TD>Solna</TD></TR>" +
										"<TR><TD></TD><TD>Onsdag, kl 14-16</TD><TD>Huddinge</TD></TR>" +
										"<TR><TD>22 </TD><TD>Tisdag, kl 14-16</TD><TD>Solna</TD></TR>" +
										"<TR><TD></TD><TD>Onsdag, kl 14-16</TD><TD>Huddinge</TD></TR>" +
										"<TR><TD>23</TD><TD>Torsdag, kl 13-15</TD><TD>Huddinge</TD></TR>" +
										"<TR><TD></TD><TD>Torsdag, kl 15-17</TD><TD>OBS! Solnagruppen i Huddinge</TD></TR>" +
										"<TR><TD COLSPAN=\"3\">&nbsp;</TD></TR>" +
										"<TR><TD COLSPAN=\"3\">Söndagen den 10/6 - tyst dag för båda grupper gemensamt (7-8 tim), preliminärt i Huddinge</TD></TR>" +
										"<TR><TD COLSPAN=\"3\">&nbsp;</TD></TR>" +
										"<TR><TD>24</TD><TD>Tisdag, kl 14-16</TD><TD>Solna</TD></TR>" +
										"<TR><TD></TD><TD>Onsdag, kl 14-16</TD><TD>Huddinge</TD></TR>" +
										"<TR><TD>25</TD><TD>Tisdag, kl 14-16</TD><TD>Solna</TD></TR>" +
										"<TR><TD></TD><TD>Onsdag, kl 14-16</TD><TD>Huddinge</TD></TR>" +
										"</TABLE>" +
										"<BR>" +
										"<B>Frågor och anmälan</B>" +
										"<BR>" +
										"Är du intresserad av att deltaga i en mindfulnessgrupp, kan du välja mellan att gå den i Huddinge eller i Solna. Efter förankring hos chef, sker en av timmarna på betald arbetstid, den andra timmen får du ta av din fritid. Även söndagen den 10/6 får du ta av din egen tid. Grupperna startar vecka 17. Kostnad för material (2 CD och 1 DVD) tillkommer med 290 kr. Deltagandet i gruppen kommer sedan att utvärderas avseende effekten på upplevd arbetsrelaterad stress och hälsa. " +
										"<BR><BR>" +
										"Eventuella frågor besvaras av kursledaren Camilla Sköld, Med dr, leg sjukgymnast via e-post till <A HREF=\"mailto:camilla.skold@telia.com\">camilla.skold@telia.com</A>." +
										"<BR><BR>" +
										"<A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan om intresse för Mindfulness&Body=Namn:%0D%0AKontaktinformation:\">Klicka här</A> för att skicka en anmälan via e-post till <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan om intresse för Mindfulness&Body=Namn:%0D%0AKontaktinformation:%0D%0APlats: (ange Huddinge eller Solna)\">mariette.veideskog@karolinska.se</A>. I din anmälan vill vi att du uppger om du vill gå i Huddinge eller i Solna. Sista anmälningsdag är den 16/4." +
										"</DIV>" +
										"<BR>");
									#endregion

									FB.Append("<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Kollegiala samtalsgrupper</B>" +
										"<BR><BR>" +
										"Upplevd stress kan ju hanteras på många olika sätt av olika individer och det är inte alls säkert att det behöver innebära något negativt för Dig, men det kan också tolkas som signaler på att något bör göras åt det. Kortvariga perioder av stress kan säkert de flesta handskas med, men när det övergår till att vara längre perioder finns risk för att det påverkar livet i stort och kan även medföra negativa konsekvenser för hälsan." +
										"<BR>" +
										"Arbetsrelaterad stress och utmattning är vida begrepp som kan ha många olika orsaksförklaringar. Det finns inte en enkel lösning på problemet och förebyggande åtgärder måste följaktligen också ske inom många olika områden. Det krävs insatser såväl inom organisationen, på arbetsplatsen, i samhället i stort, som för den enskilde individen." +
										"<BR><BR>" +
										"<B>Reflekterande, kollegiala samtalsgrupper</B>" +
										"<BR>" +
										"Reflekterande kollegiala samtalsgrupper utifrån en speciell pedagogisk metod är ett sätt för att förebygga utveckling av arbetsrelaterad stress och utmattning. I tidigare studier med liknande grupper har man kunnat konstatera att kollegialt stöd, tid för reflektion och erfarenhetsutbyte mellan kollegor visat sig vara mycket värdefullt för deltagarna. Kollegor från olika arbetsplatser har ofta gemensamma yrkesrelaterade problem och erfarenheter, men samtidigt olika infallsvinklar och lösningar på dessa. Detta kan medföra stöd och utveckling för individen. Det kan också framkomma förslag på vad som kan göras på arbetsplatsen, i organisationen för att förhindra utveckling av arbetsrelaterad stress och utmattningssyndrom." +
										"<BR><BR>" +
										"<B>Genomförande</B>" +
										"<BR>" +
										"För att ge struktur åt arbetet i gruppen används en pedagogisk metod som bygger på problembaserat lärande. Detta innebär att arbetet i gruppen utgår från en övergripande fråga och det är deltagarna som sedan själva väljer de frågeställningar som känns mest angelägna att arbeta vidare med." +
										"<BR>" +
										"Gruppen kommer att bestå av 8 personer ur samma eller liknande yrkesgrupp och leds av en handledare. Man träffas under 11 veckor, 2 timmar vid varje tillfälle. Efter förankring hos arbetsledare, sker en av timmarna på betald arbetstid, den andra timmen får du ta av din fritid. Grupperna startar först till hösten." +
										"<BR>" +
										"Deltagandet i gruppen kommer sedan att utvärderas avseende effekten på upplevd arbetsrelaterad stress och hälsa." +
										"<BR><BR>" +
										"<B>Intresseanmälan och förfrågningar</B>" +
										"<BR>" +
										"<A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan om intresse för Reflekterande, kollegiala samtalsgrupper&Body=Namn:%0D%0AKontaktinformation:%0D%0AYrkeskategori:%0D%0APlats: (ange Huddinge eller Solna)\">Klicka här</A> för att skicka en intresseanmälan (och eventuella frågor) via e-post till <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan om intresse för Reflekterande, kollegiala samtalsgrupper&Body=Namn:%0D%0AKontaktinformation:%0D%0AYrkeskategori:%0D%0APlats: (ange Huddinge eller Solna)\">mariette.veideskog@karolinska.se</A>. I din anmälan vill vi att du uppger om du vill gå i Solna eller i Huddine, samt yrkeskategori." +
										"</DIV>" +
										"<BR>" +

										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Enskilda samtal</B>" +
										"<BR><BR>" +
										"Vi som arbetar i Sjukhuskyrkan har lång erfarenhet av att möta människor i sorg och kris. Att lyssna och tala om det riktigt svåra är en av våra allra viktigaste uppgifter. Syftet med samtalen är att stödja och hjälpa, ge hopp och mod. Samtalen kan ske vid ett eller flera tillfällen. " +
										"<BR><BR>" +
										"Sjukhuskyrkans enskilda samtal erbjuds alla, oavsett tro och livsåskådning. Många av dem vi träffar har i vanliga fall ingen anknytning till kyrkan. " +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Kontakta Leena Widén, ank 802 92 för bokning av samtal." +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Kontakta Hans-Peter Rasmussen, ank 740 73 för bokning av samtal." +
										"</DIV>" +
										"<BR>" +

										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stödsamtal hos Previa</B>" +
										"<BR><BR>" +
										"Är dina problem arbetsrelaterade kan du kontakta företagssköterskan på Previa för rådgivning." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									bool QsleepI = false, QpreviaI = false;

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
										case 312: QsleepI = true; FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
										case 314: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
									}
									if(QsleepI || QpreviaI)
									{
										FB.Append("<BR>");
										if(QsleepI)
										{
											FB.Append("<BR>" +
												"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
												"<B STYLE=\"font-size:16px;\">&quot;Hur sover du egentligen?&quot;</B>" +
												"<BR><BR>" +
												"Tillhör du den kategorin som räknar får på natten så ska du komma på denna föreläsning. Vad är sömn egentligen? När ska man ta tupplurar?  Är det bra att räkna får? Du kommer få kunskap om hur vår sömncykel fungerar och få tips och idéer på vad du själv kan göra för att förbättra din sömn." +
												"<BR><BR>" +
												"<B>Huddinge</B>:" +
												"<BR>" +
												"Fredagen den 27/4, kl 13:00-14:30, M 64" +
												"<BR>" +
												"Fredagen den 4/5, kl 13:00-14:30, R 63" +
												"<BR><BR>" +
												"<B>Solna</B>:" +
												"<BR>" +
												"Måndagen den 23/4, kl 14:30-16:00, Rehabsalen, Norrbacka" +
												"<BR>" +
												"Måndagen den 14/5, kl 14:30-16:00, Rehabsalen, Norrbacka." +
												"<BR><BR>" +
												"<B>Föreläsare</B>: Mariette Weideskog, Hälsopedagog, Sektionen för arbetsmiljö och hälsa, HR-avdelningen " +
												"<BR><BR>" +
												"Du behöver inte anmäla dig till föreläsningen, det är bara att komma. Du får gå på arbetstid och förutsätter medgivande från din närmsta chef." +
												"</DIV>");
										}
										if(1==0 && QpreviaI)
										{
											FB.Append("<BR>" +
												"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
												"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
												"<BR><BR>" +
												"För dig som arbetar på Karolinska, Solna:" +
												"<BR>" +
												"<B>Previa Haga</B>" +
												"<BR>" +
												"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
												"<BR>" +
												"Öppet:	Mån-fre 08.00-16.45" +
												"<BR>" +
												"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
												"<BR>" +
												"Tfn vxl: 08-728 51 40" +
												"<BR><BR>" +
												"För dig som arbetar på Karolinska, Huddinge:" +
												"<BR>" +
												"<B>Previa Huddinge</B>" +
												"<BR>" +
												"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
												"<BR>" +
												"Öppet: Mån-fre 08.00-16.45" +
												"<BR>" +
												"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
												"<BR>" +
												"Tfn vxl: 08-608 63 80" +
												"<BR><BR>" +
												"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
												"<BR>" +
												"<B>Previa Gullmarsplan</B>" +
												"<BR>" +
												"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
												"<BR>" +
												"Öppet: Mån-fre 08.00-16.45" +
												"<BR>" +
												"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
												"<BR>" +
												"Tfn vxl: 08 - 722 24 00" +
												"</DIV>");
										}
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									bool QpreviaI = false;

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: QpreviaI = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
										case 317: QpreviaI = true; FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
									}
									if(1==0 && QpreviaI)
									{
										FB.Append("<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
											"<BR><BR>" +
											"För dig som arbetar på Karolinska, Solna:" +
											"<BR>" +
											"<B>Previa Haga</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
											"<BR>" +
											"Öppet:	Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
											"<BR>" +
											"Tfn vxl: 08-728 51 40" +
											"<BR><BR>" +
											"För dig som arbetar på Karolinska, Huddinge:" +
											"<BR>" +
											"<B>Previa Huddinge</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
											"<BR>" +
											"Öppet: Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
											"<BR>" +
											"Tfn vxl: 08-608 63 80" +
											"<BR><BR>" +
											"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
											"<BR>" +
											"<B>Previa Gullmarsplan</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
											"<BR>" +
											"Öppet: Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
											"<BR>" +
											"Tfn vxl: 08 - 722 24 00" +
											"</DIV>");
									}

								}
								#endregion

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");

									if(Qscore >= 12)
									{
										FB.Append("<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Individuell träningsrådgivning</B>" +
											"<BR><BR>" +
											"Som anställd på Karolinska erbjuds du hjälp med individuell träningsrådgivning.  Det kan vara att få en styrketränings introduktion i vårt personalgym, hjälp med rörlighets- eller konditionsträning, stretchövningar m.m." +
											"<BR><BR>" +
											"För bokning av träningsrådgivning i <B>Solna</B>" +
											"<BR>" +
											"Tomas Hernvall, Friskvårdskonsulent/Gymföreståndare, Sektionen för arbetsmiljö och hälsa, HR-avdelningen,  ank 757 10.  " +
											"<BR><BR>" +
											"För bokning av träningsrådgivning i <B>Huddinge</B>" +
											"<BR>" +
											"Marie Hammarström, friskvårdskonsulent/Gymföreståndare, Sektionen för arbetsmiljö och hälsa, HR-avdelningen, ank 868 42." +
											"<BR><BR>" +
											"Du får gå på träningsrådgivningen på arbetstid och förutsätter medgivande av din närmsta chef." +
											"</DIV>" +
											"<BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">&quot;Kost, Rörelse, Hälsa&quot;</B>" +
											"<BR><BR>" +
											"Vill du lära dig mer om kost och motion? Hur påverkar kosten och rörelsen ditt välbefinnande och din hälsa? Börjar favoritbyxorna sitta lite tight i midjan?  Nu har du chansen att på ett bra sätt hitta en hälsosam vikt och få bra vanor genom att lära dig mer om kostens och rörelsens betydelse." +
											"<BR><BR>" +
											"Kursen består av 9 gruppträffar a´ 1 timme. På träffarna kommer vi bland annat att diskutera våra mat- och motionsvanor och beteenden. Inom kosten kommer vi bland annat att prata om våra energikällor, måltidssammansättning, fettkällor samt kosttrender. Du kommer inte att följa någon diet, utan tanken är att du ska lära dig så mycket om kost så att du kan sätta samman en bra måltid själv. Fysisk aktivitet och rörelse är en viktig grundpelare i en hälsosam livsstil och en hjälp till att få energibalans och därmed en hälsosam vikt. Vi kommer bland annat att prata om positiva effekter av fysisk aktivitet och praktisera detta på ett enklare sätt. Hur lite kan du &quot;komma undan med&quot;?" +
											"<BR><BR>" +
											"Vid varje kurstillfälle har samtliga möjlighet att väga sig. Kursinnehåll delas ut vid första tillfället." +
											"<BR><BR>" +
											"<B>Datum, Tid & Lokal</B>" +
											"<BR><BR>" +
											"<B>Solna</B>" +
											"<BR>" +
											"Tisdagar kl 11:00-12:00, med start vecka 40. Kursen kommer att hållas i Eugeniahemmet, första kurstillfället i Aga-salen." +
											"<BR><BR>" +
											"<B>Huddinge</B>" +
											"<BR>" +
											"Tisdagar, kl 15:00-16:00, med start vecka 40. Kursen kommer att hållas i konferensrummet i personalgymmet, Novumhuset." +
											"<BR><BR>" +
											"<B>Kursledare</B>" +
											"<BR>" +
											"Charlotte Ovefelt, Hälsopedagog" +
											"<BR><BR>" +
											"<B>Kostnad</B>" +
											"<BR>" +
											"Kursen är avgiftsfri och sker på arbetstid och förutsätter medgivande från din närmsta chef." +
											"<BR><BR>" +
											"<B>Anmälan</B>" +
											"<BR>" +
											"Senast fredag 24/9. <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan till Kost, Rörelse, Hälsa&Body=Namn:%0D%0AKontaktinformation:%0A%0APlats: (ange Huddinge eller Solna)\">Klicka här</A> för att skicka anmälan via e-post till <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan till Kost, Rörelse, Hälsa&Body=Namn:%0D%0AKontaktinformation:%0A%0APlats: (ange Huddinge eller Solna)\">mariette.veideskog@karolinska.se</A>. När du skickar din anmälan via e-post vill vi att du skriver kursens namn som ärende samt om du vill gå i Solna eller Huddinge." +
											"<BR><BR>" +
											"Har ni frågor om kursverksamheten kan ni ringa till någon av hälsopedagogerna Charlotte Ovefelt 585 894 82 eller Mariette Veideskog, 585 868 43." +
											"</DIV>");
									}
								}
								#endregion

								if(!Qalco && !Qdepr && !Qburnout && Qscore < 12)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Friskvård</B><BR>Du är välkommen att delta i friskvårdens vanliga utbud. Klicka på länken för mer information:<BR><A HREF=\"http://inuti.karolinskauniversitetssjukhuset.se/templates/Page____8345.aspx\" TARGET=\"_blank\">http://inuti.karolinskauniversitetssjukhuset.se/templates/Page____8345.aspx</A>");
								}

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
							else
							{
								#region webbqps annotated
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = true;
								bool Qneck = true;
								bool QbnSleep = true;
								bool QbnWork = true;
								bool QbnWorse = true;
								if(Qback || Qneck)
								{
									for(int i1=0; i1<2; i1++)
									{
										Qback = !Qback;
										for(int i2=0; i2<2; i2++)
										{
											Qneck = !Qneck;
											for(int i3=0; i3<2; i3++)
											{
												QbnSleep = !QbnSleep;
												for(int i4=0; i4<2; i4++)
												{
													QbnWork = !QbnWork;
													for(int i5=0; i5<2; i5++)
													{
														QbnWorse = !QbnWorse;

														if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
														{

															FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
															if(Qback)
															{
																FB.Append("Rygg <SPAN STYLE=\"color:#CC0000\">(om rygg)</SPAN>");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("Nacke <SPAN STYLE=\"color:#CC0000\">(om nacke)</SPAN>");
															}
															FB.Append("</B><BR>Du har angivit att du har besvär från ");
															if(Qback)
															{
																FB.Append("ryggen <SPAN STYLE=\"color:#CC0000\">(om rygg)</SPAN>");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("nacken <SPAN STYLE=\"color:#CC0000\">(om nacke)</SPAN>");
															}
															FB.Append(" samt att dessa besvär ");
															if(QbnWorse)
															{
																FB.Append("förvärras av arbetet <SPAN STYLE=\"color:#CC0000\">(om förvärras arbetet)</SPAN>");
																if(QbnSleep || QbnWork)
																{
																	FB.Append(" och att besvären ");
																}
															}
															if(QbnSleep || QbnWork)
															{
																FB.Append("varit så pass svåra att du haft svårt ");
																if(QbnSleep)
																{
																	FB.Append("att sova <SPAN STYLE=\"color:#CC0000\">(svårt sova)</SPAN>");
																	if(QbnWork)
																	{
																		FB.Append(" och ");
																	}
																}
																if(QbnWork)
																{
																	FB.Append("utföra ditt arbete <SPAN STYLE=\"color:#CC0000\">(svårt utföra arbete)</SPAN>");
																}
															}
															FB.Append(". Du rekommenderas att kontakta personalsjukgymnast.");
														}
													}
												}
											}
										}
									}
	
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sjukgymnastik</B> <SPAN STYLE=\"color:#CC0000\">(om rygg eller nacke)</SPAN>" +
										"<BR><BR>" +
										"Som en del av det förebyggande hälso- och arbetsmiljöarbetet finns det sjukgymnaster som arbetar med belastnings- och stressrelaterade besvär hos de anställda, både i Huddinge och i Solna. Syftet är att kunna göra en tidig insats vid arbetsrelaterade besvär." +
										"<BR><BR>" +
										"Du har möjlighet att få hjälp av en sjukgymnast om du har drabbats av smärta eller led-, rygg- eller muskelbesvär. Vi erbjuder en sjukgymnastisk bedömning, behandling och uppföljning. Du kan erbjudas olika former av friskvårdsträning alternativt remitteras till en annan vårdgivare." +
										"<BR>" +
										"Sjukgymnasterna arbetar på uppdrag av HR-avdelningen och samarbetar med Sektionen för arbetsmiljö och hälsa, samt med företagshälsovården." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Susanne Sandström och Eva Ajax, Leg sjukgymnast, 585 818 26." +
										"<BR>" +
										"Sjukgymnastikkliniken, R 41" +
										"<BR>" +
										"Telefontid: måndag kl. 12:30-13:30, torsdag kl. 10:30-11:30" +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Ulla Oxelbeck, Leg sjukgymnast 517 727 55." +
										"<BR>" +
										"Enheten för sjukgymnastik, en trappa ner (U1), i huvudentrén (röda hissarna)." +
										"</DIV>");
								}
								#endregion

								#region Smoke/Hosta/Pip

								if(1==1)
								{
									if(1==1)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(1==1)
										{
											FB.Append("Långvarig hosta <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om hosta)</SPAN>");
											if(1==1)
											{
												FB.Append(" och ");
											}
										}
										if(1==1)
										{
											FB.Append("Pip i bröstet <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om pip)</SPAN>");
										}
										FB.Append("</B> <B STYLE=\"color:#CC0000;\">+ Om röker</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									if(1==1)
									{
										FB.Append("<BR>");
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B> <B STYLE=\"color:#CC0000;\">Om röker, ej hosta ej pip</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Har du bestämt dig för att sluta röka eller snusa?<br>Internetbaserad kurs</B> <B STYLE=\"color:#CC0000;\">Om röker</B>" +
										"<BR><BR>" +
										"Ni kommer att på egen hand arbeta med materialet &quot;Sluta nu&quot;, vilket Cancerfonden, Folkhälsoinstitutet, Hjärt- och Lungfonden samt Läkare mot tobak står bakom." +
										"<BR><BR>" +
										"Varje vecka får du ett veckobrev av oss och mellan dem arbetar du med en internetbaserad sluta-röka/snusa skola själv. Du kan när som helst få stöd av oss via e-post. Du kommer under den första hälften av kursen förbereda dig mentalt på att sluta röka eller snusa, samt få information om nikotinhjälpmedel. Fimpardatum sker efter några veckor. Efter &quot;fimpardatumet&quot; kommer du att lära dig vad som händer vid nikotinstoppet och hur du kan ta hand om dig själv." +
										"<BR><BR>" +
										"<B>Start</B>: 1/10" +
										"<BR>" +
										"<B>Anmälan</B>: senast 24/9" +
										"<BR><BR>" +
										"<B>Så här anmäler du dig till kursen</B>" +
										"<BR>" +
										"<A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan till kursen sluta röka med hjälp av internet&Body=Namn:%0D%0AKontaktinformation:\">Klicka här</A> för att skicka anmälan via e-post till <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan till kursen sluta röka med hjälp av internet&Body=Namn:%0D%0AKontaktinformation:\">mariette.veideskog@karolinska.se</A>." +
										"<BR><BR>" +
										"Har ni frågor om kursverksamheten kan ni ringa till någon av hälsopedagogerna Charlotte Ovefelt 585 894 82 eller Mariette Veideskog, 585 868 43." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Den svåra konsten att sluta röka<br>Föreläsning</B> <B STYLE=\"color:#CC0000;\">Om röker</B>" +
										"<BR><BR>" +
										"Har du någon gång funderat på att sluta röka? Det har de flesta som röker. Oavsett om du har funderat på att sluta eller ej är du välkommen på denna föreläsning." +
										"<BR>" +
										"Även du som inte röker, men vill stötta folk i din närhet som vill sluta är välkommen." +
										"<BR><BR>" +
										"Vi kommer att diskutera de svårigheter vi får när vi försöker sluta röka, men också om olika möjligheter som kan underlätta beslutet och stoppet. Du får verktyg du kan använda dig av om och när du bestämt dig för att sluta." +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Måndagen den 1 oktober, kl 14:30-16:00" +
										"<BR>" +
										"Konferensrum 2, HR-avdelningen, CI 77" +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Onsdagen den 3 oktober, kl 14:30-16:00" +
										"<BR>" +
										"AGA-salen, Eugeniahemmet" +
										"<BR><BR>" +
										"<B>Föreläsare</B>:" +
										"<BR>" +
										"Mariette Weideskog, Hälsopedagog, Sektionen för arbetsmiljö och hälsa, HR-avdelningen, Karolinska" +
										"</DIV>");
								}
								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(1==1)
									{
										FB.Append("Långvarig hosta <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om hosta)</SPAN>");
										if(1==1)
										{
											FB.Append(" och ");
										}
									}
									if(1==1)
									{
										FB.Append("Pip i bröstet <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om pip)</SPAN>");
									}
									FB.Append("</B> <B STYLE=\"color:#CC0000;\">+ Om EJ röker</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion

								#region Alkohol

								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B> <B STYLE=\"color:#CC0000;\">Om 2-3 ggr/v eller oftare på fråga 31 SAMT varje månad eller oftare på fråga 31a ELLER 31b ELLER Ja, senaste året på fråga 31c</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Previa</B>" +
										"<BR><BR>" +
										"Kontakta företagssköterskan för rådgivning i alkohol- och drogfrågor." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B> <SPAN STYLE=\"color:#CC0000;\">Om 3 el. 4 på någon av 47-52 + ja på 53 (depression) samt om medel > 2.6 på fråga 38,40,41,44,45 (utbränd)</SPAN>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
										"<BR><BR>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B> <B STYLE=\"color:#CC0000;\">Om ej ovan samt medel > 2.6 på fråga 38,40,41,44,45 samt om medel > 2.75 på fråga 55-58</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper och mindfulnessträning. " +
										"Båda dessa alternativ kommer att finnas tillgängliga på din arbetsplats. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
										"<BR><BR>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B> <B STYLE=\"color:#CC0000;\">Om ej någon av de 2 ovan men medel > 2.6 på fråga 38,40,41,44,45</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper och mindfulnessträning. " +
										"Båda dessa alternativ kommer att finnas tillgängliga på din arbetsplats. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården.<BR><BR>");

									#region Mindfulness
									FB.Append("<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Mindfulnessmeditation</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Mindfulness kan beskrivas som ett förhållningssätt. Ett sätt att vara, lyssna och relatera. Mindfulness är ett observerande, icke-värderande och accepterande av det som händer i nuet. Istället för att ryckas med av t.ex. smärtförnimmelser, oro och katastroftankar lär man sig att förhålla sig som en välvillig men opartisk observatör av sin egen mentala aktivitet. Detta förhållningssätt underlättas av meditation där man övar sin förmåga att rikta och behålla uppmärksamheten. Mindfulnessmeditationen utförs i olika kroppspositioner; sittande, stående, liggande och när kroppen är i rörelse såväl som i stillhet." +
										"<BR><BR>" +
										"Mindfulnessmeditationen har visat sig ha en stressreducerade effekt, vilket antyder att den skulle kunna vara användbar också för att förebygga stress och stressrelaterade sjukdomstillstånd." +
										"<BR><BR>" +
										"Kursprogrammet är upplagt i enlighet med MBSR-programmet (Mindfulness Based Stress Reduction) som det utarbetats av pionjären Jon Kabat-Zinn i USA. Inledningsvis hålls ett orienteringsseminarium om kursens innehåll och bakgrund. Tyngdpunkten i kursen ligger på praktiska meditationsövningar under åtta grupptillfällen. Du förväntas att delta praktiskt (efter egen förmåga) i alla formella mindfulnessövningar och reflektera i grupp kring dina erfarenheter av övningarna. Var och en för dessutom en reflektionsdagbok." +
										"<BR><BR>" +
										"MBSR-programmet inkluderar en tyst dag (7-8 timmar) som är förlagd till lördagen eller söndagen (dag ej bestämt) efter seminarietillfälle sex. Detta tillfälle får du gå på din fritid. Under denna dag hålls lärarledda meditationsövningar." +
										"<BR><BR>" +
										"Du förväntas att utföra dagliga mindfulnessövningar i hemmet under ca 30 min 6-7 dagar/vecka. Vi vill passa på att göra dig uppmärksam på att kursen kräver motivation och beslutsamhet. Det krävs att du gör meditationsövningarna oavsett om det tar emot. Det kan paradoxalt nog upplevas stressande att ta del av en stressreducerande kurs. Om du redan på förhand vet att du inte kommer att kunna avsätta tid för de dagliga praktiska hemövningarna, så är kanske denna kurs inte rätt för dig just nu." +
										"<BR><BR>" +
										"<B>Tider för mindfulnessgrupper</B>" +
										"<BR><BR>" +
										"Solna: Torsdagar, kl 13:00-15:00, Gympasalen, Norrbacka. Start vecka 40." +
										"<BR>" +
										"Huddinge: Fredagar, kl 13:00-15:00. Grönasalen, personalgymmet, Novumhuset." +
										"<BR><BR>" +
										"Helgen, vecka 47  kommer vi att träffas en utav dagarna (lördag eller söndag är inte bestämt ännu) och ha en tyst dag för båda grupperna gemensamt (7-8 tim), preliminärt i Solna." +
										"<BR><BR>" +
										"<B>Frågor och anmälan</B>" +
										"<BR>" +
										"Är du intresserad av att deltaga i en mindfulnessgrupp, kan du välja mellan att gå den i Huddinge eller i Solna. Efter förankring hos arbetsledare, sker en av timmarna på betald arbetstid, den andra timmen får du ta av din fritid. Även helgdagen vecka 47 får du ta av din egen tid. Grupperna startar vecka 40. Kostnad för material (2 CD och 1 DVD) tillkommer med 290 kr. Deltagandet i gruppen kommer sedan att utvärderas avseende effekten på upplevd arbetsrelaterad stress och hälsa. " +
										"<BR><BR>" +
										"Eventuella frågor besvaras av kursledaren Camilla Sköld, Med dr, leg sjukgymnast via e-post till <A HREF=\"mailto:camilla.skold@telia.com\">camilla.skold@telia.com</A>." +
										"<BR><BR>" +
										"<A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan om intresse för Mindfulnessmeditation&Body=Namn:%0D%0ATelefonnummer hem:%0D%0APlats: (ange Huddinge eller Solna)\">Klicka här</A> för att skicka en anmälan via e-post till <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan om intresse för Mindfulnessmeditation&Body=Namn:%0D%0ATelefonnummer hem:%0D%0APlats: (ange Huddinge eller Solna)\">mariette.veideskog@karolinska.se</A>. I din anmälan vill vi att du uppger om du vill gå i Huddinge eller i Solna, samt telefonnummer hem. Sista anmälningsdag är den 24/9." +
										"</DIV>" +
										"<BR>");
									#endregion

									FB.Append("<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Erbjudande om att delta i Kollegiala Samtalsgrupper</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Ditt resultat av enkäten pekar på att du ligger på en hög stressnivå just nu. Upplevd stress hanteras på många olika sätt av olika individer och det är inte alls säkert att det behöver innebära något negativt, men det kan också tolkas som signaler på att något bör göras åt det." +
										"<BR>" +
										"Det finns inte <B><U>en</U></B> enkel lösning på problemet med stress och förebyggande åtgärder måste därför också ske inom många olika områden. Det krävs insatser såväl inom organisationen, på arbetsplatsen, i samhället i stort, som för den enskilde individen. Du som individ ges nu möjligheten att delta i;" +
										"<BR><BR>" +
										"<B>Reflekterande, kollegiala samtalsgrupper</B>" +
										"<BR>" +
										"Reflekterande kollegiala samtalsgrupper sker utifrån en pedagogisk metod  och är ett sätt att förebygga utveckling av arbetsrelaterad stress och utmattning. I tidigare studier med liknande grupper har man konstaterat att kollegialt stöd, tid för reflektion och erfarenhetsutbyte mellan kollegor visat sig vara mycket värdefullt för deltagarna." +
										"<BR>" +
										"Kollegor från olika arbetsplatser har ofta gemensamma yrkesrelaterade problem och erfarenheter, men samtidigt olika infallsvinklar och lösningar på dessa." +
										"<BR><BR>" +
										"<B>Genomförande</B>" +
										"<BR>" +
										"Vi kommer att skapa grupper med 8 personer ur samma eller liknande yrkesgrupp och leds av en handledare. Man träffas under 11 veckor, 2 timmar vid varje tillfälle. Efter förankring hos arbetsledare, sker en av timmarna på betald arbetstid, den andra timmen får du ta av din fritid." +
										"<BR><BR>" +
										"<B>Intresseanmälan och förfrågningar</B>" +
										"<BR>" +
										"<A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan om intresse för Reflekterande, kollegiala samtalsgrupper&Body=Namn:%0D%0AKontaktinformation:%0D%0AYrkeskategori:%0D%0APlats: (ange Huddinge eller Solna)\">Klicka här</A> för att skicka en intresseanmälan (och eventuella frågor) via e-post till <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan om intresse för Reflekterande, kollegiala samtalsgrupper&Body=Namn:%0D%0AKontaktinformation:%0D%0AYrkeskategori:%0D%0APlats: (ange Huddinge eller Solna)\">mariette.veideskog@karolinska.se</A>. I din anmälan vill vi att du uppger om du vill gå i Solna eller i Huddine, samt yrkeskategori." +
										"</DIV>" +
										"<BR>" +

										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Enskilda samtal</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Vi som arbetar i Sjukhuskyrkan har lång erfarenhet av att möta människor i sorg och kris. Att lyssna och tala om det riktigt svåra är en av våra allra viktigaste uppgifter. Syftet med samtalen är att stödja och hjälpa, ge hopp och mod. Samtalen kan ske vid ett eller flera tillfällen. " +
										"<BR><BR>" +
										"Sjukhuskyrkans enskilda samtal erbjuds alla, oavsett tro och livsåskådning. Många av dem vi träffar har i vanliga fall ingen anknytning till kyrkan. " +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Kontakta Leena Widén, ank 802 92 för bokning av samtal." +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Kontakta Hans-Peter Rasmussen, ank 740 73 för bokning av samtal." +
										"</DIV>" +
										"<BR>" +

										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stödsamtal hos Previa</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Är dina problem arbetsrelaterade kan du kontakta företagssköterskan på Previa för rådgivning." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B> <SPAN STYLE=\"color:#CC0000;\">Om ej någon av de 3 ovan samt om 3 el. 4 på någon av 47-52 + ja på 53 (nedstämdhet)</SPAN>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården.");
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									for(int i=0; i<5; i++)
									{
										string h = "";
										int a = 0;
										switch(i)
										{
											case 0: h = "Bra"; a = 310; break;
											case 1: h = "Ganska bra"; a = 311; break;
											case 2: h = "Varken är bra eller dålig"; a = 312; break;
											case 3: h = "Ganska dålig"; a = 313; break;
											case 4: h = "Dålig"; a = 314; break;
										}
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B> <B STYLE=\"color:#CC0000;\">= " + h + "</B>" +
											"<BR>" +
											"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
											"<BR><BR>");

										//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										switch(a)
										{
											case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
											case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
											case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
											case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
											case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
										}
									}
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">&quot;Hur sover du egentligen?&quot;</B> <B STYLE=\"color:#CC0000;\">Om Sömn = Varken är bra eller dålig, Ganska dålig, Dålig</B>" +
										"<BR><BR>" +
										"Tillhör du den kategorin som räknar får på natten så ska du komma på denna föreläsning. Vad är sömn egentligen? När ska man ta tupplurar?  Är det bra att räkna får? Du kommer få kunskap om hur vår sömncykel fungerar och få tips och idéer på vad du själv kan göra för att förbättra din sömn." +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Torsdagen den 11/10, kl 14:30-16:00, R 64." +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Måndagen den 8/10, kl 14:30-16:00, Skandiasalen, Astrid Lindgren." +
										"<BR><BR>" +
										"<B>Föreläsare</B>: Mariette Weideskog, Hälsopedagog, Sektionen för arbetsmiljö och hälsa, HR-avdelningen " +
										"<BR><BR>" +
										"Du behöver inte anmäla dig till föreläsningen, det är bara att komma. Du får gå på arbetstid och förutsätter medgivande från din närmsta chef." +
										"</DIV>");
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									for(int i=0; i<5; i++)
									{
										string h = "";
										int a = 0;
										switch(i)
										{
											case 0: h = "Bra"; a = 310; break;
											case 1: h = "Ganska bra"; a = 311; break;
											case 2: h = "Varken är bra eller dålig"; a = 315; break;
											case 3: h = "Ganska dålig"; a = 316; break;
											case 4: h = "Dålig"; a = 317; break;
										}
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B> <B STYLE=\"color:#CC0000;\">= " + h + "</B>" +
											"<BR>" +
											"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
											"<BR><BR>");

										//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										switch(a)
										{
											case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
											case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
											case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
										}
									}
								}
								#endregion

								#region Findrisk
								int Qscore = 0;
								for(int i=0; i<5; i++)
								{
									switch(i)
									{
										case 0: Qscore = 0; break;
										case 1: Qscore = 7; break;
										case 2: Qscore = 12; break;
										case 3: Qscore = 15; break;
										case 4: Qscore = 21; break;
									}
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B> <B STYLE=\"color:#CC0000;\">Ej diabetes diagnos, Findrisk score = " + Qscore + "</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
								}
								FB.Append("<BR><BR><B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos)</B><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");

								if(Qscore >= 12)
								{
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Individuell träningsrådgivning</B> <B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos, Findrisk score >= 12)</B>" +
										"<BR><BR>" +
										"Som anställd på Karolinska erbjuds du hjälp med individuell träningsrådgivning.  Det kan vara att få en styrketränings introduktion i vårt personalgym, hjälp med rörlighets- eller konditionsträning, stretchövningar m.m." +
										"<BR><BR>" +
										"För bokning av träningsrådgivning i <B>Solna</B>" +
										"<BR>" +
										"Tomas Hernvall, Friskvårdskonsulent/Gymföreståndare, Sektionen för arbetsmiljö och hälsa, HR-avdelningen,  ank 757 10.  " +
										"<BR><BR>" +
										"För bokning av träningsrådgivning i <B>Huddinge</B>" +
										"<BR>" +
										"Marie Hammarström, friskvårdskonsulent/Gymföreståndare, Sektionen för arbetsmiljö och hälsa, HR-avdelningen, ank 868 42." +
										"<BR><BR>" +
										"Du får gå på träningsrådgivningen på arbetstid och förutsätter medgivande av din närmsta chef." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">&quot;Kost, Rörelse, Hälsa&quot;</B> <B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos, Findrisk score >= 12)</B>" +
										"<BR><BR>" +
										"Vill du lära dig mer om kost och motion? Hur påverkar kosten och rörelsen ditt välbefinnande och din hälsa? Börjar favoritbyxorna sitta lite tight i midjan?  Nu har du chansen att på ett bra sätt hitta en hälsosam vikt och få bra vanor genom att lära dig mer om kostens och rörelsens betydelse." +
										"<BR><BR>" +
										"Kursen består av 9 gruppträffar a´ 1 timme. På träffarna kommer vi bland annat att diskutera våra mat- och motionsvanor och beteenden. Inom kosten kommer vi bland annat att prata om våra energikällor, måltidssammansättning, fettkällor samt kosttrender. Du kommer inte att följa någon diet, utan tanken är att du ska lära dig så mycket om kost så att du kan sätta samman en bra måltid själv. Fysisk aktivitet och rörelse är en viktig grundpelare i en hälsosam livsstil och en hjälp till att få energibalans och därmed en hälsosam vikt. Vi kommer bland annat att prata om positiva effekter av fysisk aktivitet och praktisera detta på ett enklare sätt. Hur lite kan du &quot;komma undan med&quot;?" +
										"<BR><BR>" +
										"Vid varje kurstillfälle har samtliga möjlighet att väga sig. Kursinnehåll delas ut vid första tillfället." +
										"<BR><BR>" +
										"<B>Datum, Tid & Lokal</B>" +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Tisdagar kl 11:00-12:00, med start vecka 40. Kursen kommer att hållas i Eugeniahemmet, första kurstillfället i Aga-salen." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Tisdagar, kl 15:00-16:00, med start vecka 40. Kursen kommer att hållas i konferensrummet i personalgymmet, Novumhuset." +
										"<BR><BR>" +
										"<B>Kursledare</B>" +
										"<BR>" +
										"Charlotte Ovefelt, Hälsopedagog" +
										"<BR><BR>" +
										"<B>Kostnad</B>" +
										"<BR>" +
										"Kursen är avgiftsfri och sker på arbetstid och förutsätter medgivande från din närmsta chef." +
										"<BR><BR>" +
										"<B>Anmälan</B>" +
										"<BR>" +
										"Senast fredag 24/9. <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan till Kost, Rörelse, Hälsa&Body=Namn:%0D%0AKontaktinformation:%0A%0APlats: (ange Huddinge eller Solna)\">Klicka här</A> för att skicka anmälan via e-post till <A HREF=\"mailto:mariette.veideskog@karolinska.se?Subject=Anmälan till Kost, Rörelse, Hälsa&Body=Namn:%0D%0AKontaktinformation:%0A%0APlats: (ange Huddinge eller Solna)\">mariette.veideskog@karolinska.se</A>. När du skickar din anmälan via e-post vill vi att du skriver kursens namn som ärende samt om du vill gå i Solna eller Huddinge." +
										"<BR><BR>" +
										"Har ni frågor om kursverksamheten kan ni ringa till någon av hälsopedagogerna Charlotte Ovefelt 585 894 82 eller Mariette Veideskog, 585 868 43." +
										"</DIV>");
								}
								#endregion

								#region Bra värden
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Friskvård</B> <SPAN STYLE=\"color:#CC0000\">(om bra hälsa, sover bra, ingen diabetesrisk)</SPAN><BR>Du är välkommen att delta i friskvårdens vanliga utbud. Klicka på länken för mer information:<BR><A HREF=\"http://inuti.karolinskauniversitetssjukhuset.se/templates/Page____8345.aspx\" TARGET=\"_blank\">http://inuti.karolinskauniversitetssjukhuset.se/templates/Page____8345.aspx</A>");
								#endregion
								
								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 26 || surveyID == 27)
						{
							// Haninge
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Du rekommenderas att kontakta sjukgymnast.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från företagshälsovården</B>" +
										"<BR><BR>" +
										"Kontakta företagssköterskan för rådgivning i alkohol- och drogfrågor, efter att först ha pratat med din arbetsledare." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. " +
											"Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. " +
											"Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare."); break;
									}
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
							else
							{
								#region webbqps all
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = true;
								bool Qneck = true;
								bool QbnSleep = true;
								bool QbnWork = true;
								bool QbnWorse = true;
								if(Qback || Qneck)
								{
									for(int i1=0; i1<2; i1++)
									{
										Qback = !Qback;
										for(int i2=0; i2<2; i2++)
										{
											Qneck = !Qneck;
											for(int i3=0; i3<2; i3++)
											{
												QbnSleep = !QbnSleep;
												for(int i4=0; i4<2; i4++)
												{
													QbnWork = !QbnWork;
													for(int i5=0; i5<2; i5++)
													{
														QbnWorse = !QbnWorse;

														if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
														{
															FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
															if(Qback)
															{
																FB.Append("Rygg");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("Nacke");
															}
															FB.Append("</B><BR>Du har angivit att du har besvär från ");
															if(Qback)
															{
																FB.Append("ryggen");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("nacken");
															}
															FB.Append(" samt att dessa besvär ");
															if(QbnWorse)
															{
																FB.Append("förvärras av arbetet");
																if(QbnSleep || QbnWork)
																{
																	FB.Append(" och att besvären ");
																}
															}
															if(QbnSleep || QbnWork)
															{
																FB.Append("varit så pass svåra att du haft svårt ");
																if(QbnSleep)
																{
																	FB.Append("att sova");
																	if(QbnWork)
																	{
																		FB.Append(" och ");
																	}
																}
																if(QbnWork)
																{
																	FB.Append("utföra ditt arbete");
																}
															}
															FB.Append(". Du rekommenderas att kontakta sjukgymnast.");
														}
													}
												}
											}
										}
									}
								}
								#endregion
								
								FB.Append("<BR>");
								
								#region Smoke/Hosta/Pip
								bool Qhosta = true;
								bool Qpip = true;
								bool Qsmoke = true;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare.");
									//}
								}
								//else if(Qpip || Qhosta)
								if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = true;
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från företagshälsovården</B>" +
										"<BR><BR>" +
										"Kontakta företagssköterskan för rådgivning i alkohol- och drogfrågor, efter att först ha pratat med din arbetsledare." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = true;
								bool Qpbs = true;
								bool Qdepr = true;

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare.");
									}
									//else if(Qpbs)
									if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. " +
											"Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. " +
										"Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare.");
									//}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare.");
								}
								#endregion

								FB.Append("<BR>");

								#region Sleep
								//if(oldValues.Contains("Q374O86"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								for(int i=310; i<=314; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare."); break;
									}
									if(i != 314)
									{
										FB.Append("<BR>");
									}
									FB.Append("<BR>");
								}
								//}
								#endregion

								#region Health
								//if(oldValues.Contains("Q331O98"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								for(int i=310; i<=317; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, efter att först ha pratat med din arbetsledare."); break;
									}
									if(i != 312 && i != 313 && i != 314 && i != 317)
									{
										FB.Append("<BR><BR>");
									}
								}
								//}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 28 || surveyID == 54 || surveyID == 109 || surveyID == 177 || surveyID == 155 || surveyID == 193 || surveyID == 201 || surveyID == 137)
						{
							// Generic 
							if(langID == 1)
							{
								if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
								{
									#region webbqps
									FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

									#region Rygg/nacke
									bool Qback = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
										);
									bool Qneck = 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
										|| 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
										|| 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
										);
									bool QbnSleep = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
									bool QbnWork = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
									bool QbnWorse = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
									if(Qback || Qneck)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qback)
										{
											FB.Append("Rygg");
											if(Qneck)
											{
												FB.Append(" och ");
											}
										}
										if(Qneck)
										{
											FB.Append("Nacke");
										}
										FB.Append("</B><BR>Du har angivit att du har besvär från ");
										if(Qback)
										{
											FB.Append("ryggen");
											if(Qneck)
											{
												FB.Append(" och ");
											}
										}
										if(Qneck)
										{
											FB.Append("nacken");
										}
										FB.Append(" samt att dessa besvär ");
										if(QbnWorse)
										{
											FB.Append("förvärras av arbetet");
											if(QbnSleep || QbnWork)
											{
												FB.Append(" och att besvären ");
											}
										}
										if(QbnSleep || QbnWork)
										{
											FB.Append("varit så pass svåra att du haft svårt ");
											if(QbnSleep)
											{
												FB.Append("att sova");
												if(QbnWork)
												{
													FB.Append(" och ");
												}
											}
											if(QbnWork)
											{
												FB.Append("utföra ditt arbete");
											}
										}
										FB.Append(". Du rekommenderas att kontakta sjukgymnast.");
									}
									#endregion

									#region Smoke/Hosta/Pip
									bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
									bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
									bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

									if(Qsmoke)
									{
										if(Qhosta || Qpip)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
											if(Qhosta)
											{
												FB.Append("Långvarig hosta");
												if(Qpip)
												{
													FB.Append(" och ");
												}
											}
											if(Qpip)
											{
												FB.Append("Pip i bröstet");
											}
											FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare.");
										}
									}
									else if(Qpip || Qhosta)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
									}
									#endregion
	
									#region Alkohol
									bool Qalco = 
										(
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
										||
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
										) 
										&& 
										(
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
										||
										oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
										);
									if(Qalco)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
											"<BR>" +
											"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
											"<BR><BR>" +
											"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
											"<BR><BR>" +
											"Nedan finns information om vart du kan vända dig för råd och stöd." +
											"<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
											"<BR><BR>" +
											"Alkohollinjen erbjuder stöd per telefon." +
											"<BR><BR>" +
											"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
											"<BR><BR>" +
											"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
											"<BR>" +
											"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
											"<BR>" +
											"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
											"<BR><BR>" +
											"Telefon 020-84 44 48" +
											"<BR>" +
											"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
											"<BR><BR>" +
											"Vilka svarar på Alkohollinjen?" +
											"<BR>" +
											"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
											"<BR><BR>" +
											"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
											"</DIV>");
									}
									#endregion

									#region Utbrändhet
									bool Qburnout = false;
									float score = 0f;
									string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 1; break;
												case 362: score += 2; break;
												case 363: score += 3; break;
												case 360: score += 4; break;
											}
										}
									}
									qos = ("Q382O114,Q383O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 4; break;
												case 362: score += 3; break;
												case 363: score += 2; break;
												case 360: score += 1; break;
											}
										}
									}
									if(score/5 > 2.6)
									{
										Qburnout = true;
									}

									bool Qpbs = false;
									score = 0f;
									qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 367: score += 5; break;
												case 363: score += 4; break;
												case 368: score += 3; break;
												case 369: score += 2; break;
												case 361: score += 1; break;
											}
										}
									}
									if(score/qos.Length > 3.25)
									{
										Qpbs = true;
									}

									bool Qdepr = 
										oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
										&& 
										(
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
										||
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
										);

									if(Qburnout)
									{
										if(Qdepr && Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
										}
										else if(Qdepr)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
												"<BR>" +
												"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
										}
										else if(Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
										}
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
											"<BR>" +
											"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
									}
									#endregion

									#region Sleep
									if(oldValues.Contains("Q374O86"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
											"<BR>" +
											"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										{
											case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
											case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
											case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
										}
									}
									#endregion

									#region Health
									if(oldValues.Contains("Q331O98"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
											"<BR>" +
											"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										{
											case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
											case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
											case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										}
									}
									#endregion

									double Qbmi = 0;
									if(
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										)
									{
										Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
											"<BR>" +
											"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

										if(Qbmi > 25)
										{
											feedbackAlert = true;
										}
									}
									int Qscore = 0;

									#region Findrisk
									if(
										(
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
										||
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
										)
										&&
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										&&
										oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
										&&
										oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
										&&
										oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
										&&
										oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
										&&
										oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
										)
									{
										int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
										bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
										//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
										double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
										bool Qnomotion = false;
										if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
										{
											Qnomotion = true;
										}
										if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
										{
											Qnomotion = true;
										}
										bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
										bool Qbp = 
											oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
											&& 
											oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
										bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
											Qscore += 3;
										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
											Qscore += 5;

										if(Qage >= 65)
										{
											Qscore += 4;
										}
										else if(Qage >= 55)
										{
											Qscore += 3;
										}
										else if(Qage >= 45)
										{
											Qscore += 2;
										}

										if(Qbmi > 30)
										{
											Qscore += 3;
										}
										else if(Qbmi >= 25)
										{
											Qscore += 1;
										}
		
										if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
										{
											Qscore += 4;
										}
										else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
										{
											Qscore += 3;
										}
										if(Qnomotion)
										{
											Qscore += 2;
										}
										if(Qnoveggies)
										{
											Qscore += 1;
										}
										if(Qbp)
										{
											Qscore += 2;
										}
										if(Qbs)
										{
											Qscore += 5;
										}

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
											"<BR>");
										if(Qscore > 20)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
										}
										else if(Qscore >= 15)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare för en noggrannare bedömning av risken.");
										}
										else if(Qscore >= 12)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else if(Qscore >= 7)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										FB.Append("<BR><BR>" +
											"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
											"<BR><BR>" +
											"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
									}
									#endregion

									#endregion

									SurveyIntro.Text += FB.ToString();
								}
								else
								{
									#region webbqps all
									FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

									#region Rygg/nacke
									bool Qback = true;
									bool Qneck = true;
									bool QbnSleep = true;
									bool QbnWork = true;
									bool QbnWorse = true;
									if(Qback || Qneck)
									{
										for(int i1=0; i1<2; i1++)
										{
											Qback = !Qback;
											for(int i2=0; i2<2; i2++)
											{
												Qneck = !Qneck;
												for(int i3=0; i3<2; i3++)
												{
													QbnSleep = !QbnSleep;
													for(int i4=0; i4<2; i4++)
													{
														QbnWork = !QbnWork;
														for(int i5=0; i5<2; i5++)
														{
															QbnWorse = !QbnWorse;

															if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
															{
																FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
																if(Qback)
																{
																	FB.Append("Rygg");
																	if(Qneck)
																	{
																		FB.Append(" och ");
																	}
																}
																if(Qneck)
																{
																	FB.Append("Nacke");
																}
																FB.Append("</B><BR>Du har angivit att du har besvär från ");
																if(Qback)
																{
																	FB.Append("ryggen");
																	if(Qneck)
																	{
																		FB.Append(" och ");
																	}
																}
																if(Qneck)
																{
																	FB.Append("nacken");
																}
																FB.Append(" samt att dessa besvär ");
																if(QbnWorse)
																{
																	FB.Append("förvärras av arbetet");
																	if(QbnSleep || QbnWork)
																	{
																		FB.Append(" och att besvären ");
																	}
																}
																if(QbnSleep || QbnWork)
																{
																	FB.Append("varit så pass svåra att du haft svårt ");
																	if(QbnSleep)
																	{
																		FB.Append("att sova");
																		if(QbnWork)
																		{
																			FB.Append(" och ");
																		}
																	}
																	if(QbnWork)
																	{
																		FB.Append("utföra ditt arbete");
																	}
																}
																FB.Append(". Du rekommenderas att kontakta sjukgymnast.");
															}
														}
													}
												}
											}
										}
									}
									#endregion
								
									FB.Append("<BR>");
								
									#region Smoke/Hosta/Pip
									bool Qhosta = true;
									bool Qpip = true;
									bool Qsmoke = true;

									if(Qsmoke)
									{
										if(Qhosta || Qpip)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
											if(Qhosta)
											{
												FB.Append("Långvarig hosta");
												if(Qpip)
												{
													FB.Append(" och ");
												}
											}
											if(Qpip)
											{
												FB.Append("Pip i bröstet");
											}
											FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
										}
										//else
										//{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare.");
										//}
									}
									//else if(Qpip || Qhosta)
									if(Qpip || Qhosta)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
									}
									#endregion
	
									#region Alkohol
									bool Qalco = true;
									if(Qalco)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
											"<BR>" +
											"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
											"<BR><BR>" +
											"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
											"<BR><BR>" +
											"Nedan finns information om vart du kan vända dig för råd och stöd." +
											"<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
											"<BR><BR>" +
											"Alkohollinjen erbjuder stöd per telefon." +
											"<BR><BR>" +
											"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
											"<BR><BR>" +
											"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
											"<BR>" +
											"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
											"<BR>" +
											"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
											"<BR><BR>" +
											"Telefon 020-84 44 48" +
											"<BR>" +
											"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
											"<BR><BR>" +
											"Vilka svarar på Alkohollinjen?" +
											"<BR>" +
											"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
											"<BR><BR>" +
											"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
											"</DIV>");
									}
									#endregion

									#region Utbrändhet
									bool Qburnout = true;
									bool Qpbs = true;
									bool Qdepr = true;

									if(Qburnout)
									{
										if(Qdepr && Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
										}
										//else 
										if(Qdepr)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
												"<BR>" +
												"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
										}
										//else 
										if(Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
										}
										//else
										//{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
										//}
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
											"<BR>" +
											"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
									}
									#endregion

									FB.Append("<BR>");

									#region Sleep
									//if(oldValues.Contains("Q374O86"))
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									for(int i=310; i<=314; i++)
									{
										switch(i)
										{
											case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
											case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
											case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
										}
										if(i != 314)
										{
											FB.Append("<BR>");
										}
										FB.Append("<BR>");
									}
									//}
									#endregion

									#region Health
									//if(oldValues.Contains("Q331O98"))
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									for(int i=310; i<=317; i++)
									{
										switch(i)
										{
											case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
											case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
											case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										}
										if(i != 312 && i != 313 && i != 314 && i != 317)
										{
											FB.Append("<BR><BR>");
										}
									}
									//}
									#endregion

									double Qbmi = 0;
									if(
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										)
									{
										Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
											"<BR>" +
											"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

										if(Qbmi > 25)
										{
											feedbackAlert = true;
										}
									}

									#region Findrisk
									int Qscore = 0;
									for(int i=0; i<5; i++)
									{
										switch(i)
										{
											case 0: Qscore = 0; break;
											case 1: Qscore = 7; break;
											case 2: Qscore = 12; break;
											case 3: Qscore = 15; break;
											case 4: Qscore = 21; break;
										}
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B> <B STYLE=\"color:#CC0000;\">Ej diabetes diagnos, Findrisk score = " + Qscore + "</B>" +
											"<BR>");
										if(Qscore > 20)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
										}
										else if(Qscore >= 15)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare för en noggrannare bedömning av risken.");
										}
										else if(Qscore >= 12)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else if(Qscore >= 7)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
									}
									FB.Append("<BR><BR><B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos)</B><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
									#endregion

									#endregion

									SurveyIntro.Text += FB.ToString();
								}
							}
							else
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Feedback</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

								if(Qback || Qneck)
								{
									feedbackAlert = true;
								}
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("Neck");
									}
									FB.Append("</B><BR>You have stated that you have pain in ");
									if(Qback)
									{
										FB.Append("the back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("neck");
									}
									FB.Append(" and that these pains ");
									if(QbnWorse)
									{
										FB.Append("are worsened by working");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" and that the pains ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("have been so severe that it has been difficult for you ");
										if(QbnSleep)
										{
											FB.Append("to sleep");
											if(QbnWork)
											{
												FB.Append(" and ");
											}
										}
										if(QbnWork)
										{
											FB.Append("perform your work");
										}
									}
									FB.Append(". Your are recommended to contact your occupational healthcare provider.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qhosta || Qpip || Qsmoke)
								{
									feedbackAlert = true;
								}
								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Long-term cough");
											if(Qpip)
											{
												FB.Append(" and ");
											}
										}
										if(Qpip)
										{
											FB.Append("Squeaking sound in the chest");
										}
										FB.Append("</B><BR>Your responses indicate that you have symptoms that could be do to your smoking. If have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Smoking</B><BR>As you probably know, smoking is hazardous to health. If you want help to quit smoking it is recommended that you contact your occupational healthcare provider.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Long-term cough");
										if(Qpip)
										{
											FB.Append(" and ");
										}
									}
									if(Qpip)
									{
										FB.Append("Squeaking sound in the chest");
									}
									FB.Append("</B><BR>Symptoms such as long-term cough and squeaking sound in the chest can be symptoms of asthma. If you are not treated for this already, it is recommended that you contact your occupational healthcare provider.<BR>");
								}
								#endregion

								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);

								if(Qalco)
								{
									feedbackAlert = true;
								}

								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alcohol</B>" +
										"<BR>" +
										"In our culture, alcohol is often included in social situations and it can have several positive effects. Your responses indicate that alcohol causes problems in your life. If you do something about the situation now, you can get good help. If you wait too long before addressing this, your problems can be prolonged and exacerbated." +
										"<BR><BR>" +
										"You can read more about drinking habits in the following links: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Below you will find information on where to turn for advice and support." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Support from the Alcohol-line</B>" +
										"<BR><BR>" +
										"Alcohol-line offers support via the phone." +
										"<BR><BR>" +
										"Are you thinking about your drinking habits? Call us and to talk with our advisors. If you need assistance in changing your habits, we can give you support. It's free." +
										"<BR><BR>" +
										"Those who turn to the alcohol line can choose between two options:" +
										"<BR>" +
										"- To either call for advice when you think you need it, or" +
										"<BR>" +
										"- To be called on a number of occasions for counseling and follow-up." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Who answers at the Alcohol line?" +
										"<BR>" +
										"Among the advisers there are general practitioners, nurses, psychologists, health educators and public health experts." +
										"<BR><BR>" +
										"The opening hours of the Alcohol line will initially be Monday thru Thursday between 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Chronic fatigue depression</B>" +
											"<BR>" +
											"Your answers indicate that you may have symptoms of depression. Nowadays depression can be treated with excellent results. If you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Stress</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"The risk of prolonged symptoms increases significantly if you put such high demands on yourself that you do not take the time to rest and recover. " +
											"There is good evidence that a burnout process can be stopped. If you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Stress</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"There is good evidence that a burnout process can be stopped. If you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
										"<BR>" +
										"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sleep</B>" +
										"<BR>" +
										"Sleep is our most important resource for recovery and it is essential to preserve health, welfare and performance for instance. During sleep several important hormones that repair, heal and restore the body are secreted. If sleep is disturbed for a longer period, there is a higher risk of eventually suffering from various stress-related diseases." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("You have indicated that your sleep is Good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 311: FB.Append("You have indicated that your sleep is Quite good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 312: FB.Append("You have indicated that your sleep is Neither good nor bad. If you feel that you have repeated difficulty in falling asleep, or sleeping well or you are not well rested when you wake up, it is necessary to improve your sleep, for ultimately preserving the health and wellbeing. In this case it is important to remember to unwind at least two hours before bedtime. Sleep quality can also be improved by regularly doing breathing and relaxation exercises before bedtime."); break;
										case 313: feedbackAlert = true; FB.Append("You have indicated that your sleep is Quite poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational healthcare provider."); break;
										case 314: feedbackAlert = true; FB.Append("You have indicated that your sleep is Poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational healthcare provider."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Health</B>" +
										"<BR>" +
										"It is now well established that self-rated health is an important indicator of how you will feel in the future. If you consider your health to be very good or good you are far more likely to maintain/improve your health in the future compared with those who estimate their health as poor." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("You have rated your health to be Good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 311: FB.Append("You have rated your health to be Quite good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 315: FB.Append("You have rated your health to be Neither good nor bad, which means that there may be a risk that your health deteriorates further in the future. Since self-rated health is a summary measure of both physical and mental wellbeing, we recommend that you review your lifestyle, for example in terms of physical exercise, sleep, and eating habits."); break;
										case 316: feedbackAlert = true; FB.Append("You have indicated your health to be Quite poor. If it is not just a temporary feeling, and you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider for a discussion of your health and what might be done to improve it."); break;
										case 317: feedbackAlert = true; FB.Append("You have indicated your health to be Poor. If it is not just a temporary feeling, and you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider for a discussion of your health and what might be done to improve it."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) is the most commonly used measure to define obesity. <B>Your BMI is " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Classification</B></td><TD><B>(alternative term</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Health risk</B></TD></TR><TR><TD>Underweight; short weight</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>The risks vary depending on the cause of the underweight</TD></TR><TR><TD>Normal weight</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normal risk</TD></TR><TR><TD>Over weight</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Slightly increased</TD></TR><TR><TD><I>Obesity</I></td><TD><I>Severe obesity</I></td><TD><I>&ge; 30</I></td><TD><I>Moderately to highly increased</I></TD></TR><TR><TD>Obesity class I</td><TD>Obesity</td><TD>30,0 - 34,9</td><TD>Moderately increased, increased risk</TD></TR><TR><TD>Obesity class II</td><TD>Severe obesity</td><TD>35,0 - 39,9</td><TD>High, strongly increased risk</TD></TR><TR><TD>Obesity class III</td><TD>Extreme obesity</td><TD>&ge; 40</td><TD>Very high, extreme risk increase</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at serious risk of developing type 2 diabetes. An estimated 50 % fall ill. Regular, moderate exercise and a good diet reduce the risk of developing diabetes. It is therefore recommended that you contact your occupational healthcare provider to get a more accurate assessment of your blood sugar levels (both fasting and glucose load or blood sugar after a meal). These tests will show if you possibly have symptom free diabetes.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at high risk of developing type 2 diabetes. An estimated 33 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes. It is therefore suggested that you contact your occupational healthcare provider to get a more accurate risk assessment.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a moderate risk of developing type 2 diabetes. An estimated 17 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a slightly increased risk of developing type 2 diabetes. An estimated 4 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a low risk of developing type 2 diabetes. An estimated 1 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Type 2 diabetes (adult-onset diabetes, maturity onset diabetes) is a serious hereditary disease. But you can greatly influence the risk of getting diabetes through lifestyle. Obesity, especially abdominal obesity, physical inactivity, poor diet and smoking increases the risk of developing type 2 diabetes." +
										"<BR><BR>" +
										"Both older age and genetic factors may increase the risk for type 2 diabetes, and these factors can not be influenced. On the other hand, other risk factors such as obesity, abdominal obesity, physical inactivity, diet and smoking can be influenced. A healthy lifestyle can entirely prevent, or at least postpone type 2 diabetes as far in the future as possible. If you have diabetes in your family you should be particularly careful with your body weight over the years. Fat around the waist, so-called abdominal obesity, represents an additional risk. It may take time before you feel the symptoms of type 2 diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 223)
						{
							// Vattenfall

									#region webbqps
									FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

									#region Rygg/nacke
									bool Qback = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
										);
									bool Qneck = 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
										|| 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
										|| 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
										);
									bool QbnSleep = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
									bool QbnWork = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
									bool QbnWorse = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
									if(Qback || Qneck)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qback)
										{
											FB.Append("Rygg");
											if(Qneck)
											{
												FB.Append(" och ");
											}
										}
										if(Qneck)
										{
											FB.Append("Nacke");
										}
										FB.Append("</B><BR>Du har angivit att du har besvär från ");
										if(Qback)
										{
											FB.Append("ryggen");
											if(Qneck)
											{
												FB.Append(" och ");
											}
										}
										if(Qneck)
										{
											FB.Append("nacken");
										}
										FB.Append(" samt att dessa besvär ");
										if(QbnWorse)
										{
											FB.Append("förvärras av arbetet");
											if(QbnSleep || QbnWork)
											{
												FB.Append(" och att besvären ");
											}
										}
										if(QbnSleep || QbnWork)
										{
											FB.Append("varit så pass svåra att du haft svårt ");
											if(QbnSleep)
											{
												FB.Append("att sova");
												if(QbnWork)
												{
													FB.Append(" och ");
												}
											}
											if(QbnWork)
											{
												FB.Append("utföra ditt arbete");
											}
										}
										FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller Hälsa & Rehab.");
									}
									#endregion

									#region Smoke/Hosta/Pip
									bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
									bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
									bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

									if(Qsmoke)
									{
										if(Qhosta || Qpip)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
											if(Qhosta)
											{
												FB.Append("Långvarig hosta");
												if(Qpip)
												{
													FB.Append(" och ");
												}
											}
											if(Qpip)
											{
												FB.Append("Pip i bröstet");
											}
											FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller Hälsa & Rehab.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta företagshälsovården eller Hälsa & Rehab.");
										}
									}
									else if(Qpip || Qhosta)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller Hälsa & Rehab.<BR>");
									}
									#endregion
	
									#region Alkohol
									bool Qalco = 
										(
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
										||
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
										) 
										&& 
										(
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
										||
										oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
										);
									if(Qalco)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
											"<BR>" +
											"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
											"<BR><BR>" +
											"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
											"<BR><BR>" +
											"Nedan finns information om vart du kan vända dig för råd och stöd." +
											"<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
											"<BR><BR>" +
											"Alkohollinjen erbjuder stöd per telefon." +
											"<BR><BR>" +
											"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
											"<BR><BR>" +
											"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
											"<BR>" +
											"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
											"<BR>" +
											"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
											"<BR><BR>" +
											"Telefon 020-84 44 48" +
											"<BR>" +
											"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
											"<BR><BR>" +
											"Vilka svarar på Alkohollinjen?" +
											"<BR>" +
											"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
											"<BR><BR>" +
											"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
											"</DIV>");
									}
									#endregion

									#region Utbrändhet
									bool Qburnout = false;
									float score = 0f;
									string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 1; break;
												case 362: score += 2; break;
												case 363: score += 3; break;
												case 360: score += 4; break;
											}
										}
									}
									qos = ("Q382O114,Q383O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 4; break;
												case 362: score += 3; break;
												case 363: score += 2; break;
												case 360: score += 1; break;
											}
										}
									}
									if(score/5 > 2.6)
									{
										Qburnout = true;
									}

									bool Qpbs = false;
									score = 0f;
									qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 367: score += 5; break;
												case 363: score += 4; break;
												case 368: score += 3; break;
												case 369: score += 2; break;
												case 361: score += 1; break;
											}
										}
									}
									if(score/qos.Length > 3.25)
									{
										Qpbs = true;
									}

									bool Qdepr = 
										oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
										&& 
										(
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
										||
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
										);

									if(Qburnout)
									{
										if(Qdepr && Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller Hälsa & Rehab.");
										}
										else if(Qdepr)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
												"<BR>" +
												"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller Hälsa & Rehab.");
										}
										else if(Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller Hälsa & Rehab.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller Hälsa & Rehab.");
										}
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
											"<BR>" +
											"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller Hälsa & Rehab.");
									}
									#endregion

									#region Sleep
									if(oldValues.Contains("Q374O86"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
											"<BR>" +
											"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										{
											case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
											case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården eller Hälsa & Rehab."); break;
											case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården eller Hälsa & Rehab."); break;
										}
									}
									#endregion

									#region Health
									if(oldValues.Contains("Q331O98"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
											"<BR>" +
											"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										{
											case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
											case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården eller Hälsa & Rehab för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
											case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården eller Hälsa & Rehab för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										}
									}
									#endregion

									double Qbmi = 0;
									if(
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										)
									{
										Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
											"<BR>" +
											"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

										if(Qbmi > 25)
										{
											feedbackAlert = true;
										}
									}
									int Qscore = 0;

									#region Findrisk
									if(
										(
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
										||
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
										)
										&&
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										&&
										oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
										&&
										oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
										&&
										oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
										&&
										oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
										&&
										oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
										)
									{
										int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
										bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
										//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
										double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
										bool Qnomotion = false;
										if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
										{
											Qnomotion = true;
										}
										if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
										{
											Qnomotion = true;
										}
										bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
										bool Qbp = 
											oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
											&& 
											oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
										bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
											Qscore += 3;
										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
											Qscore += 5;

										if(Qage >= 65)
										{
											Qscore += 4;
										}
										else if(Qage >= 55)
										{
											Qscore += 3;
										}
										else if(Qage >= 45)
										{
											Qscore += 2;
										}

										if(Qbmi > 30)
										{
											Qscore += 3;
										}
										else if(Qbmi >= 25)
										{
											Qscore += 1;
										}
		
										if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
										{
											Qscore += 4;
										}
										else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
										{
											Qscore += 3;
										}
										if(Qnomotion)
										{
											Qscore += 2;
										}
										if(Qnoveggies)
										{
											Qscore += 1;
										}
										if(Qbp)
										{
											Qscore += 2;
										}
										if(Qbs)
										{
											Qscore += 5;
										}

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
											"<BR>");
										if(Qscore > 20)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården eller Hälsa & Rehab för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
										}
										else if(Qscore >= 15)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården eller Hälsa & Rehab för en noggrannare bedömning av risken.");
										}
										else if(Qscore >= 12)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else if(Qscore >= 7)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										FB.Append("<BR><BR>" +
											"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
											"<BR><BR>" +
											"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
									}
									#endregion

									#endregion

									SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 277)
						{
							// Generic närmaste chef

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka så kan din närmaste chef hjälpa dig med vart du kan vända dig.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem så kan din närmaste chef hjälpa dig med vart du kan vända dig."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem så kan din närmaste chef hjälpa dig med vart du kan vända dig."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, så kan din närmaste chef hjälpa dig med vart du kan vända dig för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du inte redan har en läkarkontakt så kan din närmaste chef hjälpa dig med vart du kan vända dig för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du inte redan har en läkarkontakt så kan din närmaste chef hjälpa dig med vart du kan vända dig för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 289)
						{
							// Jönköpings kommun

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du inte redan har en läkarkontakt så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du inte redan har en läkarkontakt så kan Ewa Bjurenstedt hjälpa dig med vart du kan vända dig för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 227 || surveyID == 232 || surveyID == 238 || surveyID == 252 || surveyID == 263 || surveyID == 270 || surveyID == 294)
						{
							// Generic företagshälsovården

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta företagshälsovården.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 284)
						{
							// Generic kontakta primärvården, din närmaste chef eller sjukvårdsförsäkringen

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med primärvården, din närmaste chef eller sjukvårdsförsäkringen.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med primärvården, din närmaste chef eller sjukvårdsförsäkringen.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta primärvården, din närmaste chef eller sjukvårdsförsäkringen.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med primärvården, din närmaste chef eller sjukvårdsförsäkringen.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med primärvården, din närmaste chef eller sjukvårdsförsäkringen.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med primärvården, din närmaste chef eller sjukvårdsförsäkringen.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med primärvården, din närmaste chef eller sjukvårdsförsäkringen.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med primärvården, din närmaste chef eller sjukvårdsförsäkringen.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med primärvården, din närmaste chef eller sjukvårdsförsäkringen.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta primärvården, din närmaste chef eller sjukvårdsförsäkringen."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta primärvården, din närmaste chef eller sjukvårdsförsäkringen."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar primärvården, din närmaste chef eller sjukvårdsförsäkringen för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar primärvården, din närmaste chef eller sjukvårdsförsäkringen för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar primärvården, din närmaste chef eller sjukvårdsförsäkringen för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar primärvården, din närmaste chef eller sjukvårdsförsäkringen för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 295)
						{
							// Generic kontakta din närmaste chef eller HR

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din närmaste chef eller HR.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din närmaste chef eller HR.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din närmaste chef eller HR.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din närmaste chef eller HR.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din närmaste chef eller HR.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din närmaste chef eller HR.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din närmaste chef eller HR.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din närmaste chef eller HR.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din närmaste chef eller HR.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din närmaste chef eller HR."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din närmaste chef eller HR."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din närmaste chef eller HR för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din närmaste chef eller HR för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din närmaste chef eller HR för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din närmaste chef eller HR för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 286)
						{
							// Akademiska - Friskhuset

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Friskhuset (HWFriskhuset@akademiska.se).");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Friskhuset (HWFriskhuset@akademiska.se).");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta Friskhuset (HWFriskhuset@akademiska.se).");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Friskhuset (HWFriskhuset@akademiska.se).<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Friskhuset (HWFriskhuset@akademiska.se).");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Friskhuset (HWFriskhuset@akademiska.se).");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Friskhuset (HWFriskhuset@akademiska.se).");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Friskhuset (HWFriskhuset@akademiska.se).");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Friskhuset (HWFriskhuset@akademiska.se).");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta Friskhuset (HWFriskhuset@akademiska.se)."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta Friskhuset (HWFriskhuset@akademiska.se)."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Friskhuset (HWFriskhuset@akademiska.se) för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Friskhuset (HWFriskhuset@akademiska.se) för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Friskhuset (HWFriskhuset@akademiska.se) för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Friskhuset (HWFriskhuset@akademiska.se) för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 268 || surveyID == 285)
						{
							// Generic företagshälsovården, ny SRH, sleep

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta företagshälsovården.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q4146O1129"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								int sleep = Convert.ToInt32("0" + (string)oldValues["Q4146O1129"]);
								if(sleep >= 87)
								{
									FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.");
								}
								else if(sleep >= 62)
								{
									FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.");
								}
								else if(sleep >= 37)
								{
									FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet.");
								}
								else if(sleep >= 12)
								{
									FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården.");
								}
								else if(sleep >= 0)
								{
									FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården.");
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q4145O55"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								int health = Convert.ToInt32("0" + (string)oldValues["Q4145O55"]);
								if(health >= 87)
								{
									FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden.");
								}
								else if(health >= 62)
								{
									FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden.");
								}
								else if(health >= 37)
								{
									FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor.");
								}
								else if(health >= 12)
								{
									FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det.");
								}
								else if(health >= 0)
								{
									FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det.");
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 250)
						{
							// Finansdepartementet

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Feelgood Östermalm via telefon 08-676 82 00.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Feelgood Östermalm via telefon 08-676 82 00.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta Feelgood Östermalm via telefon 08-676 82 00.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Feelgood Östermalm via telefon 08-676 82 00.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Feelgood Östermalm via telefon 08-676 82 00.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Feelgood Östermalm via telefon 08-676 82 00.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Feelgood Östermalm via telefon 08-676 82 00.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Feelgood Östermalm via telefon 08-676 82 00.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Feelgood Östermalm via telefon 08-676 82 00.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta Feelgood Östermalm via telefon 08-676 82 00."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta Feelgood Östermalm via telefon 08-676 82 00."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Feelgood Östermalm, via telefon 08-676 82 00, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Feelgood Östermalm, via telefon 08-676 82 00, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Feelgood Östermalm, via telefon 08-676 82 00, för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Feelgood Östermalm, via telefon 08-676 82 00, för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 274)
						{
							// Sthlm brandförsvar, Betania

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården Betania.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården Betania.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta företagshälsovården Betania.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården Betania.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården Betania.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården Betania.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården Betania.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården Betania.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården Betania.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården Betania."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården Betania."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården Betania för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården Betania för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården Betania för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården Betania för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 251 || surveyID == 272)
						{
							// Finansförbundet

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr && Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.");
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.");
								}
							}
							else if(Qdepr)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
									"<BR>" +
									"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning."); break;
									case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta Skandias Hälsosluss på 0771-51 55 10 för vidare vägledning."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Skandias Hälsosluss på 0771-51 55 10 för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Skandias Hälsosluss på 0771-51 55 10 för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								if(Qbmi > 25)
								{
									feedbackAlert = true;
								}
							}
							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Skandias Hälsosluss på 0771-51 55 10 för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Skandias Hälsosluss på 0771-51 55 10 för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							#endregion

							SurveyIntro.Text += FB.ToString();
								
						}
						else if(surveyID == 191 || surveyID == 195 || surveyID == 206 || surveyID == 240 || surveyID == 245 || surveyID == 254 || surveyID == 255 || surveyID == 267 || surveyID == 280)
						{
							// AZ 
							if(langID == 1)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Du rekommenderas att du tar kontakt med företagssköterskan alternativt sjukgymnast.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du tar kontakt med företagssköterskan.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du tar kontakt med företagssköterskan.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du tar kontakt med företagssköterskan för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagssköterskan.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagssköterskan.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagssköterskan.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagssköterskan.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att du tar kontakt med företagssköterskan."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att du tar kontakt med företagssköterskan."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med företagssköterskan för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med företagssköterskan för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du tar kontakt med företagssköterskan för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du tar kontakt med företagssköterskan för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
							else
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Feedback</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

								if(Qback || Qneck)
								{
									feedbackAlert = true;
								}
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("Neck");
									}
									FB.Append("</B><BR>You have stated that you have pain in ");
									if(Qback)
									{
										FB.Append("the back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("neck");
									}
									FB.Append(" and that these pains ");
									if(QbnWorse)
									{
										FB.Append("are worsened by working");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" and that the pains ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("have been so severe that it has been difficult for you ");
										if(QbnSleep)
										{
											FB.Append("to sleep");
											if(QbnWork)
											{
												FB.Append(" and ");
											}
										}
										if(QbnWork)
										{
											FB.Append("perform your work");
										}
									}
									FB.Append(". Your are recommended to contact your occupational healthcare provider.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qhosta || Qpip || Qsmoke)
								{
									feedbackAlert = true;
								}
								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Long-term cough");
											if(Qpip)
											{
												FB.Append(" and ");
											}
										}
										if(Qpip)
										{
											FB.Append("Squeaking sound in the chest");
										}
										FB.Append("</B><BR>Your responses indicate that you have symptoms that could be do to your smoking. If have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Smoking</B><BR>As you probably know, smoking is hazardous to health. If you want help to quit smoking it is recommended that you contact your occupational healthcare provider.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Long-term cough");
										if(Qpip)
										{
											FB.Append(" and ");
										}
									}
									if(Qpip)
									{
										FB.Append("Squeaking sound in the chest");
									}
									FB.Append("</B><BR>Symptoms such as long-term cough and squeaking sound in the chest can be symptoms of asthma. If you are not treated for this already, it is recommended that you contact your occupational healthcare provider.<BR>");
								}
								#endregion

								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);

								if(Qalco)
								{
									feedbackAlert = true;
								}

								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alcohol</B>" +
										"<BR>" +
										"In our culture, alcohol is often included in social situations and it can have several positive effects. Your responses indicate that alcohol causes problems in your life. If you do something about the situation now, you can get good help. If you wait too long before addressing this, your problems can be prolonged and exacerbated." +
										"<BR><BR>" +
										"You can read more about drinking habits in the following links: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Below you will find information on where to turn for advice and support." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Support from the Alcohol-line</B>" +
										"<BR><BR>" +
										"Alcohol-line offers support via the phone." +
										"<BR><BR>" +
										"Are you thinking about your drinking habits? Call us and to talk with our advisors. If you need assistance in changing your habits, we can give you support. It's free." +
										"<BR><BR>" +
										"Those who turn to the alcohol line can choose between two options:" +
										"<BR>" +
										"- To either call for advice when you think you need it, or" +
										"<BR>" +
										"- To be called on a number of occasions for counseling and follow-up." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Who answers at the Alcohol line?" +
										"<BR>" +
										"Among the advisers there are general practitioners, nurses, psychologists, health educators and public health experts." +
										"<BR><BR>" +
										"The opening hours of the Alcohol line will initially be Monday thru Thursday between 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Chronic fatigue depression</B>" +
											"<BR>" +
											"Your answers indicate that you may have symptoms of depression. Nowadays depression can be treated with excellent results. If you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Stress</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"The risk of prolonged symptoms increases significantly if you put such high demands on yourself that you do not take the time to rest and recover. " +
											"There is good evidence that a burnout process can be stopped. If you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Stress</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"There is good evidence that a burnout process can be stopped. If you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
										"<BR>" +
										"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sleep</B>" +
										"<BR>" +
										"Sleep is our most important resource for recovery and it is essential to preserve health, welfare and performance for instance. During sleep several important hormones that repair, heal and restore the body are secreted. If sleep is disturbed for a longer period, there is a higher risk of eventually suffering from various stress-related diseases." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("You have indicated that your sleep is Good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 311: FB.Append("You have indicated that your sleep is Quite good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 312: FB.Append("You have indicated that your sleep is Neither good nor bad. If you feel that you have repeated difficulty in falling asleep, or sleeping well or you are not well rested when you wake up, it is necessary to improve your sleep, for ultimately preserving the health and wellbeing. In this case it is important to remember to unwind at least two hours before bedtime. Sleep quality can also be improved by regularly doing breathing and relaxation exercises before bedtime."); break;
										case 313: feedbackAlert = true; FB.Append("You have indicated that your sleep is Quite poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational healthcare provider."); break;
										case 314: feedbackAlert = true; FB.Append("You have indicated that your sleep is Poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational healthcare provider."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Health</B>" +
										"<BR>" +
										"It is now well established that self-rated health is an important indicator of how you will feel in the future. If you consider your health to be very good or good you are far more likely to maintain/improve your health in the future compared with those who estimate their health as poor." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("You have rated your health to be Good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 311: FB.Append("You have rated your health to be Quite good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 315: FB.Append("You have rated your health to be Neither good nor bad, which means that there may be a risk that your health deteriorates further in the future. Since self-rated health is a summary measure of both physical and mental wellbeing, we recommend that you review your lifestyle, for example in terms of physical exercise, sleep, and eating habits."); break;
										case 316: feedbackAlert = true; FB.Append("You have indicated your health to be Quite poor. If it is not just a temporary feeling, and you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider for a discussion of your health and what might be done to improve it."); break;
										case 317: feedbackAlert = true; FB.Append("You have indicated your health to be Poor. If it is not just a temporary feeling, and you have not already sought help from a physician, it is recommended that you contact your occupational healthcare provider for a discussion of your health and what might be done to improve it."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) is the most commonly used measure to define obesity. <B>Your BMI is " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Classification</B></td><TD><B>(alternative term</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Health risk</B></TD></TR><TR><TD>Underweight; short weight</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>The risks vary depending on the cause of the underweight</TD></TR><TR><TD>Normal weight</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normal risk</TD></TR><TR><TD>Over weight</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Slightly increased</TD></TR><TR><TD><I>Obesity</I></td><TD><I>Severe obesity</I></td><TD><I>&ge; 30</I></td><TD><I>Moderately to highly increased</I></TD></TR><TR><TD>Obesity class I</td><TD>Obesity</td><TD>30,0 - 34,9</td><TD>Moderately increased, increased risk</TD></TR><TR><TD>Obesity class II</td><TD>Severe obesity</td><TD>35,0 - 39,9</td><TD>High, strongly increased risk</TD></TR><TR><TD>Obesity class III</td><TD>Extreme obesity</td><TD>&ge; 40</td><TD>Very high, extreme risk increase</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at serious risk of developing type 2 diabetes. An estimated 50 % fall ill. Regular, moderate exercise and a good diet reduce the risk of developing diabetes. It is therefore recommended that you contact your occupational healthcare provider to get a more accurate assessment of your blood sugar levels (both fasting and glucose load or blood sugar after a meal). These tests will show if you possibly have symptom free diabetes.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at high risk of developing type 2 diabetes. An estimated 33 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes. It is therefore suggested that you contact your occupational healthcare provider to get a more accurate risk assessment.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a moderate risk of developing type 2 diabetes. An estimated 17 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a slightly increased risk of developing type 2 diabetes. An estimated 4 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a low risk of developing type 2 diabetes. An estimated 1 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Type 2 diabetes (adult-onset diabetes, maturity onset diabetes) is a serious hereditary disease. But you can greatly influence the risk of getting diabetes through lifestyle. Obesity, especially abdominal obesity, physical inactivity, poor diet and smoking increases the risk of developing type 2 diabetes." +
										"<BR><BR>" +
										"Both older age and genetic factors may increase the risk for type 2 diabetes, and these factors can not be influenced. On the other hand, other risk factors such as obesity, abdominal obesity, physical inactivity, diet and smoking can be influenced. A healthy lifestyle can entirely prevent, or at least postpone type 2 diabetes as far in the future as possible. If you have diabetes in your family you should be particularly careful with your body weight over the years. Fat around the waist, so-called abdominal obesity, represents an additional risk. It may take time before you feel the symptoms of type 2 diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 120 || surveyID == 172 || surveyID == 175)
						{
							// AMF SSM 
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(".");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>." +
										"<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5>" +
										"<TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR>" +
										"<TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR>" +
										"<TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR>" +
										"<TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR>" +
										"<TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR>" +
										"<TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR>" +
										"<TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR>" +
										"<TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR>" +
										"</TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 129)
						{
							// AMF Pensionsmyndigheten 
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Previa på telefon 08-726 72 68."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Previa på telefon 08-726 72 68 för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Previa på telefon 08-726 72 68 för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Previa på telefon 08-726 72 68 för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Previa på telefon 08-726 72 68 för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 132)
						{
							// AMF PwC 
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till SEB Trygg Liv på telefon 020 11 11 633."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar SEB Trygg Liv på telefon 020 11 11 633 för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar SEB Trygg Liv på telefon 020 11 11 633 för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar SEB Trygg Liv på telefon 020 11 11 633 för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar SEB Trygg Liv på telefon 020 11 11 633 för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 148)
						{
							// AMF Unionen Region SV
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård på e-post anna.jardbring@feelgood.se.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård på e-post anna.jardbring@feelgood.se.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till Unionen i Stockholms företagshälsovård på telefon 08-534 806 03.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till Unionen i Stockholms företagshälsovård på telefon 08-534 806 03.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård på e-post anna.jardbring@feelgood.se.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård på e-post anna.jardbring@feelgood.se.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård på e-post anna.jardbring@feelgood.se.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård på e-post anna.jardbring@feelgood.se.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård på e-post anna.jardbring@feelgood.se.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Unionen i Stockholms företagshälsovård på telefon 08-534 806 03."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Unionen i Stockholms företagshälsovård på telefon 08-534 806 03."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Unionens företagshälsovård på e-post anna.jardbring@feelgood.se för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Unionens företagshälsovård på e-post anna.jardbring@feelgood.se för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Unionens företagshälsovård på e-post anna.jardbring@feelgood.se för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Unionens företagshälsovård på e-post anna.jardbring@feelgood.se för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 136 || surveyID == 205 || surveyID == 207 || surveyID == 217 || surveyID == 222 || surveyID == 233 || surveyID == 235 || surveyID == 247 || surveyID == 275 || surveyID == 288)
						{
							// AMF Unionen 
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionens företagshälsovård.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till Unionens företagshälsovård.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till Unionens företagshälsovård.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på att du känner dig nedstämd och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du hör av dig till Unionens företagshälsovård, om du upplever att dessa symptom är ett problem för dig.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på att du känner dig nedstämd och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår rekommenderar vi att du hör av dig till Unionens företagshälsovård, om du upplever att dessa symptom är ett problem för dig.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du hör av dig till Unionens företagshälsovård, om du upplever att dessa symptom är ett problem för dig.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp.  Om du inte redan har en läkarkontakt, föreslår vi att du hör av dig till Unionens företagshälsovård, om du upplever att dessa symptom är ett problem för dig.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du hör av dig till Unionens företagshälsovård, om du upplever att dessa symptom är ett problem för dig.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Unionens företagshälsovård."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Unionens företagshälsovård."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Unionens företagshälsovård för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Unionens företagshälsovård för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Unionens företagshälsovård för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Unionens företagshälsovård för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 261)
						{
							// FTF 
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på att du känner dig nedstämd och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, om du upplever att dessa symptom är ett problem för dig.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på att du känner dig nedstämd och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår rekommenderar vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, om du upplever att dessa symptom är ett problem för dig.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, om du upplever att dessa symptom är ett problem för dig.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp.  Om du inte redan har en läkarkontakt, föreslår vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, om du upplever att dessa symptom är ett problem för dig.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, om du upplever att dessa symptom är ett problem för dig.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Hälsocentralen på Sophiahemmet, telefonnummer 08-406 22 50, för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 141 || surveyID == 162)
						{
							// AMF Unionen Småland
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64).");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64)."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64)."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64) för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64) för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64) för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Unionen företagshälsovård (Växjö 0470-72 67 02, Kalmar/Oskarshamn 0480-564 50, Jönköping 036-32 82 64) för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 142)
						{
							// AMF Unionen Bergslagen
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till Feelgood Företagshälsa på telefon 019-603 61 00."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Feelgood Företagshälsa på telefon 019-603 61 00 för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar Feelgood Företagshälsa på telefon 019-603 61 00 för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Feelgood Företagshälsa på telefon 019-603 61 00 för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar Feelgood Företagshälsa på telefon 019-603 61 00 för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 149 || surveyID == 174)
						{
							// AMF Cision
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com).");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com)."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com)."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com) för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com) för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com) för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar HR (Karin Persson, tel 08-5074 1812, karin.persson@cision.com) för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 150 || surveyID == 176 || surveyID == 194 || surveyID == 204 || surveyID == 220 || surveyID == 221 || surveyID == 262)
						{
							// AMF SU
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en vårdkontakt rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se).");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se)."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi att du hör av dig till företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se)."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se) för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se) för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se) för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagssköterska Jenni Björnevik på Avonova (Tel: 08 120 124 46, Jennie.bjornevik@avonova.se, Drop in tider: tisdagar 8-12 och torsdagar 12-16 i rum B4117 i Södra huset, http://www.avonova.se) för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 158 || surveyID == 170)
						{
							// AMF TDC
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 196)
						{
							// AMF TDC annan åk
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vid behov kan du ta kontakt med Torbjörn Severin (telefon 08-563 100 88) eller Lovisa Nordquist (telefon 08-519 810 78) på HR.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 166 || surveyID == 190)
						{
							// AMF Abbott
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Du kan ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Du kan ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du vill komma i kontakt med företagshälsovården kan du ringa Employment Assistance Program (EAP) på telefonnummer 0200-21 63 00. Du har rätt till 6 kostnadsfria besök. Använd Abbott som lösenord.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 199)
						{
							// AMF Abbott English, no phonenumber
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("Neck");
									}
									FB.Append("</B><BR>You have stated that you have pain in ");
									if(Qback)
									{
										FB.Append("the back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("neck");
									}
									FB.Append(" and that these pains ");
									if(QbnWorse)
									{
										FB.Append("are worsened by working");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" and that the pains ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("have been so severe that it has been difficult for you ");
										if(QbnSleep)
										{
											FB.Append("to sleep");
											if(QbnWork)
											{
												FB.Append(" and ");
											}
										}
										if(QbnWork)
										{
											FB.Append("perform your work");
										}
									}
									FB.Append(". Your are recommended to contact Employment Assistance Program (EAP).");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Long-term cough");
											if(Qpip)
											{
												FB.Append(" and ");
											}
										}
										if(Qpip)
										{
											FB.Append("Squeaking sound in the chest");
										}
										FB.Append("</B><BR>Your responses indicate that you have symptoms that could be do to your smoking. If have not already sought help from a physician, it is recommended that you contact Employment Assistance Program (EAP).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Smoking</B><BR>As you probably know, smoking is hazardous to health. If you want help to quit smoking it is recommended that you contact Employment Assistance Program (EAP).");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Long-term cough");
										if(Qpip)
										{
											FB.Append(" and ");
										}
									}
									if(Qpip)
									{
										FB.Append("Squeaking sound in the chest");
									}
									FB.Append("</B><BR>Symptoms such as long-term cough and squeaking sound in the chest can be symptoms of asthma. If you are not treated for this already, it is recommended that you contact Employment Assistance Program (EAP).<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alcohol</B>" +
										"<BR>" +
										"In our culture, alcohol is often included in social situations and it can have several positive effects. Your responses indicate that alcohol causes problems in your life. If you do something about the situation now, you can get good help. If you wait too long before addressing this, your problems can be prolonged and exacerbated." +
										"<BR><BR>" +
										"You can read more about drinking habits in the following links: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Below you will find information on where to turn for advice and support." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Support from the Alcohol-line</B>" +
										"<BR><BR>" +
										"Alcohol-line offers support via the phone." +
										"<BR><BR>" +
										"Are you thinking about your drinking habits? Call us and to talk with our advisors. If you need assistance in changing your habits, we can give you support. It's free." +
										"<BR><BR>" +
										"Those who turn to the alcohol line can choose between two options:" +
										"<BR>" +
										"- To either call for advice when you think you need it, or" +
										"<BR>" +
										"- To be called on a number of occasions for counseling and follow-up." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Who answers at the Alcohol line?" +
										"<BR>" +
										"Among the advisers there are general practitioners, nurses, psychologists, health educators and public health experts." +
										"<BR><BR>" +
										"The opening hours of the Alcohol line will initially be Monday thru Thursday between 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Chronic fatigue depression</B>" +
											"<BR>" +
											"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact Employment Assistance Program (EAP).");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"The risk of prolonged symptoms increases significantly if you put such high demands on yourself that you do not take the time to rest and recover. " +
											"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact Employment Assistance Program (EAP).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact Employment Assistance Program (EAP).");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
										"<BR>" +
										"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact Employment Assistance Program (EAP).");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sleep</B>" +
										"<BR>" +
										"Sleep is our most important resource for recovery and it is essential to preserve health, welfare and performance for instance. During sleep several important hormones that repair, heal and restore the body are secreted. If sleep is disturbed for a longer period, there is a higher risk of eventually suffering from various stress-related diseases." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("You have indicated that your sleep is Good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 311: FB.Append("You have indicated that your sleep is Quite good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 312: FB.Append("You have indicated that your sleep is Neither good nor bad. If you feel that you have repeated difficulty in falling asleep, or sleeping well or you are not well rested when you wake up, it is necessary to improve your sleep, for ultimately preserving the health and wellbeing. In this case it is important to remember to unwind at least two hours before bedtime. Sleep quality can also be improved by regularly doing breathing and relaxation exercises before bedtime."); break;
										case 313: feedbackAlert = true; FB.Append("You have indicated that your sleep is Quite poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact Employment Assistance Program (EAP)."); break;
										case 314: feedbackAlert = true; FB.Append("You have indicated that your sleep is Poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact Employment Assistance Program (EAP)."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Health</B>" +
										"<BR>" +
										"It is now well established that self-rated health is an important indicator of how you will feel in the future. If you consider your health to be very good or good you are far more likely to maintain/improve your health in the future compared with those who estimate their health as poor." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("You have rated your health to be Good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 311: FB.Append("You have rated your health to be Quite good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 315: FB.Append("You have rated your health to be Neither good nor bad, which means that there may be a risk that your health deteriorates further in the future. Since self-rated health is a summary measure of both physical and mental wellbeing, we recommend that you review your lifestyle, for example in terms of physical exercise, sleep, and eating habits."); break;
										case 316: feedbackAlert = true; FB.Append("You have indicated your health to be Quite poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact Employment Assistance Program (EAP) for a discussion of your health and what might be done to improve it."); break;
										case 317: feedbackAlert = true; FB.Append("You have indicated your health to be Poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact Employment Assistance Program (EAP) for a discussion of your health and what might be done to improve it."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) is the most commonly used measure to define obesity. <B>Your BMI is " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Classification</B></td><TD><B>(alternative term</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Health risk</B></TD></TR><TR><TD>Underweight; short weight</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>The risks vary depending on the cause of the underweight</TD></TR><TR><TD>Normal weight</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normal risk</TD></TR><TR><TD>Over weight</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Slightly increased</TD></TR><TR><TD><I>Obesity</I></td><TD><I>Severe obesity</I></td><TD><I>&ge; 30</I></td><TD><I>Moderately to highly increased</I></TD></TR><TR><TD>Obesity class I</td><TD>Obesity</td><TD>30,0 - 34,9</td><TD>Moderately increased, increased risk</TD></TR><TR><TD>Obesity class II</td><TD>Severe obesity</td><TD>35,0 - 39,9</td><TD>High, strongly increased risk</TD></TR><TR><TD>Obesity class III</td><TD>Extreme obesity</td><TD>&ge; 40</td><TD>Very high, extreme risk increase</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at serious risk of developing type 2 diabetes. An estimated 50 % fall ill. Regular, moderate exercise and a good diet reduce the risk of developing diabetes. It is therefore recommended that you contact Employment Assistance Program (EAP) to get a more accurate assessment of your blood sugar levels (both fasting and glucose load or blood sugar after a meal). These tests will show if you possibly have symptom free diabetes.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at high risk of developing type 2 diabetes. An estimated 33 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes. It is therefore suggested that you contact Employment Assistance Program (EAP) to get a more accurate risk assessment.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a moderate risk of developing type 2 diabetes. An estimated 17 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a slightly increased risk of developing type 2 diabetes. An estimated 4 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a low risk of developing type 2 diabetes. An estimated 1 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Type 2 diabetes (adult-onset diabetes, maturity onset diabetes) is a serious hereditary disease. But you can greatly influence the risk of getting diabetes through lifestyle. Obesity, especially abdominal obesity, physical inactivity, poor diet and smoking increases the risk of developing type 2 diabetes." +
										"<BR><BR>" +
										"Both older age and genetic factors may increase the risk for type 2 diabetes, and these factors can not be influenced. On the other hand, other risk factors such as obesity, abdominal obesity, physical inactivity, diet and smoking can be influenced. A healthy lifestyle can entirely prevent, or at least postpone type 2 diabetes as far in the future as possible. If you have diabetes in your family you should be particularly careful with your body weight over the years. Fat around the waist, so-called abdominal obesity, represents an additional risk. It may take time before you feel the symptoms of type 2 diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 169 || surveyID == 259 || surveyID == 273 || surveyID == 291)
						{
							// Vårdförbundet -- företagshälsovården eller HR
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr && Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på nedstämdhet och en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp och nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på nedstämdhet och hög eller långvarig stress. Nuförtiden kan både nedstämdhet och symtom på långvarig stress behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög eller långvarig stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med företagshälsovården eller HR."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du tar kontakt med företagshälsovården eller HR."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}
								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården eller HR.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 29)
						{
							// SvKyrkan -- husläkare
							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");
								
								rs = Db.sqlRecordSet("SELECT pr.ExternalID FROM Answer a INNER JOIN ProjectRoundUser pr ON a.ProjectRoundUserID = pr.ProjectRoundUserID WHERE a.ProjectRoundUserID = " + projectRoundUserID);
								if(rs.Read())
								{
									FB.Append("<BR>Kod " + rs.GetInt32(0));
								}
								rs.Close();

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 30)
									{
										FB.Append("<BR>Ditt BMI är som du ser så högt att risken för framtida ohälsa (diabetes, hjärtsjukdom och även andra sjukdomar) är klart ökad. Vår rekommendation är att du försöker minska din vikt, i första hand genom att äta mindre och motionera mer. Kanske du redan har försökt och misslyckats? Ett tips kan vara att gå med i en viktreduktionsgrupp. Kanske det finns på din arbetsplats, eller kanske du själv kan ta initiativ till en sådan grupp. Du kan naturligtvis också ta kontakt med din husläkare.");
									}
								}

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.");
								}
								#endregion
	
								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									||
									oldValues.Contains("Q656O115") && Convert.ToInt32("0" + (string)oldValues["Q656O115"]) == 364
									||
									oldValues.Contains("Q656O115") && Convert.ToInt32("0" + (string)oldValues["Q656O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
								}
								#endregion

								#region Sleep
								float sleep = 0;
								if(oldValues.Contains("Q657O142"))
								{
									switch(Convert.ToInt32("0" + (string)oldValues["Q657O142"]))
									{
										case 443: sleep += 1; break;
										case 442: sleep += 2; break;
										case 441: sleep += 3; break;
									}
								}
								qos = ("Q375O113,Q376O113,Q377O113").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 359: sleep += 1; break;
											case 326: sleep += 2; break;
											case 358: sleep += 3; break;
										}
									}
								}
								qos = ("Q378O113,Q379O113").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 326: sleep += 1; break;
											case 359: sleep += 2; break;
											case 322: sleep += 3; break;
										}
									}
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								int Qsleep = Convert.ToInt32(Math.Round((sleep*1.33f)/6,0));
								switch(Qsleep)
								{
									case 0: FB.Append("Dina svar antyder att din sömn är bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 1: FB.Append("Dina svar antyder att din sömn är ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
									case 2: FB.Append("Dina svar antyder att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 3: FB.Append("Dina svar antyder att din sömn är ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
									case 4: FB.Append("Dina svar antyder att din sömn är dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									bool good = (Qbmi <= 30 && !Qsmoke && Qsleep < 2);

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är bra och verkar således" + (good ? " ha en hälsosam livsstil och/eller" : "") + " må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är ganska bra och verkar således" + (good ? " ha en hälsosam livsstil och/eller" : "") + " må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
							else
							{
								#region webbqps all
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är XX</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								FB.Append("<BR>(Om BMI > 30) Ditt BMI är som du ser så högt att risken för framtida ohälsa (diabetes, hjärtsjukdom och även andra sjukdomar) är klart ökad. Vår rekommendation är att du försöker minska din vikt, i första hand genom att äta mindre och motionera mer. Kanske du redan har försökt och misslyckats? Ett tips kan vara att gå med i en viktreduktionsgrupp. Kanske det finns på din arbetsplats, eller kanske du själv kan ta initiativ till en sådan grupp. Du kan naturligtvis också ta kontakt med din husläkare.");

								#region Smoke/Hosta/Pip
								bool Qhosta = true;
								bool Qpip = true;
								bool Qsmoke = true;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare.");
									//}
								}
								//else if(Qpip || Qhosta)
								if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.");
								}
								#endregion
	
								#region Utbrändhet
								bool Qburnout = true;
								bool Qpbs = true;
								bool Qdepr = true;

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
									//else if(Qpbs)
									if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									//}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
								}
								#endregion

								FB.Append("<BR>");

								#region Sleep
								//if(oldValues.Contains("Q374O86"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								for(int i=310; i<=314; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Dina svar antyder att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Dina svar antyder att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Dina svar antyder att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Dina svar antyder att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
										case 314: FB.Append("Dina svar antyder att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
									}
									if(i != 314)
									{
										FB.Append("<BR>");
									}
									FB.Append("<BR>");
								}
								//}
								#endregion

								#region Health
								//if(oldValues.Contains("Q331O98"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								for(int i=310; i<=317; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således (OM ej röker, ej sömnbrist, ej BMI > 30: ha en hälsosam livsstil och/eller) må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således (OM ej röker, ej sömnbrist, ej BMI > 30: ha en hälsosam livsstil och/eller) må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
									if(i != 312 && i != 313 && i != 314 && i != 317)
									{
										FB.Append("<BR><BR>");
									}
								}
								//}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 218 || surveyID == 225)
						{
							// Manpower Telia / Skanova

							if(langID == 1)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

								if(Qback || Qneck)
								{
									feedbackAlert = true;
								}
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Vi föreslår att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qhosta || Qpip || Qsmoke)
								{
									feedbackAlert = true;
								}
								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården.<BR>");
								}
								#endregion

								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);

								if(Qalco)
								{
									feedbackAlert = true;
								}

								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras. Om du inte redan har en läkarkontakt, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården." +
										"<BR><BR>" +
										"Du kan även läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns ytterliggare information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården."); break;
										case 314: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, föreslår vi att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården, för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår att du pratar med din ledare eller HR för vidare kontakt med företagshälsovården, för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion
							}
							else
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Feedback</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

								if(Qback || Qneck)
								{
									feedbackAlert = true;
								}
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("Neck");
									}
									FB.Append("</B><BR>You have stated that you have pain in ");
									if(Qback)
									{
										FB.Append("the back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("neck");
									}
									FB.Append(" and that these pains ");
									if(QbnWorse)
									{
										FB.Append("are worsened by working");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" and that the pains ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("have been so severe that it has been difficult for you ");
										if(QbnSleep)
										{
											FB.Append("to sleep");
											if(QbnWork)
											{
												FB.Append(" and ");
											}
										}
										if(QbnWork)
										{
											FB.Append("perform your work");
										}
									}
									FB.Append(". Your are recommended to contact your manager or human resources department for further contact with the occupational health care provider.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qhosta || Qpip || Qsmoke)
								{
									feedbackAlert = true;
								}
								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Long-term cough");
											if(Qpip)
											{
												FB.Append(" and ");
											}
										}
										if(Qpip)
										{
											FB.Append("Squeaking sound in the chest");
										}
										FB.Append("</B><BR>Your responses indicate that you have symptoms that could be do to your smoking. If have not already sought help from a physician, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Smoking</B><BR>As you probably know, smoking is hazardous to health. If you want help to quit smoking it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Long-term cough");
										if(Qpip)
										{
											FB.Append(" and ");
										}
									}
									if(Qpip)
									{
										FB.Append("Squeaking sound in the chest");
									}
									FB.Append("</B><BR>Symptoms such as long-term cough and squeaking sound in the chest can be symptoms of asthma. If you are not treated for this already, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider.<BR>");
								}
								#endregion

								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);

								if(Qalco)
								{
									feedbackAlert = true;
								}

								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alcohol</B>" +
										"<BR>" +
										"In our culture, alcohol is often included in social situations and it can have several positive effects. Your responses indicate that alcohol causes problems in your life. If you do something about the situation now, you can get good help. If you wait too long before addressing this, your problems can be prolonged and exacerbated." +
										"<BR><BR>" +
										"You can read more about drinking habits in the following links: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Below you will find information on where to turn for advice and support." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Support from the Alcohol-line</B>" +
										"<BR><BR>" +
										"Alcohol-line offers support via the phone." +
										"<BR><BR>" +
										"Are you thinking about your drinking habits? Call us and to talk with our advisors. If you need assistance in changing your habits, we can give you support. It's free." +
										"<BR><BR>" +
										"Those who turn to the alcohol line can choose between two options:" +
										"<BR>" +
										"- To either call for advice when you think you need it, or" +
										"<BR>" +
										"- To be called on a number of occasions for counseling and follow-up." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Who answers at the Alcohol line?" +
										"<BR>" +
										"Among the advisers there are general practitioners, nurses, psychologists, health educators and public health experts." +
										"<BR><BR>" +
										"The opening hours of the Alcohol line will initially be Monday thru Thursday between 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Chronic fatigue depression</B>" +
											"<BR>" +
											"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"The risk of prolonged symptoms increases significantly if you put such high demands on yourself that you do not take the time to rest and recover. " +
											"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
										"<BR>" +
										"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sleep</B>" +
										"<BR>" +
										"Sleep is our most important resource for recovery and it is essential to preserve health, welfare and performance for instance. During sleep several important hormones that repair, heal and restore the body are secreted. If sleep is disturbed for a longer period, there is a higher risk of eventually suffering from various stress-related diseases." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("You have indicated that your sleep is Good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 311: FB.Append("You have indicated that your sleep is Quite good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 312: FB.Append("You have indicated that your sleep is Neither good nor bad. If you feel that you have repeated difficulty in falling asleep, or sleeping well or you are not well rested when you wake up, it is necessary to improve your sleep, for ultimately preserving the health and wellbeing. In this case it is important to remember to unwind at least two hours before bedtime. Sleep quality can also be improved by regularly doing breathing and relaxation exercises before bedtime."); break;
										case 313: feedbackAlert = true; FB.Append("You have indicated that your sleep is Quite poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider."); break;
										case 314: feedbackAlert = true; FB.Append("You have indicated that your sleep is Poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Health</B>" +
										"<BR>" +
										"It is now well established that self-rated health is an important indicator of how you will feel in the future. If you consider your health to be very good or good you are far more likely to maintain/improve your health in the future compared with those who estimate their health as poor." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("You have rated your health to be Good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 311: FB.Append("You have rated your health to be Quite good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 315: FB.Append("You have rated your health to be Neither good nor bad, which means that there may be a risk that your health deteriorates further in the future. Since self-rated health is a summary measure of both physical and mental wellbeing, we recommend that you review your lifestyle, for example in terms of physical exercise, sleep, and eating habits."); break;
										case 316: feedbackAlert = true; FB.Append("You have indicated your health to be Quite poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider for a discussion of your health and what might be done to improve it."); break;
										case 317: feedbackAlert = true; FB.Append("You have indicated your health to be Poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your manager or human resources department for further contact with the occupational health care provider for a discussion of your health and what might be done to improve it."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) is the most commonly used measure to define obesity. <B>Your BMI is " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Classification</B></td><TD><B>(alternative term</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Health risk</B></TD></TR><TR><TD>Underweight; short weight</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>The risks vary depending on the cause of the underweight</TD></TR><TR><TD>Normal weight</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normal risk</TD></TR><TR><TD>Over weight</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Slightly increased</TD></TR><TR><TD><I>Obesity</I></td><TD><I>Severe obesity</I></td><TD><I>&ge; 30</I></td><TD><I>Moderately to highly increased</I></TD></TR><TR><TD>Obesity class I</td><TD>Obesity</td><TD>30,0 - 34,9</td><TD>Moderately increased, increased risk</TD></TR><TR><TD>Obesity class II</td><TD>Severe obesity</td><TD>35,0 - 39,9</td><TD>High, strongly increased risk</TD></TR><TR><TD>Obesity class III</td><TD>Extreme obesity</td><TD>&ge; 40</td><TD>Very high, extreme risk increase</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at serious risk of developing type 2 diabetes. An estimated 50 % fall ill. Regular, moderate exercise and a good diet reduce the risk of developing diabetes. It is therefore recommended that you contact your manager or human resources department for further contact with the occupational health care provider to get a more accurate assessment of your blood sugar levels (both fasting and glucose load or blood sugar after a meal). These tests will show if you possibly have symptom free diabetes.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at high risk of developing type 2 diabetes. An estimated 33 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes. It is therefore suggested that you contact your manager or human resources department for further contact with the occupational health care provider to get a more accurate risk assessment.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a moderate risk of developing type 2 diabetes. An estimated 17 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a slightly increased risk of developing type 2 diabetes. An estimated 4 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a low risk of developing type 2 diabetes. An estimated 1 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Type 2 diabetes (adult-onset diabetes, maturity onset diabetes) is a serious hereditary disease. But you can greatly influence the risk of getting diabetes through lifestyle. Obesity, especially abdominal obesity, physical inactivity, poor diet and smoking increases the risk of developing type 2 diabetes." +
										"<BR><BR>" +
										"Both older age and genetic factors may increase the risk for type 2 diabetes, and these factors can not be influenced. On the other hand, other risk factors such as obesity, abdominal obesity, physical inactivity, diet and smoking can be influenced. A healthy lifestyle can entirely prevent, or at least postpone type 2 diabetes as far in the future as possible. If you have diabetes in your family you should be particularly careful with your body weight over the years. Fat around the waist, so-called abdominal obesity, represents an additional risk. It may take time before you feel the symptoms of type 2 diabetes.");
								}
								#endregion

								#endregion
							}
							SurveyIntro.Text += FB.ToString();
						}
						else if(surveyID == 266)
						{
							// Manpower ABB

							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								if(langID == 1)
								{
									#region webbqps
									FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

									#region Rygg/nacke
									bool Qback = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
										);
									bool Qneck = 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
										|| 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
										|| 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
										);
									bool QbnSleep = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
									bool QbnWork = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
									bool QbnWorse = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

									if(Qback || Qneck)
									{
										feedbackAlert = true;
									}
									if(Qback || Qneck)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qback)
										{
											FB.Append("Rygg");
											if(Qneck)
											{
												FB.Append(" och ");
											}
										}
										if(Qneck)
										{
											FB.Append("Nacke");
										}
										FB.Append("</B><BR>Du har angivit att du har besvär från ");
										if(Qback)
										{
											FB.Append("ryggen");
											if(Qneck)
											{
												FB.Append(" och ");
											}
										}
										if(Qneck)
										{
											FB.Append("nacken");
										}
										FB.Append(" samt att dessa besvär ");
										if(QbnWorse)
										{
											FB.Append("förvärras av arbetet");
											if(QbnSleep || QbnWork)
											{
												FB.Append(" och att besvären ");
											}
										}
										if(QbnSleep || QbnWork)
										{
											FB.Append("varit så pass svåra att du haft svårt ");
											if(QbnSleep)
											{
												FB.Append("att sova");
												if(QbnWork)
												{
													FB.Append(" och ");
												}
											}
											if(QbnWork)
											{
												FB.Append("utföra ditt arbete");
											}
										}
										FB.Append(". Du rekommenderas att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården.");
									}
									#endregion

									#region Smoke/Hosta/Pip
									bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
									bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
									bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

									if(Qhosta || Qpip || Qsmoke)
									{
										feedbackAlert = true;
									}
									if(Qsmoke)
									{
										if(Qhosta || Qpip)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
											if(Qhosta)
											{
												FB.Append("Långvarig hosta");
												if(Qpip)
												{
													FB.Append(" och ");
												}
											}
											if(Qpip)
											{
												FB.Append("Pip i bröstet");
											}
											FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderas du att kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården.");
										}
									}
									else if(Qpip || Qhosta)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården.<BR>");
									}
									#endregion

									#region Alkohol
									bool Qalco = 
										(
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
										||
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
										) 
										&& 
										(
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
										||
										oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
										);

									if(Qalco)
									{
										feedbackAlert = true;
									}

									if(Qalco)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
											"<BR>" +
											"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården." +
											"<BR><BR>" +
											"Du kan även läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
											"<BR><BR>" +
											"Nedan finns ytterliggare information om vart du kan vända dig för råd och stöd." +
											"<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
											"<BR><BR>" +
											"Alkohollinjen erbjuder stöd per telefon." +
											"<BR><BR>" +
											"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
											"<BR><BR>" +
											"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
											"<BR>" +
											"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
											"<BR>" +
											"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
											"<BR><BR>" +
											"Telefon 020-84 44 48" +
											"<BR>" +
											"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
											"<BR><BR>" +
											"Vilka svarar på Alkohollinjen?" +
											"<BR>" +
											"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
											"<BR><BR>" +
											"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
											"</DIV>");
									}
									#endregion

									#region Utbrändhet
									bool Qburnout = false;
									float score = 0f;
									string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 1; break;
												case 362: score += 2; break;
												case 363: score += 3; break;
												case 360: score += 4; break;
											}
										}
									}
									qos = ("Q382O114,Q383O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 4; break;
												case 362: score += 3; break;
												case 363: score += 2; break;
												case 360: score += 1; break;
											}
										}
									}
									if(score/5 > 2.6)
									{
										Qburnout = true;
									}

									bool Qpbs = false;
									score = 0f;
									qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 367: score += 5; break;
												case 363: score += 4; break;
												case 368: score += 3; break;
												case 369: score += 2; break;
												case 361: score += 1; break;
											}
										}
									}
									if(score/qos.Length > 3.25)
									{
										Qpbs = true;
									}

									bool Qdepr = 
										oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
										&& 
										(
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
										||
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
										);

									if(Qburnout || Qdepr)
									{
										feedbackAlert = true;
									}
									if(Qburnout)
									{
										if(Qdepr)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
												"<BR>" +
												"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården.");
										}
										else if(Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
												"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
												"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
												"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården.");
										}
									}
									else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården.");
									}
									#endregion

									#region Sleep
									if(oldValues.Contains("Q374O86"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
											"<BR>" +
											"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										{
											case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
											case 313: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården."); break;
											case 314: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården."); break;
										}
									}
									#endregion

									#region Health
									if(oldValues.Contains("Q331O98"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
											"<BR>" +
											"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										{
											case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
											case 316: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
											case 317: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderas du att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										}
									}
									#endregion

									double Qbmi = 0;
									if(
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										)
									{
										Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
											"<BR>" +
											"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

										if(Qbmi > 25)
										{
											feedbackAlert = true;
										}
									}

									int Qscore = 0;

									#region Findrisk
									if(
										(
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
										||
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
										)
										&&
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										&&
										oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
										&&
										oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
										&&
										oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
										&&
										oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
										&&
										oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
										)
									{
										int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
										bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
										//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
										double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
										bool Qnomotion = false;
										if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
										{
											Qnomotion = true;
										}
										if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
										{
											Qnomotion = true;
										}
										bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
										bool Qbp = 
											oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
											&& 
											oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
										bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
											Qscore += 3;
										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
											Qscore += 5;

										if(Qage >= 65)
										{
											Qscore += 4;
										}
										else if(Qage >= 55)
										{
											Qscore += 3;
										}
										else if(Qage >= 45)
										{
											Qscore += 2;
										}

										if(Qbmi > 30)
										{
											Qscore += 3;
										}
										else if(Qbmi >= 25)
										{
											Qscore += 1;
										}
		
										if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
										{
											Qscore += 4;
										}
										else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
										{
											Qscore += 3;
										}
										if(Qnomotion)
										{
											Qscore += 2;
										}
										if(Qnoveggies)
										{
											Qscore += 1;
										}
										if(Qbp)
										{
											Qscore += 2;
										}
										if(Qbs)
										{
											Qscore += 5;
										}

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
											"<BR>");
										if(Qscore > 20)
										{
											feedbackAlert = true;
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Du rekommenderas att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
										}
										else if(Qscore >= 15)
										{
											feedbackAlert = true;
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Du rekommenderas att ta kontakt med din närmaste chef eller personalchef för en eventuell vidare kontakt med företagshälsovården för en noggrannare bedömning av risken.");
										}
										else if(Qscore >= 12)
										{
											feedbackAlert = true;
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else if(Qscore >= 7)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										FB.Append("<BR><BR>" +
											"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
											"<BR><BR>" +
											"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
									}
									#endregion

									#endregion
								}
								else
								{
									#region webbqps
									FB.Append("<B STYLE=\"font-size:20px;\">Feedback</B>");

									#region Rygg/nacke
									bool Qback = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
										);
									bool Qneck = 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
										|| 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
										|| 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
										);
									bool QbnSleep = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
									bool QbnWork = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
									bool QbnWorse = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

									if(Qback || Qneck)
									{
										feedbackAlert = true;
									}
									if(Qback || Qneck)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qback)
										{
											FB.Append("Back");
											if(Qneck)
											{
												FB.Append(" and ");
											}
										}
										if(Qneck)
										{
											FB.Append("Neck");
										}
										FB.Append("</B><BR>You have stated that you have pain in ");
										if(Qback)
										{
											FB.Append("the back");
											if(Qneck)
											{
												FB.Append(" and ");
											}
										}
										if(Qneck)
										{
											FB.Append("neck");
										}
										FB.Append(" and that these pains ");
										if(QbnWorse)
										{
											FB.Append("are worsened by working");
											if(QbnSleep || QbnWork)
											{
												FB.Append(" and that the pains ");
											}
										}
										if(QbnSleep || QbnWork)
										{
											FB.Append("have been so severe that it has been difficult for you ");
											if(QbnSleep)
											{
												FB.Append("to sleep");
												if(QbnWork)
												{
													FB.Append(" and ");
												}
											}
											if(QbnWork)
											{
												FB.Append("perform your work");
											}
										}
										FB.Append(". You are recommended to contact your occupational health care provider.");
									}
									#endregion

									#region Smoke/Hosta/Pip
									bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
									bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
									bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

									if(Qhosta || Qpip || Qsmoke)
									{
										feedbackAlert = true;
									}
									if(Qsmoke)
									{
										if(Qhosta || Qpip)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
											if(Qhosta)
											{
												FB.Append("Long-term cough");
												if(Qpip)
												{
													FB.Append(" and ");
												}
											}
											if(Qpip)
											{
												FB.Append("Squeaking sound in the chest");
											}
											FB.Append("</B><BR>Your responses indicate that you have symptoms that could be do to your smoking. If have not already sought help from a physician, it is recommended that you contact your occupational health care provider.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Smoking</B><BR>As you probably know, smoking is hazardous to health. If you want help to quit smoking it is recommended that you contact your occupational health care provider.");
										}
									}
									else if(Qpip || Qhosta)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Long-term cough");
											if(Qpip)
											{
												FB.Append(" and ");
											}
										}
										if(Qpip)
										{
											FB.Append("Squeaking sound in the chest");
										}
										FB.Append("</B><BR>Symptoms such as long-term cough and squeaking sound in the chest can be symptoms of asthma. If you are not treated for this already, it is recommended that you contact your occupational health care provider.<BR>");
									}
									#endregion

									#region Alkohol
									bool Qalco = 
										(
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
										||
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
										) 
										&& 
										(
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
										||
										oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
										);

									if(Qalco)
									{
										feedbackAlert = true;
									}

									if(Qalco)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alcohol</B>" +
											"<BR>" +
											"In our culture, alcohol is often included in social situations and it can have several positive effects. Your responses indicate that alcohol causes problems in your life. If you do something about the situation now, you can get good help. If you wait too long before addressing this, your problems can be prolonged and exacerbated." +
											"<BR><BR>" +
											"You can read more about drinking habits in the following links: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
											"<BR><BR>" +
											"Below you will find information on where to turn for advice and support." +
											"<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Support from the Alcohol-line</B>" +
											"<BR><BR>" +
											"Alcohol-line offers support via the phone." +
											"<BR><BR>" +
											"Are you thinking about your drinking habits? Call us and to talk with our advisors. If you need assistance in changing your habits, we can give you support. It's free." +
											"<BR><BR>" +
											"Those who turn to the alcohol line can choose between two options:" +
											"<BR>" +
											"- To either call for advice when you think you need it, or" +
											"<BR>" +
											"- To be called on a number of occasions for counseling and follow-up." +
											"<BR><BR>" +
											"Telefon 020-84 44 48" +
											"<BR>" +
											"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
											"<BR><BR>" +
											"Who answers at the Alcohol line?" +
											"<BR>" +
											"Among the advisers there are general practitioners, nurses, psychologists, health educators and public health experts." +
											"<BR><BR>" +
											"The opening hours of the Alcohol line will initially be Monday thru Thursday between 16:00-19:00." +
											"</DIV>");
									}
									#endregion

									#region Utbrändhet
									bool Qburnout = false;
									float score = 0f;
									string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 1; break;
												case 362: score += 2; break;
												case 363: score += 3; break;
												case 360: score += 4; break;
											}
										}
									}
									qos = ("Q382O114,Q383O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 4; break;
												case 362: score += 3; break;
												case 363: score += 2; break;
												case 360: score += 1; break;
											}
										}
									}
									if(score/5 > 2.6)
									{
										Qburnout = true;
									}

									bool Qpbs = false;
									score = 0f;
									qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 367: score += 5; break;
												case 363: score += 4; break;
												case 368: score += 3; break;
												case 369: score += 2; break;
												case 361: score += 1; break;
											}
										}
									}
									if(score/qos.Length > 3.25)
									{
										Qpbs = true;
									}

									bool Qdepr = 
										oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
										&& 
										(
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
										||
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
										);

									if(Qburnout || Qdepr)
									{
										feedbackAlert = true;
									}
									if(Qburnout)
									{
										if(Qdepr)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Chronic fatigue depression</B>" +
												"<BR>" +
												"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact your occupational health care provider.");
										}
										else if(Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
												"<BR>" +
												"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
												"The risk of prolonged symptoms increases significantly if you put such high demands on yourself that you do not take the time to rest and recover. " +
												"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact your occupational health care provider.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
												"<BR>" +
												"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
												"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact your occupational health care provider.");
										}
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
											"<BR>" +
											"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact your occupational health care provider.");
									}
									#endregion

									#region Sleep
									if(oldValues.Contains("Q374O86"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sleep</B>" +
											"<BR>" +
											"Sleep is our most important resource for recovery and it is essential to preserve health, welfare and performance for instance. During sleep several important hormones that repair, heal and restore the body are secreted. If sleep is disturbed for a longer period, there is a higher risk of eventually suffering from various stress-related diseases." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										{
											case 310: FB.Append("You have indicated that your sleep is Good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
											case 311: FB.Append("You have indicated that your sleep is Quite good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
											case 312: FB.Append("You have indicated that your sleep is Neither good nor bad. If you feel that you have repeated difficulty in falling asleep, or sleeping well or you are not well rested when you wake up, it is necessary to improve your sleep, for ultimately preserving the health and wellbeing. In this case it is important to remember to unwind at least two hours before bedtime. Sleep quality can also be improved by regularly doing breathing and relaxation exercises before bedtime."); break;
											case 313: feedbackAlert = true; FB.Append("You have indicated that your sleep is Quite poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational health care provider."); break;
											case 314: feedbackAlert = true; FB.Append("You have indicated that your sleep is Poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational health care provider."); break;
										}
									}
									#endregion

									#region Health
									if(oldValues.Contains("Q331O98"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Health</B>" +
											"<BR>" +
											"It is now well established that self-rated health is an important indicator of how you will feel in the future. If you consider your health to be very good or good you are far more likely to maintain/improve your health in the future compared with those who estimate their health as poor." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										{
											case 310: FB.Append("You have rated your health to be Good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
											case 311: FB.Append("You have rated your health to be Quite good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
											case 315: FB.Append("You have rated your health to be Neither good nor bad, which means that there may be a risk that your health deteriorates further in the future. Since self-rated health is a summary measure of both physical and mental wellbeing, we recommend that you review your lifestyle, for example in terms of physical exercise, sleep, and eating habits."); break;
											case 316: feedbackAlert = true; FB.Append("You have indicated your health to be Quite poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your occupational health care provider for a discussion of your health and what might be done to improve it."); break;
											case 317: feedbackAlert = true; FB.Append("You have indicated your health to be Poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your occupational health care provider for a discussion of your health and what might be done to improve it."); break;
										}
									}
									#endregion

									double Qbmi = 0;
									if(
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										)
									{
										Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
											"<BR>" +
											"Body-mass index (BMI) is the most commonly used measure to define obesity. <B>Your BMI is " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Classification</B></td><TD><B>(alternative term</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Health risk</B></TD></TR><TR><TD>Underweight; short weight</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>The risks vary depending on the cause of the underweight</TD></TR><TR><TD>Normal weight</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normal risk</TD></TR><TR><TD>Over weight</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Slightly increased</TD></TR><TR><TD><I>Obesity</I></td><TD><I>Severe obesity</I></td><TD><I>&ge; 30</I></td><TD><I>Moderately to highly increased</I></TD></TR><TR><TD>Obesity class I</td><TD>Obesity</td><TD>30,0 - 34,9</td><TD>Moderately increased, increased risk</TD></TR><TR><TD>Obesity class II</td><TD>Severe obesity</td><TD>35,0 - 39,9</td><TD>High, strongly increased risk</TD></TR><TR><TD>Obesity class III</td><TD>Extreme obesity</td><TD>&ge; 40</td><TD>Very high, extreme risk increase</TD></TR></TABLE>");

										if(Qbmi > 25)
										{
											feedbackAlert = true;
										}
									}

									int Qscore = 0;

									#region Findrisk
									if(
										(
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
										||
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
										)
										&&
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										&&
										oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
										&&
										oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
										&&
										oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
										&&
										oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
										&&
										oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
										)
									{
										int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
										bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
										//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
										double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
										bool Qnomotion = false;
										if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
										{
											Qnomotion = true;
										}
										if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
										{
											Qnomotion = true;
										}
										bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
										bool Qbp = 
											oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
											&& 
											oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
										bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
											Qscore += 3;
										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
											Qscore += 5;

										if(Qage >= 65)
										{
											Qscore += 4;
										}
										else if(Qage >= 55)
										{
											Qscore += 3;
										}
										else if(Qage >= 45)
										{
											Qscore += 2;
										}

										if(Qbmi > 30)
										{
											Qscore += 3;
										}
										else if(Qbmi >= 25)
										{
											Qscore += 1;
										}
		
										if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
										{
											Qscore += 4;
										}
										else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
										{
											Qscore += 3;
										}
										if(Qnomotion)
										{
											Qscore += 2;
										}
										if(Qnoveggies)
										{
											Qscore += 1;
										}
										if(Qbp)
										{
											Qscore += 2;
										}
										if(Qbs)
										{
											Qscore += 5;
										}

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
											"<BR>");
										if(Qscore > 20)
										{
											feedbackAlert = true;
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at serious risk of developing type 2 diabetes. An estimated 50 % fall ill. Regular, moderate exercise and a good diet reduce the risk of developing diabetes. It is therefore recommended that you contact your occupational health care provider to get a more accurate assessment of your blood sugar levels (both fasting and glucose load or blood sugar after a meal). These tests will show if you possibly have symptom free diabetes.");
										}
										else if(Qscore >= 15)
										{
											feedbackAlert = true;
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at high risk of developing type 2 diabetes. An estimated 33 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes. It is therefore suggested that you contact your occupational health care provider to get a more accurate risk assessment.");
										}
										else if(Qscore >= 12)
										{
											feedbackAlert = true;
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a moderate risk of developing type 2 diabetes. An estimated 17 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
										}
										else if(Qscore >= 7)
										{
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a slightly increased risk of developing type 2 diabetes. An estimated 4 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
										}
										else
										{
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a low risk of developing type 2 diabetes. An estimated 1 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
										}
										FB.Append("<BR><BR>" +
											"Type 2 diabetes (adult-onset diabetes, maturity onset diabetes) is a serious hereditary disease. But you can greatly influence the risk of getting diabetes through lifestyle. Obesity, especially abdominal obesity, physical inactivity, poor diet and smoking increases the risk of developing type 2 diabetes." +
											"<BR><BR>" +
											"Both older age and genetic factors may increase the risk for type 2 diabetes, and these factors can not be influenced. On the other hand, other risk factors such as obesity, abdominal obesity, physical inactivity, diet and smoking can be influenced. A healthy lifestyle can entirely prevent, or at least postpone type 2 diabetes as far in the future as possible. If you have diabetes in your family you should be particularly careful with your body weight over the years. Fat around the waist, so-called abdominal obesity, represents an additional risk. It may take time before you feel the symptoms of type 2 diabetes.");
									}
									#endregion

									#endregion
								}
							}
							else
							{
								#region webbqps all
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = true;
								bool Qneck = true;
								bool QbnSleep = true;
								bool QbnWork = true;
								bool QbnWorse = true;
								if(Qback || Qneck)
								{
									for(int i1=0; i1<2; i1++)
									{
										Qback = !Qback;
										for(int i2=0; i2<2; i2++)
										{
											Qneck = !Qneck;
											for(int i3=0; i3<2; i3++)
											{
												QbnSleep = !QbnSleep;
												for(int i4=0; i4<2; i4++)
												{
													QbnWork = !QbnWork;
													for(int i5=0; i5<2; i5++)
													{
														QbnWorse = !QbnWorse;

														if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
														{
															FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
															if(Qback)
															{
																FB.Append("Rygg");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("Nacke");
															}
															FB.Append("</B><BR>Du har angivit att du har besvär från ");
															if(Qback)
															{
																FB.Append("ryggen");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("nacken");
															}
															FB.Append(" samt att dessa besvär ");
															if(QbnWorse)
															{
																FB.Append("förvärras av arbetet");
																if(QbnSleep || QbnWork)
																{
																	FB.Append(" och att besvären ");
																}
															}
															if(QbnSleep || QbnWork)
															{
																FB.Append("varit så pass svåra att du haft svårt ");
																if(QbnSleep)
																{
																	FB.Append("att sova");
																	if(QbnWork)
																	{
																		FB.Append(" och ");
																	}
																}
																if(QbnWork)
																{
																	FB.Append("utföra ditt arbete");
																}
															}
															FB.Append(". Du rekommenderas att kontakta företagshälsovården.");
														}
													}
												}
											}
										}
									}
								}
								#endregion
								
								FB.Append("<BR>");
								
								#region Smoke/Hosta/Pip
								bool Qhosta = true;
								bool Qpip = true;
								bool Qsmoke = true;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du kontaktar företagshälsovården.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta företagshälsovården.");
									//}
								}
								//else if(Qpip || Qhosta)
								if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du kontaktar företagshälsovården.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = true;
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården." +
										"<BR><BR>" +
										"Du kan även läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns ytterliggare information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = true;
								bool Qpbs = true;
								bool Qdepr = true;

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
									}
									//else if(Qpbs)
									if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
									//}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								#endregion

								FB.Append("<BR>");

								#region Sleep
								//if(oldValues.Contains("Q374O86"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								for(int i=310; i<=314; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården."); break;
									}
									if(i != 314)
									{
										FB.Append("<BR>");
									}
									FB.Append("<BR>");
								}
								//}
								#endregion

								#region Health
								//if(oldValues.Contains("Q331O98"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								for(int i=310; i<=317; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
									if(i != 312 && i != 313 && i != 314 && i != 317)
									{
										FB.Append("<BR><BR>");
									}
								}
								//}
								#endregion

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är XX</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								#region Findrisk
								int Qscore = 0;
								for(int i=0; i<5; i++)
								{
									switch(i)
									{
										case 0: Qscore = 0; break;
										case 1: Qscore = 7; break;
										case 2: Qscore = 12; break;
										case 3: Qscore = 15; break;
										case 4: Qscore = 21; break;
									}
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B> <B STYLE=\"color:#CC0000;\">Ej diabetes diagnos, Findrisk score = " + Qscore + "</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
								}
								FB.Append("<BR><BR><B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos)</B><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								#endregion

								#endregion
							}
							SurveyIntro.Text += FB.ToString();
						}
						else if(surveyID == 60 || surveyID == 78 || surveyID == 131 || surveyID == 214 || surveyID == 219 || surveyID == 228 || surveyID == 279 || surveyID == 271)
						{
							// Manpower

							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								if(langID == 1)
								{
									#region webbqps
									FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

									#region Rygg/nacke
									bool Qback = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
										);
									bool Qneck = 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
										|| 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
										|| 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
										);
									bool QbnSleep = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
									bool QbnWork = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
									bool QbnWorse = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

									if(Qback || Qneck)
									{
										feedbackAlert = true;
									}
									if(Qback || Qneck)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qback)
										{
											FB.Append("Rygg");
											if(Qneck)
											{
												FB.Append(" och ");
											}
										}
										if(Qneck)
										{
											FB.Append("Nacke");
										}
										FB.Append("</B><BR>Du har angivit att du har besvär från ");
										if(Qback)
										{
											FB.Append("ryggen");
											if(Qneck)
											{
												FB.Append(" och ");
											}
										}
										if(Qneck)
										{
											FB.Append("nacken");
										}
										FB.Append(" samt att dessa besvär ");
										if(QbnWorse)
										{
											FB.Append("förvärras av arbetet");
											if(QbnSleep || QbnWork)
											{
												FB.Append(" och att besvären ");
											}
										}
										if(QbnSleep || QbnWork)
										{
											FB.Append("varit så pass svåra att du haft svårt ");
											if(QbnSleep)
											{
												FB.Append("att sova");
												if(QbnWork)
												{
													FB.Append(" och ");
												}
											}
											if(QbnWork)
											{
												FB.Append("utföra ditt arbete");
											}
										}
										FB.Append(". Du rekommenderas att kontakta företagshälsovården.");
									}
									#endregion

									#region Smoke/Hosta/Pip
									bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
									bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
									bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

									if(Qhosta || Qpip || Qsmoke)
									{
										feedbackAlert = true;
									}
									if(Qsmoke)
									{
										if(Qhosta || Qpip)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
											if(Qhosta)
											{
												FB.Append("Långvarig hosta");
												if(Qpip)
												{
													FB.Append(" och ");
												}
											}
											if(Qpip)
											{
												FB.Append("Pip i bröstet");
											}
											FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du kontaktar företagshälsovården.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta företagshälsovården.");
										}
									}
									else if(Qpip || Qhosta)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du kontaktar företagshälsovården.<BR>");
									}
									#endregion

									#region Alkohol
									bool Qalco = 
										(
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
										||
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
										) 
										&& 
										(
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
										||
										oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
										);

									if(Qalco)
									{
										feedbackAlert = true;
									}

									if(Qalco)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
											"<BR>" +
											"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården." +
											"<BR><BR>" +
											"Du kan även läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
											"<BR><BR>" +
											"Nedan finns ytterliggare information om vart du kan vända dig för råd och stöd." +
											"<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
											"<BR><BR>" +
											"Alkohollinjen erbjuder stöd per telefon." +
											"<BR><BR>" +
											"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
											"<BR><BR>" +
											"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
											"<BR>" +
											"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
											"<BR>" +
											"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
											"<BR><BR>" +
											"Telefon 020-84 44 48" +
											"<BR>" +
											"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
											"<BR><BR>" +
											"Vilka svarar på Alkohollinjen?" +
											"<BR>" +
											"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
											"<BR><BR>" +
											"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
											"</DIV>");
									}
									#endregion

									#region Utbrändhet
									bool Qburnout = false;
									float score = 0f;
									string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 1; break;
												case 362: score += 2; break;
												case 363: score += 3; break;
												case 360: score += 4; break;
											}
										}
									}
									qos = ("Q382O114,Q383O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 4; break;
												case 362: score += 3; break;
												case 363: score += 2; break;
												case 360: score += 1; break;
											}
										}
									}
									if(score/5 > 2.6)
									{
										Qburnout = true;
									}

									bool Qpbs = false;
									score = 0f;
									qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 367: score += 5; break;
												case 363: score += 4; break;
												case 368: score += 3; break;
												case 369: score += 2; break;
												case 361: score += 1; break;
											}
										}
									}
									if(score/qos.Length > 3.25)
									{
										Qpbs = true;
									}

									bool Qdepr = 
										oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
										&& 
										(
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
										||
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
										);

									if(Qburnout || Qdepr)
									{
										feedbackAlert = true;
									}
									if(Qburnout)
									{
										if(Qdepr)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
												"<BR>" +
												"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
										}
										else if(Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
												"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
												"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
												"<BR>" +
												"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
												"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
										}
									}
									else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
									}
									#endregion

									#region Sleep
									if(oldValues.Contains("Q374O86"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
											"<BR>" +
											"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										{
											case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
											case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
											case 313: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården."); break;
											case 314: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården."); break;
										}
									}
									#endregion

									#region Health
									if(oldValues.Contains("Q331O98"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
											"<BR>" +
											"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										{
											case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
											case 316: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
											case 317: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										}
									}
									#endregion

									double Qbmi = 0;
									if(
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										)
									{
										Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
											"<BR>" +
											"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

										if(Qbmi > 25)
										{
											feedbackAlert = true;
										}
									}

									int Qscore = 0;

									#region Findrisk
									if(
										(
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
										||
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
										)
										&&
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										&&
										oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
										&&
										oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
										&&
										oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
										&&
										oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
										&&
										oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
										)
									{
										int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
										bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
										//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
										double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
										bool Qnomotion = false;
										if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
										{
											Qnomotion = true;
										}
										if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
										{
											Qnomotion = true;
										}
										bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
										bool Qbp = 
											oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
											&& 
											oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
										bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
											Qscore += 3;
										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
											Qscore += 5;

										if(Qage >= 65)
										{
											Qscore += 4;
										}
										else if(Qage >= 55)
										{
											Qscore += 3;
										}
										else if(Qage >= 45)
										{
											Qscore += 2;
										}

										if(Qbmi > 30)
										{
											Qscore += 3;
										}
										else if(Qbmi >= 25)
										{
											Qscore += 1;
										}
		
										if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
										{
											Qscore += 4;
										}
										else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
										{
											Qscore += 3;
										}
										if(Qnomotion)
										{
											Qscore += 2;
										}
										if(Qnoveggies)
										{
											Qscore += 1;
										}
										if(Qbp)
										{
											Qscore += 2;
										}
										if(Qbs)
										{
											Qscore += 5;
										}

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
											"<BR>");
										if(Qscore > 20)
										{
											feedbackAlert = true;
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
										}
										else if(Qscore >= 15)
										{
											feedbackAlert = true;
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av risken.");
										}
										else if(Qscore >= 12)
										{
											feedbackAlert = true;
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else if(Qscore >= 7)
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										else
										{
											FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
										}
										FB.Append("<BR><BR>" +
											"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
											"<BR><BR>" +
											"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
									}
									#endregion

									#endregion
								}
								else
								{
									#region webbqps
									FB.Append("<B STYLE=\"font-size:20px;\">Feedback</B>");

									#region Rygg/nacke
									bool Qback = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
										);
									bool Qneck = 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										(
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
										|| 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
										|| 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
										);
									bool QbnSleep = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
									bool QbnWork = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
									bool QbnWorse = 
										oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
										&& 
										oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
										|| 
										oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
										&& 
										oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

									if(Qback || Qneck)
									{
										feedbackAlert = true;
									}
									if(Qback || Qneck)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qback)
										{
											FB.Append("Back");
											if(Qneck)
											{
												FB.Append(" and ");
											}
										}
										if(Qneck)
										{
											FB.Append("Neck");
										}
										FB.Append("</B><BR>You have stated that you have pain in ");
										if(Qback)
										{
											FB.Append("the back");
											if(Qneck)
											{
												FB.Append(" and ");
											}
										}
										if(Qneck)
										{
											FB.Append("neck");
										}
										FB.Append(" and that these pains ");
										if(QbnWorse)
										{
											FB.Append("are worsened by working");
											if(QbnSleep || QbnWork)
											{
												FB.Append(" and that the pains ");
											}
										}
										if(QbnSleep || QbnWork)
										{
											FB.Append("have been so severe that it has been difficult for you ");
											if(QbnSleep)
											{
												FB.Append("to sleep");
												if(QbnWork)
												{
													FB.Append(" and ");
												}
											}
											if(QbnWork)
											{
												FB.Append("perform your work");
											}
										}
										FB.Append(". Your are recommended to contact your occupational health care provider.");
									}
									#endregion

									#region Smoke/Hosta/Pip
									bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
									bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
									bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

									if(Qhosta || Qpip || Qsmoke)
									{
										feedbackAlert = true;
									}
									if(Qsmoke)
									{
										if(Qhosta || Qpip)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
											if(Qhosta)
											{
												FB.Append("Long-term cough");
												if(Qpip)
												{
													FB.Append(" and ");
												}
											}
											if(Qpip)
											{
												FB.Append("Squeaking sound in the chest");
											}
											FB.Append("</B><BR>Your responses indicate that you have symptoms that could be do to your smoking. If have not already sought help from a physician, it is recommended that you contact your occupational health care provider.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Smoking</B><BR>As you probably know, smoking is hazardous to health. If you want help to quit smoking it is recommended that you contact your occupational health care provider.");
										}
									}
									else if(Qpip || Qhosta)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Long-term cough");
											if(Qpip)
											{
												FB.Append(" and ");
											}
										}
										if(Qpip)
										{
											FB.Append("Squeaking sound in the chest");
										}
										FB.Append("</B><BR>Symptoms such as long-term cough and squeaking sound in the chest can be symptoms of asthma. If you are not treated for this already, it is recommended that you contact your occupational health care provider.<BR>");
									}
									#endregion

									#region Alkohol
									bool Qalco = 
										(
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
										||
										oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
										) 
										&& 
										(
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
										||
										oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
										||
										oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
										||
										oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
										);

									if(Qalco)
									{
										feedbackAlert = true;
									}

									if(Qalco)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alcohol</B>" +
											"<BR>" +
											"In our culture, alcohol is often included in social situations and it can have several positive effects. Your responses indicate that alcohol causes problems in your life. If you do something about the situation now, you can get good help. If you wait too long before addressing this, your problems can be prolonged and exacerbated." +
											"<BR><BR>" +
											"You can read more about drinking habits in the following links: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
											"<BR><BR>" +
											"Below you will find information on where to turn for advice and support." +
											"<BR><BR>" +
											"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Support from the Alcohol-line</B>" +
											"<BR><BR>" +
											"Alcohol-line offers support via the phone." +
											"<BR><BR>" +
											"Are you thinking about your drinking habits? Call us and to talk with our advisors. If you need assistance in changing your habits, we can give you support. It's free." +
											"<BR><BR>" +
											"Those who turn to the alcohol line can choose between two options:" +
											"<BR>" +
											"- To either call for advice when you think you need it, or" +
											"<BR>" +
											"- To be called on a number of occasions for counseling and follow-up." +
											"<BR><BR>" +
											"Telefon 020-84 44 48" +
											"<BR>" +
											"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
											"<BR><BR>" +
											"Who answers at the Alcohol line?" +
											"<BR>" +
											"Among the advisers there are general practitioners, nurses, psychologists, health educators and public health experts." +
											"<BR><BR>" +
											"The opening hours of the Alcohol line will initially be Monday thru Thursday between 16:00-19:00." +
											"</DIV>");
									}
									#endregion

									#region Utbrändhet
									bool Qburnout = false;
									float score = 0f;
									string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 1; break;
												case 362: score += 2; break;
												case 363: score += 3; break;
												case 360: score += 4; break;
											}
										}
									}
									qos = ("Q382O114,Q383O114").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 361: score += 4; break;
												case 362: score += 3; break;
												case 363: score += 2; break;
												case 360: score += 1; break;
											}
										}
									}
									if(score/5 > 2.6)
									{
										Qburnout = true;
									}

									bool Qpbs = false;
									score = 0f;
									qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
									foreach(string s in qos)
									{
										if(oldValues.Contains(s))
										{
											switch(Convert.ToInt32("0" + (string)oldValues[s]))
											{
												case 367: score += 5; break;
												case 363: score += 4; break;
												case 368: score += 3; break;
												case 369: score += 2; break;
												case 361: score += 1; break;
											}
										}
									}
									if(score/qos.Length > 3.25)
									{
										Qpbs = true;
									}

									bool Qdepr = 
										oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
										&& 
										(
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
										||
										oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
										||
										oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
										||
										oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
										||
										oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
										||
										oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
										||
										oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
										);

									if(Qburnout || Qdepr)
									{
										feedbackAlert = true;
									}
									if(Qburnout)
									{
										if(Qdepr)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Chronic fatigue depression</B>" +
												"<BR>" +
												"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact your occupational health care provider.");
										}
										else if(Qpbs)
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
												"<BR>" +
												"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
												"The risk of prolonged symptoms increases significantly if you put such high demands on yourself that you do not take the time to rest and recover. " +
												"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact your occupational health care provider.");
										}
										else
										{
											FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
												"<BR>" +
												"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
												"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact your occupational health care provider.");
										}
									}
									else if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
											"<BR>" +
											"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact your occupational health care provider.");
									}
									#endregion

									#region Sleep
									if(oldValues.Contains("Q374O86"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sleep</B>" +
											"<BR>" +
											"Sleep is our most important resource for recovery and it is essential to preserve health, welfare and performance for instance. During sleep several important hormones that repair, heal and restore the body are secreted. If sleep is disturbed for a longer period, there is a higher risk of eventually suffering from various stress-related diseases." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										{
											case 310: FB.Append("You have indicated that your sleep is Good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
											case 311: FB.Append("You have indicated that your sleep is Quite good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
											case 312: FB.Append("You have indicated that your sleep is Neither good nor bad. If you feel that you have repeated difficulty in falling asleep, or sleeping well or you are not well rested when you wake up, it is necessary to improve your sleep, for ultimately preserving the health and wellbeing. In this case it is important to remember to unwind at least two hours before bedtime. Sleep quality can also be improved by regularly doing breathing and relaxation exercises before bedtime."); break;
											case 313: feedbackAlert = true; FB.Append("You have indicated that your sleep is Quite poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational health care provider."); break;
											case 314: feedbackAlert = true; FB.Append("You have indicated that your sleep is Poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational health care provider."); break;
										}
									}
									#endregion

									#region Health
									if(oldValues.Contains("Q331O98"))
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Health</B>" +
											"<BR>" +
											"It is now well established that self-rated health is an important indicator of how you will feel in the future. If you consider your health to be very good or good you are far more likely to maintain/improve your health in the future compared with those who estimate their health as poor." +
											"<BR><BR>");

										switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										{
											case 310: FB.Append("You have rated your health to be Good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
											case 311: FB.Append("You have rated your health to be Quite good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
											case 315: FB.Append("You have rated your health to be Neither good nor bad, which means that there may be a risk that your health deteriorates further in the future. Since self-rated health is a summary measure of both physical and mental wellbeing, we recommend that you review your lifestyle, for example in terms of physical exercise, sleep, and eating habits."); break;
											case 316: feedbackAlert = true; FB.Append("You have indicated your health to be Quite poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your occupational health care provider for a discussion of your health and what might be done to improve it."); break;
											case 317: feedbackAlert = true; FB.Append("You have indicated your health to be Poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your occupational health care provider for a discussion of your health and what might be done to improve it."); break;
										}
									}
									#endregion

									double Qbmi = 0;
									if(
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										)
									{
										Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
											"<BR>" +
											"Body-mass index (BMI) is the most commonly used measure to define obesity. <B>Your BMI is " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Classification</B></td><TD><B>(alternative term</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Health risk</B></TD></TR><TR><TD>Underweight; short weight</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>The risks vary depending on the cause of the underweight</TD></TR><TR><TD>Normal weight</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normal risk</TD></TR><TR><TD>Over weight</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Slightly increased</TD></TR><TR><TD><I>Obesity</I></td><TD><I>Severe obesity</I></td><TD><I>&ge; 30</I></td><TD><I>Moderately to highly increased</I></TD></TR><TR><TD>Obesity class I</td><TD>Obesity</td><TD>30,0 - 34,9</td><TD>Moderately increased, increased risk</TD></TR><TR><TD>Obesity class II</td><TD>Severe obesity</td><TD>35,0 - 39,9</td><TD>High, strongly increased risk</TD></TR><TR><TD>Obesity class III</td><TD>Extreme obesity</td><TD>&ge; 40</td><TD>Very high, extreme risk increase</TD></TR></TABLE>");

										if(Qbmi > 25)
										{
											feedbackAlert = true;
										}
									}

									int Qscore = 0;

									#region Findrisk
									if(
										(
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
										||
										oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
										)
										&&
										oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
										&&
										oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
										&&
										oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
										&&
										oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
										&&
										oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
										&&
										oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
										&&
										oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
										)
									{
										int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
										bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
										//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
										double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
										bool Qnomotion = false;
										if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
										{
											Qnomotion = true;
										}
										if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
										{
											Qnomotion = true;
										}
										bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
										bool Qbp = 
											oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
											&& 
											oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
										bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
											Qscore += 3;
										if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
											Qscore += 5;

										if(Qage >= 65)
										{
											Qscore += 4;
										}
										else if(Qage >= 55)
										{
											Qscore += 3;
										}
										else if(Qage >= 45)
										{
											Qscore += 2;
										}

										if(Qbmi > 30)
										{
											Qscore += 3;
										}
										else if(Qbmi >= 25)
										{
											Qscore += 1;
										}
		
										if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
										{
											Qscore += 4;
										}
										else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
										{
											Qscore += 3;
										}
										if(Qnomotion)
										{
											Qscore += 2;
										}
										if(Qnoveggies)
										{
											Qscore += 1;
										}
										if(Qbp)
										{
											Qscore += 2;
										}
										if(Qbs)
										{
											Qscore += 5;
										}

										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
											"<BR>");
										if(Qscore > 20)
										{
											feedbackAlert = true;
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at serious risk of developing type 2 diabetes. An estimated 50 % fall ill. Regular, moderate exercise and a good diet reduce the risk of developing diabetes. It is therefore recommended that you contact your occupational health care provider to get a more accurate assessment of your blood sugar levels (both fasting and glucose load or blood sugar after a meal). These tests will show if you possibly have symptom free diabetes.");
										}
										else if(Qscore >= 15)
										{
											feedbackAlert = true;
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at high risk of developing type 2 diabetes. An estimated 33 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes. It is therefore suggested that you contact your occupational health care provider to get a more accurate risk assessment.");
										}
										else if(Qscore >= 12)
										{
											feedbackAlert = true;
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a moderate risk of developing type 2 diabetes. An estimated 17 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
										}
										else if(Qscore >= 7)
										{
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a slightly increased risk of developing type 2 diabetes. An estimated 4 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
										}
										else
										{
											FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a low risk of developing type 2 diabetes. An estimated 1 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
										}
										FB.Append("<BR><BR>" +
											"Type 2 diabetes (adult-onset diabetes, maturity onset diabetes) is a serious hereditary disease. But you can greatly influence the risk of getting diabetes through lifestyle. Obesity, especially abdominal obesity, physical inactivity, poor diet and smoking increases the risk of developing type 2 diabetes." +
											"<BR><BR>" +
											"Both older age and genetic factors may increase the risk for type 2 diabetes, and these factors can not be influenced. On the other hand, other risk factors such as obesity, abdominal obesity, physical inactivity, diet and smoking can be influenced. A healthy lifestyle can entirely prevent, or at least postpone type 2 diabetes as far in the future as possible. If you have diabetes in your family you should be particularly careful with your body weight over the years. Fat around the waist, so-called abdominal obesity, represents an additional risk. It may take time before you feel the symptoms of type 2 diabetes.");
									}
									#endregion

									#endregion
								}
							}
							else
							{
								#region webbqps all
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = true;
								bool Qneck = true;
								bool QbnSleep = true;
								bool QbnWork = true;
								bool QbnWorse = true;
								if(Qback || Qneck)
								{
									for(int i1=0; i1<2; i1++)
									{
										Qback = !Qback;
										for(int i2=0; i2<2; i2++)
										{
											Qneck = !Qneck;
											for(int i3=0; i3<2; i3++)
											{
												QbnSleep = !QbnSleep;
												for(int i4=0; i4<2; i4++)
												{
													QbnWork = !QbnWork;
													for(int i5=0; i5<2; i5++)
													{
														QbnWorse = !QbnWorse;

														if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
														{
															FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
															if(Qback)
															{
																FB.Append("Rygg");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("Nacke");
															}
															FB.Append("</B><BR>Du har angivit att du har besvär från ");
															if(Qback)
															{
																FB.Append("ryggen");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("nacken");
															}
															FB.Append(" samt att dessa besvär ");
															if(QbnWorse)
															{
																FB.Append("förvärras av arbetet");
																if(QbnSleep || QbnWork)
																{
																	FB.Append(" och att besvären ");
																}
															}
															if(QbnSleep || QbnWork)
															{
																FB.Append("varit så pass svåra att du haft svårt ");
																if(QbnSleep)
																{
																	FB.Append("att sova");
																	if(QbnWork)
																	{
																		FB.Append(" och ");
																	}
																}
																if(QbnWork)
																{
																	FB.Append("utföra ditt arbete");
																}
															}
															FB.Append(". Du rekommenderas att kontakta företagshälsovården.");
														}
													}
												}
											}
										}
									}
								}
								#endregion
								
								FB.Append("<BR>");
								
								#region Smoke/Hosta/Pip
								bool Qhosta = true;
								bool Qpip = true;
								bool Qsmoke = true;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du kontaktar företagshälsovården.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta företagshälsovården.");
									//}
								}
								//else if(Qpip || Qhosta)
								if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du kontaktar företagshälsovården.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = true;
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården." +
										"<BR><BR>" +
										"Du kan även läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns ytterliggare information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = true;
								bool Qpbs = true;
								bool Qdepr = true;

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
									}
									//else if(Qpbs)
									if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
									//}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med företagshälsovården.");
								}
								#endregion

								FB.Append("<BR>");

								#region Sleep
								//if(oldValues.Contains("Q374O86"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								for(int i=310; i<=314; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta företagshälsovården."); break;
									}
									if(i != 314)
									{
										FB.Append("<BR>");
									}
									FB.Append("<BR>");
								}
								//}
								#endregion

								#region Health
								//if(oldValues.Contains("Q331O98"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								for(int i=310; i<=317; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar företagshälsovården för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
									if(i != 312 && i != 313 && i != 314 && i != 317)
									{
										FB.Append("<BR><BR>");
									}
								}
								//}
								#endregion

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är XX</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								#region Findrisk
								int Qscore = 0;
								for(int i=0; i<5; i++)
								{
									switch(i)
									{
										case 0: Qscore = 0; break;
										case 1: Qscore = 7; break;
										case 2: Qscore = 12; break;
										case 3: Qscore = 15; break;
										case 4: Qscore = 21; break;
									}
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B> <B STYLE=\"color:#CC0000;\">Ej diabetes diagnos, Findrisk score = " + Qscore + "</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar företagshälsovården för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
								}
								FB.Append("<BR><BR><B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos)</B><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								#endregion

								#endregion
							}
							SurveyIntro.Text += FB.ToString();
						}
						else if(surveyID == 152)
						{
							// Manpower internt, rev 2011-10-19

							if(langID == 1)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

								if(Qback || Qneck)
								{
									feedbackAlert = true;
								}
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Du rekommenderas att kontakta din vård- eller hälsocentral alternativt sjukgymnast. Glöm inte att du har ett friskvårdsbidrag att använda till exempelvis massage.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qhosta || Qpip || Qsmoke)
								{
									feedbackAlert = true;
								}
								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du kontaktar din vård- eller hälsocentral.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, finns det många hälsofördelar med att sluta röka. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din vård- eller hälsocentral.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du kontaktar din vård- eller hälsocentral.<BR>");
								}
								#endregion

								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);

								if(Qalco)
								{
									feedbackAlert = true;
								}

								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen kan medföra risker i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med sjukvårdsförsäkringen genom Länsförsäkringar, telefon: 0771-666 115." +
										"<BR><BR>" +
										"Du kan även läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns ytterliggare information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med sjukvårdsförsäkringen genom Länsförsäkringar, telefon: 0771-666 115.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattning</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med sjukvårdsförsäkringen genom Länsförsäkringar, telefon: 0771-666 115.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattning</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med sjukvårdsförsäkringen genom Länsförsäkringar, telefon: 0771-666 115.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med sjukvårdsförsäkringen genom Länsförsäkringar, telefon: 0771-666 115.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet. Inspireras gärna av övningarna på www.healthwatch.se"); break;
										case 313: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din vård- eller hälsocentral."); break;
										case 314: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta sjukvårdsförsäkringen genom Länsförsäkringar, telefon: 0771-666 115."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din vård- eller hälsocentral för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar sjukvårdsförsäkringen genom Länsförsäkringar, telefon: 0771-666 115 för en diskussion om ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
	
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
	
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din vård- eller hälsocentral för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din vård- eller hälsocentral för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion
							}
							else
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Feedback</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

								if(Qback || Qneck)
								{
									feedbackAlert = true;
								}
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("Neck");
									}
									FB.Append("</B><BR>You have stated that you have pain in ");
									if(Qback)
									{
										FB.Append("the back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("neck");
									}
									FB.Append(" and that these pains ");
									if(QbnWorse)
									{
										FB.Append("are worsened by working");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" and that the pains ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("have been so severe that it has been difficult for you ");
										if(QbnSleep)
										{
											FB.Append("to sleep");
											if(QbnWork)
											{
												FB.Append(" and ");
											}
										}
										if(QbnWork)
										{
											FB.Append("perform your work");
										}
									}
									FB.Append(". Your are recommended to contact your local medical center.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qhosta || Qpip || Qsmoke)
								{
									feedbackAlert = true;
								}
								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Long-term cough");
											if(Qpip)
											{
												FB.Append(" and ");
											}
										}
										if(Qpip)
										{
											FB.Append("Squeaking sound in the chest");
										}
										FB.Append("</B><BR>Your responses indicate that you have symptoms that could be do to your smoking. If have not already sought help from a physician, it is recommended that you contact your local medical center.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Smoking</B><BR>As you probably know, there are many health benefits of quitting smoking. If you want help to quit smoking it is recommended that you contact your local medical center.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Long-term cough");
										if(Qpip)
										{
											FB.Append(" and ");
										}
									}
									if(Qpip)
									{
										FB.Append("Squeaking sound in the chest");
									}
									FB.Append("</B><BR>Symptoms such as long-term cough and squeaking sound in the chest can be symptoms of asthma. If you are not treated for this already, it is recommended that you contact your local medical center.<BR>");
								}
								#endregion

								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);

								if(Qalco)
								{
									feedbackAlert = true;
								}

								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alcohol</B>" +
										"<BR>" +
										"In our culture, alcohol is often included in social situations and it can have several positive effects. Your responses indicate that alcohol can induce risks in your life. If you do something about the situation now, you can get good help. If you wait too long before addressing this, your problems can be prolonged and exacerbated. We recommend you to contact the health insurance agency Länsförsäkringar on phone: 0771-666 115." +
										"<BR><BR>" +
										"You can read more about drinking habits in the following links: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Below you will find information on where to turn for advice and support." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Support from the Alcohol-line</B>" +
										"<BR><BR>" +
										"Alcohol-line offers support via the phone." +
										"<BR><BR>" +
										"Are you thinking about your drinking habits? Call us and to talk with our advisors. If you need assistance in changing your habits, we can give you support. It's free." +
										"<BR><BR>" +
										"Those who turn to the alcohol line can choose between two options:" +
										"<BR>" +
										"- To either call for advice when you think you need it, or" +
										"<BR>" +
										"- To be called on a number of occasions for counseling and follow-up." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Who answers at the Alcohol line?" +
										"<BR>" +
										"Among the advisers there are general practitioners, nurses, psychologists, health educators and public health experts." +
										"<BR><BR>" +
										"The opening hours of the Alcohol line will initially be Monday thru Thursday between 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Chronic fatigue depression</B>" +
											"<BR>" +
											"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you the contact health insurance agency Länsförsäkringar on phone: 0771-666 115.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Exhaustion</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"The risk of prolonged symptoms increases significantly if you put such high demands on yourself that you do not take the time to rest and recover. " +
											"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact the health insurance agency Länsförsäkringar on phone: 0771-666 115.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Exhaustion</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact the health insurance agency Länsförsäkringar on phone: 0771-666 115.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
										"<BR>" +
										"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact the health insurance agency Länsförsäkringar on phone: 0771-666 115.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sleep</B>" +
										"<BR>" +
										"Sleep is our most important resource for recovery and it is essential to preserve health, welfare and performance for instance. During sleep several important hormones that repair, heal and restore the body are secreted. If sleep is disturbed for a longer period, there is a higher risk of eventually suffering from various stress-related diseases." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("You have indicated that your sleep is Good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 311: FB.Append("You have indicated that your sleep is Quite good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 312: FB.Append("You have indicated that your sleep is Neither good nor bad. If you feel that you have repeated difficulty in falling asleep, or sleeping well or you are not well rested when you wake up, it is necessary to improve your sleep, for ultimately preserving the health and wellbeing. In this case it is important to remember to unwind at least two hours before bedtime. Sleep quality can also be improved by regularly doing breathing and relaxation exercises before bedtime. The exercises on www.healthwatch.se can be good inspiration."); break;
										case 313: feedbackAlert = true; FB.Append("You have indicated that your sleep is Quite poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your local medical center."); break;
										case 314: feedbackAlert = true; FB.Append("You have indicated that your sleep is Poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact the health insurance agency Länsförsäkringar on phone: 0771-666 115."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Health</B>" +
										"<BR>" +
										"It is now well established that self-rated health is an important indicator of how you will feel in the future. If you consider your health to be very good or good you are far more likely to maintain/improve your health in the future compared with those who estimate their health as poor." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("You have rated your health to be Good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 311: FB.Append("You have rated your health to be Quite good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 315: FB.Append("You have rated your health to be Neither good nor bad, which means that there may be a risk that your health deteriorates further in the future. Since self-rated health is a summary measure of both physical and mental wellbeing, we recommend that you review your lifestyle, for example in terms of physical exercise, sleep, and eating habits."); break;
										case 316: feedbackAlert = true; FB.Append("You have indicated your health to be Quite poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your local medical center for a discussion of your health and what might be done to improve it."); break;
										case 317: feedbackAlert = true; FB.Append("You have indicated your health to be Poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact the health insurance agency Länsförsäkringar on phone 0771-666 115 for a discussion of your health and what might be done to improve it."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) is the most commonly used measure to define obesity. <B>Your BMI is " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Classification</B></td><TD><B>(alternative term</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Health risk</B></TD></TR><TR><TD>Underweight; short weight</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>The risks vary depending on the cause of the underweight</TD></TR><TR><TD>Normal weight</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normal risk</TD></TR><TR><TD>Over weight</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Slightly increased</TD></TR><TR><TD><I>Obesity</I></td><TD><I>Severe obesity</I></td><TD><I>&ge; 30</I></td><TD><I>Moderately to highly increased</I></TD></TR><TR><TD>Obesity class I</td><TD>Obesity</td><TD>30,0 - 34,9</td><TD>Moderately increased, increased risk</TD></TR><TR><TD>Obesity class II</td><TD>Severe obesity</td><TD>35,0 - 39,9</td><TD>High, strongly increased risk</TD></TR><TR><TD>Obesity class III</td><TD>Extreme obesity</td><TD>&ge; 40</td><TD>Very high, extreme risk increase</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
	
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
	
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at serious risk of developing type 2 diabetes. An estimated 50 % fall ill. Regular, moderate exercise and a good diet reduce the risk of developing diabetes. It is therefore recommended that you contact your the health insurance agency Länsförsäkringar on phone 0771-666 115 to get a more accurate assessment of your blood sugar levels (both fasting and glucose load or blood sugar after a meal). These tests will show if you possibly have symptom free diabetes.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at high risk of developing type 2 diabetes. An estimated 33 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes. It is therefore suggested that you contact your local medical center to get a more accurate risk assessment.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a moderate risk of developing type 2 diabetes. An estimated 17 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a slightly increased risk of developing type 2 diabetes. An estimated 4 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a low risk of developing type 2 diabetes. An estimated 1 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Type 2 diabetes (adult-onset diabetes, maturity onset diabetes) is a serious hereditary disease. But you can greatly influence the risk of getting diabetes through lifestyle. Obesity, especially abdominal obesity, physical inactivity, poor diet and smoking increases the risk of developing type 2 diabetes." +
										"<BR><BR>" +
										"Both older age and genetic factors may increase the risk for type 2 diabetes, and these factors can not be influenced. On the other hand, other risk factors such as obesity, abdominal obesity, physical inactivity, diet and smoking can be influenced. A healthy lifestyle can entirely prevent, or at least postpone type 2 diabetes as far in the future as possible. If you have diabetes in your family you should be particularly careful with your body weight over the years. Fat around the waist, so-called abdominal obesity, represents an additional risk. It may take time before you feel the symptoms of type 2 diabetes.");
								}
								#endregion

								#endregion
							}
							SurveyIntro.Text += FB.ToString();
						}
						else if(surveyID == 108)
						{
							// Manpower E&Y

							if(langID == 1)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

								if(Qback || Qneck)
								{
									feedbackAlert = true;
								}
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning..");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qhosta || Qpip || Qsmoke)
								{
									feedbackAlert = true;
								}
								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du kontaktar företagshälsovården.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);

								if(Qalco)
								{
									feedbackAlert = true;
								}

								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Du rekommenderas ta kontakt med företagshälsovården Manpower Hälsopartner för vidare dialog med företagssköterska Katarina Godée. Du kontaktar Manpower Hälsopartner på tel 040-44 19 30 eller halsopartner.malmo@manpower.se." +
										"<BR><BR>" +
										"Nedan finns information om vart du också kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du själv känner ett behov av det rekommenderas du att ta kontakt med företagshälsovården Manpower Hälsopartner för vidare dialog/underökning/bedömning med företagssköterska Katarina Godée. Du kontaktar Manpower Hälsopartner på tel 040-44 19 30 eller halsopartner.malmo@manpower.se"); break;
										case 314: feedbackAlert = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du själv känner ett behov av det rekommenderas du att ta kontakt med företagshälsovården Manpower Hälsopartner för vidare dialog/underökning/bedömning med företagssköterska Katarina Godée. Du kontaktar Manpower Hälsopartner på tel 040-44 19 30 eller halsopartner.malmo@manpower.se"); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om du själv känner ett behov av det rekommenderas du att ta kontakt med företagshälsovården Manpower Hälsopartner för vidare dialog/underökning/bedömning med företagssköterska Katarina Godée. Du kontaktar Manpower Hälsopartner på tel 040-44 19 30 eller halsopartner.malmo@manpower.se"); break;
										case 317: feedbackAlert = true; FB.Append("Du har angivit att din hälsa är Dålig. Om du själv känner ett behov av det rekommenderas du att ta kontakt med företagshälsovården Manpower Hälsopartner för vidare dialog/underökning/bedömning med företagssköterska Katarina Godée. Du kontaktar Manpower Hälsopartner på tel 040-44 19 30 eller halsopartner.malmo@manpower.se"); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Om du själv känner ett behov av det rekommenderas du att ta kontakt med din sjukvårdsförsäkring via Trygghansa för vidare underökning/bedömning.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion
							}
							else
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Feedback</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;

								if(Qback || Qneck)
								{
									feedbackAlert = true;
								}
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("Neck");
									}
									FB.Append("</B><BR>You have stated that you have pain in ");
									if(Qback)
									{
										FB.Append("the back");
										if(Qneck)
										{
											FB.Append(" and ");
										}
									}
									if(Qneck)
									{
										FB.Append("neck");
									}
									FB.Append(" and that these pains ");
									if(QbnWorse)
									{
										FB.Append("are worsened by working");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" and that the pains ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("have been so severe that it has been difficult for you ");
										if(QbnSleep)
										{
											FB.Append("to sleep");
											if(QbnWork)
											{
												FB.Append(" and ");
											}
										}
										if(QbnWork)
										{
											FB.Append("perform your work");
										}
									}
									FB.Append(". Your are recommended to contact your occupational health care provider.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qhosta || Qpip || Qsmoke)
								{
									feedbackAlert = true;
								}
								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Long-term cough");
											if(Qpip)
											{
												FB.Append(" and ");
											}
										}
										if(Qpip)
										{
											FB.Append("Squeaking sound in the chest");
										}
										FB.Append("</B><BR>Your responses indicate that you have symptoms that could be do to your smoking. If have not already sought help from a physician, it is recommended that you contact your occupational health care provider.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Smoking</B><BR>As you probably know, smoking is hazardous to health. If you want help to quit smoking it is recommended that you contact your occupational health care provider.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Long-term cough");
										if(Qpip)
										{
											FB.Append(" and ");
										}
									}
									if(Qpip)
									{
										FB.Append("Squeaking sound in the chest");
									}
									FB.Append("</B><BR>Symptoms such as long-term cough and squeaking sound in the chest can be symptoms of asthma. If you are not treated for this already, it is recommended that you contact your occupational health care provider.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);

								if(Qalco)
								{
									feedbackAlert = true;
								}

								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alcohol</B>" +
										"<BR>" +
										"In our culture, alcohol is often included in social situations and it can have several positive effects. Your responses indicate that alcohol causes problems in your life. If you do something about the situation now, you can get good help. If you wait too long before addressing this, your problems can be prolonged and exacerbated." +
										"<BR><BR>" +
										"You can read more about drinking habits in the following links: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Below you will find information on where to turn for advice and support." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Support from the Alcohol-line</B>" +
										"<BR><BR>" +
										"Alcohol-line offers support via the phone." +
										"<BR><BR>" +
										"Are you thinking about your drinking habits? Call us and to talk with our advisors. If you need assistance in changing your habits, we can give you support. It's free." +
										"<BR><BR>" +
										"Those who turn to the alcohol line can choose between two options:" +
										"<BR>" +
										"- To either call for advice when you think you need it, or" +
										"<BR>" +
										"- To be called on a number of occasions for counseling and follow-up." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Who answers at the Alcohol line?" +
										"<BR>" +
										"Among the advisers there are general practitioners, nurses, psychologists, health educators and public health experts." +
										"<BR><BR>" +
										"The opening hours of the Alcohol line will initially be Monday thru Thursday between 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout || Qdepr)
								{
									feedbackAlert = true;
								}
								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Chronic fatigue depression</B>" +
											"<BR>" +
											"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact your occupational health care provider.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"The risk of prolonged symptoms increases significantly if you put such high demands on yourself that you do not take the time to rest and recover. " +
											"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact your occupational health care provider.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Burnout</B>" +
											"<BR>" +
											"Your answers show that you have symptoms indicative of a high stress level. Long-term stress without adequate recovery can lead to burnout or chronic fatigue syndrome. " +
											"There is good evidence that a burnout process can be stopped. If you have not been in contact a physician, it is recommended that you contact your occupational health care provider.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
										"<BR>" +
										"Your answers indicate that you may have symptoms of depression. These days depression can be treated with excellent results. If you have not been in touch with a physician, it is recommended that you contact your occupational health care provider.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sleep</B>" +
										"<BR>" +
										"Sleep is our most important resource for recovery and it is essential to preserve health, welfare and performance for instance. During sleep several important hormones that repair, heal and restore the body are secreted. If sleep is disturbed for a longer period, there is a higher risk of eventually suffering from various stress-related diseases." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("You have indicated that your sleep is Good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 311: FB.Append("You have indicated that your sleep is Quite good, indicating that your sleep and recovery are good; i.e. you generally fall asleep easy, sleep well and feel rested when you wake up."); break;
										case 312: FB.Append("You have indicated that your sleep is Neither good nor bad. If you feel that you have repeated difficulty in falling asleep, or sleeping well or you are not well rested when you wake up, it is necessary to improve your sleep, for ultimately preserving the health and wellbeing. In this case it is important to remember to unwind at least two hours before bedtime. Sleep quality can also be improved by regularly doing breathing and relaxation exercises before bedtime."); break;
										case 313: feedbackAlert = true; FB.Append("You have indicated that your sleep is Quite poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational health care provider."); break;
										case 314: feedbackAlert = true; FB.Append("You have indicated that your sleep is Poor, which generally reflects one/some of the following symptoms: difficulty falling asleep, poor sleep quality, fatigue upon awakening, and that you do not feel rested. These symptoms indicate a clear need to improve sleep. It is completely normal to sleep poorly occasionally, or for short periods, for different reasons. However, if you have had sleeping problems for a long time, it needs to be taken seriously. You can start by reflecting on if there are obvious reasons why you sleep poorly. If you are unsure about how to handle your sleep problems, it is recommended that you contact your occupational health care provider."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Health</B>" +
										"<BR>" +
										"It is now well established that self-rated health is an important indicator of how you will feel in the future. If you consider your health to be very good or good you are far more likely to maintain/improve your health in the future compared with those who estimate their health as poor." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("You have rated your health to be Good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 311: FB.Append("You have rated your health to be Quite good and thus you seem to have a healthy lifestyle and/or feel quite good. People with your health rating are most likely to preserve or improve their health in future."); break;
										case 315: FB.Append("You have rated your health to be Neither good nor bad, which means that there may be a risk that your health deteriorates further in the future. Since self-rated health is a summary measure of both physical and mental wellbeing, we recommend that you review your lifestyle, for example in terms of physical exercise, sleep, and eating habits."); break;
										case 316: feedbackAlert = true; FB.Append("You have indicated your health to be Quite poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your occupational health care provider for a discussion of your health and what might be done to improve it."); break;
										case 317: feedbackAlert = true; FB.Append("You have indicated your health to be Poor. If it is not just a temporary feeling, and you have not already been in touch with a physician, it is recommended that you contact your occupational health care provider for a discussion of your health and what might be done to improve it."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) is the most commonly used measure to define obesity. <B>Your BMI is " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Classification</B></td><TD><B>(alternative term</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Health risk</B></TD></TR><TR><TD>Underweight; short weight</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>The risks vary depending on the cause of the underweight</TD></TR><TR><TD>Normal weight</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normal risk</TD></TR><TR><TD>Over weight</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Slightly increased</TD></TR><TR><TD><I>Obesity</I></td><TD><I>Severe obesity</I></td><TD><I>&ge; 30</I></td><TD><I>Moderately to highly increased</I></TD></TR><TR><TD>Obesity class I</td><TD>Obesity</td><TD>30,0 - 34,9</td><TD>Moderately increased, increased risk</TD></TR><TR><TD>Obesity class II</td><TD>Severe obesity</td><TD>35,0 - 39,9</td><TD>High, strongly increased risk</TD></TR><TR><TD>Obesity class III</td><TD>Extreme obesity</td><TD>&ge; 40</td><TD>Very high, extreme risk increase</TD></TR></TABLE>");

									if(Qbmi > 25)
									{
										feedbackAlert = true;
									}
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at serious risk of developing type 2 diabetes. An estimated 50 % fall ill. Regular, moderate exercise and a good diet reduce the risk of developing diabetes. It is therefore recommended that you contact your occupational health care provider to get a more accurate assessment of your blood sugar levels (both fasting and glucose load or blood sugar after a meal). These tests will show if you possibly have symptom free diabetes.");
									}
									else if(Qscore >= 15)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you are at high risk of developing type 2 diabetes. An estimated 33 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes. It is therefore suggested that you contact your occupational health care provider to get a more accurate risk assessment.");
									}
									else if(Qscore >= 12)
									{
										feedbackAlert = true;
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a moderate risk of developing type 2 diabetes. An estimated 17 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a slightly increased risk of developing type 2 diabetes. An estimated 4 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									else
									{
										FB.Append("Your weighted score of lifestyle and hereditary factors indicate that you have a low risk of developing type 2 diabetes. An estimated 1 % fall ill. Regular, moderate exercise and good diet reduce the risk of developing diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Type 2 diabetes (adult-onset diabetes, maturity onset diabetes) is a serious hereditary disease. But you can greatly influence the risk of getting diabetes through lifestyle. Obesity, especially abdominal obesity, physical inactivity, poor diet and smoking increases the risk of developing type 2 diabetes." +
										"<BR><BR>" +
										"Both older age and genetic factors may increase the risk for type 2 diabetes, and these factors can not be influenced. On the other hand, other risk factors such as obesity, abdominal obesity, physical inactivity, diet and smoking can be influenced. A healthy lifestyle can entirely prevent, or at least postpone type 2 diabetes as far in the future as possible. If you have diabetes in your family you should be particularly careful with your body weight over the years. Fat around the waist, so-called abdominal obesity, represents an additional risk. It may take time before you feel the symptoms of type 2 diabetes.");
								}
								#endregion

								#endregion

							}
							SurveyIntro.Text += FB.ToString();
						}
						else if(surveyID == 43)
						{
							// Samma som KS2008 med utan handlingsplaner

							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Du rekommenderas att kontakta sjukgymnast.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
							else
							{
								#region webbqps all
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = true;
								bool Qneck = true;
								bool QbnSleep = true;
								bool QbnWork = true;
								bool QbnWorse = true;
								if(Qback || Qneck)
								{
									for(int i1=0; i1<2; i1++)
									{
										Qback = !Qback;
										for(int i2=0; i2<2; i2++)
										{
											Qneck = !Qneck;
											for(int i3=0; i3<2; i3++)
											{
												QbnSleep = !QbnSleep;
												for(int i4=0; i4<2; i4++)
												{
													QbnWork = !QbnWork;
													for(int i5=0; i5<2; i5++)
													{
														QbnWorse = !QbnWorse;

														if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
														{
															FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
															if(Qback)
															{
																FB.Append("Rygg");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("Nacke");
															}
															FB.Append("</B><BR>Du har angivit att du har besvär från ");
															if(Qback)
															{
																FB.Append("ryggen");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("nacken");
															}
															FB.Append(" samt att dessa besvär ");
															if(QbnWorse)
															{
																FB.Append("förvärras av arbetet");
																if(QbnSleep || QbnWork)
																{
																	FB.Append(" och att besvären ");
																}
															}
															if(QbnSleep || QbnWork)
															{
																FB.Append("varit så pass svåra att du haft svårt ");
																if(QbnSleep)
																{
																	FB.Append("att sova");
																	if(QbnWork)
																	{
																		FB.Append(" och ");
																	}
																}
																if(QbnWork)
																{
																	FB.Append("utföra ditt arbete");
																}
															}
															FB.Append(". Du rekommenderas att kontakta sjukgymnast.");
														}
													}
												}
											}
										}
									}
								}
								#endregion
								
								FB.Append("<BR>");
								
								#region Smoke/Hosta/Pip
								bool Qhosta = true;
								bool Qpip = true;
								bool Qsmoke = true;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare.");
									//}
								}
								//else if(Qpip || Qhosta)
								if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = true;
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = true;
								bool Qpbs = true;
								bool Qdepr = true;

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
									//else if(Qpbs)
									if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
									//}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning.");
								}
								#endregion

								FB.Append("<BR>");

								#region Sleep
								//if(oldValues.Contains("Q374O86"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								for(int i=310; i<=314; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
									}
									if(i != 314)
									{
										FB.Append("<BR>");
									}
									FB.Append("<BR>");
								}
								//}
								#endregion

								#region Health
								//if(oldValues.Contains("Q331O98"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								for(int i=310; i<=317; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
									if(i != 312 && i != 313 && i != 314 && i != 317)
									{
										FB.Append("<BR><BR>");
									}
								}
								//}
								#endregion

								#region Findrisk
								int Qscore = 0;
								for(int i=0; i<5; i++)
								{
									switch(i)
									{
										case 0: Qscore = 0; break;
										case 1: Qscore = 7; break;
										case 2: Qscore = 12; break;
										case 3: Qscore = 15; break;
										case 4: Qscore = 21; break;
									}
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B> <B STYLE=\"color:#CC0000;\">Ej diabetes diagnos, Findrisk score = " + Qscore + "</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
								}
								FB.Append("<BR><BR><B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos)</B><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
						else if(surveyID == 49)
						{
							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Du rekommenderas att kontakta sjukgymnast.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
									"<BR><BR>" +
									"Nedan finns information om vart du kan vända dig för råd och stöd." +
									"<BR><BR>" +
									"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
									"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
									"<BR><BR>" +
									"Alkohollinjen erbjuder stöd per telefon." +
									"<BR><BR>" +
									"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
									"<BR><BR>" +
									"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
									"<BR>" +
									"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
									"<BR>" +
									"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
									"<BR><BR>" +
									"Telefon 020-84 44 48" +
									"<BR>" +
									"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
									"<BR>" +
									"Mer information finns på vårdguiden: <A HREF=\"http://www.vardguiden.se/Theme_Startpage.asp?c=3586\" TARGET=\"_blank\">http://www.vardguiden.se/Theme_Startpage.asp?c=3586</A>." +
									"<BR><BR>" +
									"Vilka svarar på Alkohollinjen?" +
									"<BR>" +
									"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
									"<BR><BR>" +
									"Alkohollinjens öppettider är måndag-torsdag kl 14:00-19:00 och fredag kl 14:00-17:00." +
									"</DIV>");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården." +
										"<BR><BR>");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper. " +
										"Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården." +
										"<BR><BR>");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper. " +
										"Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården." +
										"<BR><BR>");
								}
							}
							else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								bool QsleepI = false, QpreviaI = false;

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
									case 311: FB.Append("Du har angivit att din sömn är ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
									case 312: QsleepI = true; FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården."); break;
									case 314: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								bool QpreviaI = false;

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är ganska bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: QpreviaI = true; FB.Append("Du har angivit att din hälsa är ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården."); break;
									case 317: QpreviaI = true; FB.Append("Du har angivit att din hälsa är dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården."); break;
								}
							}
							#endregion


							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");
							}

							int Qscore = 0;

							#region Findrisk
							if(
								(
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
								||
								oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
								)
								&&
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								&&
								oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
								&&
								oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
								&&
								oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
								&&
								oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
								&&
								oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
								)
							{
								int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
								bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
								//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
								double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
								bool Qnomotion = false;
								if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
								{
									Qnomotion = true;
								}
								if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
								{
									Qnomotion = true;
								}
								bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
								bool Qbp = 
									oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
									&& 
									oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
								bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
									Qscore += 3;
								if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
									Qscore += 5;

								if(Qage >= 65)
								{
									Qscore += 4;
								}
								else if(Qage >= 55)
								{
									Qscore += 3;
								}
								else if(Qage >= 45)
								{
									Qscore += 2;
								}

								if(Qbmi > 30)
								{
									Qscore += 3;
								}
								else if(Qbmi >= 25)
								{
									Qscore += 1;
								}
		
								if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
								{
									Qscore += 4;
								}
								else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
								{
									Qscore += 3;
								}
								if(Qnomotion)
								{
									Qscore += 2;
								}
								if(Qnoveggies)
								{
									Qscore += 1;
								}
								if(Qbp)
								{
									Qscore += 2;
								}
								if(Qbs)
								{
									Qscore += 5;
								}

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
									"<BR>");
								if(Qscore > 20)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
								}
								else if(Qscore >= 15)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av risken.");
								}
								else if(Qscore >= 12)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else if(Qscore >= 7)
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								else
								{
									FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
								}
								FB.Append("<BR><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
							}
							#endregion

							FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Friskvård</B><BR>Du är välkommen att delta i friskvårdens vanliga utbud. Klicka på länken för mer information:<BR><A HREF=\"http://klara/AFATemplates/AFAFritid_StartPage.aspx?id=25953\" TARGET=\"_blank\">AFA Hälsa, KLARA</A>");

							FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Företagshälsovård</B><BR>Klicka på länken för mer information om företagshälsovården:<BR><A HREF=\"http://www.mhcab.se\" TARGET=\"_blank\">MHC Företagshälsovård</A>");

							#endregion

							SurveyIntro.Text += FB.ToString();
						}
						else if(surveyID == 44 || surveyID == 46 || surveyID == 48 || surveyID == 53)
						{
							#region KS 2008

							if(surveyID == 44 || surveyID == 46)
							{
								showPDF = false;
							}

							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Du rekommenderas att kontakta personalsjukgymnast.");
		
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sjukgymnastik</B>" +
										"<BR><BR>" +
										"Som en del av det förebyggande hälso- och arbetsmiljöarbetet finns det sjukgymnaster som arbetar med belastnings- och stressrelaterade besvär hos de anställda, både i Huddinge och i Solna. Syftet är att kunna göra en tidig insats vid arbetsrelaterade besvär." +
										"<BR><BR>" +
										"Du har möjlighet att få hjälp av en sjukgymnast om du har drabbats av smärta eller led-, rygg- eller muskelbesvär. Vi erbjuder en sjukgymnastisk bedömning, behandling och uppföljning. Du kan erbjudas olika former av friskvårdsträning alternativt remitteras till en annan vårdgivare." +
										"<BR>" +
										"Sjukgymnasterna arbetar på uppdrag av HR-avdelningen och samarbetar med Sektionen för arbetsmiljö och hälsa, samt med företagshälsovården." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Susanne Sandström och Eva Ajax, Leg sjukgymnast, 585 818 26." +
										"<BR>" +
										"Sjukgymnastikkliniken, R 41" +
										"<BR>" +
										"Telefontid: måndag kl. 12:30-13:30, torsdag kl. 09:45-10:45." +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Ulla Oxelbeck, Leg sjukgymnast 517 727 55." +
										"<BR>" +
										"Sjukgymnastiken, huvudbyggnaden, gå in i huvudentrén, gå rakt fram och ta hissarna efter cafeterian, 1 tr ner (U1)." +
										"</DIV>");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Har du bestämt dig för att sluta röka eller snusa?<BR>Internetbaserad kurs med stöd via e-post</B>" +
										"<BR><BR>" +
										"Ni kommer att på egen hand arbeta med materialet &quot;Sluta nu&quot;, vilket Cancerfonden, Folkhälsoinstitutet, Hjärt- och Lungfonden samt Läkare mot tobak står bakom." +
										"<BR><BR>" +
										"Varje vecka får du ett veckobrev av oss och mellan dem arbetar du med en internetbaserad sluta-röka/snusa skola själv. Du kan när som helst få stöd av oss via e-post. Du kommer under den första hälften av kursen förbereda dig mentalt på att sluta röka eller snusa, samt få information om nikotinhjälpmedel. Fimpardatum sker efter några veckor. Efter &quot;fimpardatumet&quot; kommer du att lära dig vad som händer vid nikotinstoppet och hur du kan ta hand om dig själv." +
										"<BR><BR>" +
										"<B>Start</B>: 1/9" +
										"<BR>" +
										"<B>Anmälan</B>: senast 25/8" +
										"<BR><BR>" +
										"<B>Så här anmäler du dig till kursen</B>" +
										"<BR>" +
										"Anmälan görs på: <A TARGET=\"_blank\" HREF=\"http://inuti.karolinska.se/templates/form____95536.aspx\">http://inuti.karolinska.se/KI-LIME kursanmälan</A>." +
										"<BR><BR>" +
										"Har ni frågor om kursverksamheten kan ni ringa till Mariette Veideskog, 585 868 43." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Den svåra konsten att sluta röka<br>Föreläsning</B>" +
										"<BR><BR>" +
										"Har du någon gång funderat på att sluta röka? Det har de flesta som röker. Oavsett om du har funderat på att sluta eller ej är du välkommen på denna föreläsning. " +
										"<BR>" +
										"Vi kommer att diskutera de svårigheter vi får när vi försöker sluta röka, men också om olika möjligheter som kan underlätta beslutet och stoppet. Du får verktyg du kan använda dig av om och när du bestämt dig för att sluta. " +
										"<BR>" +
										"<B>Huddinge:</B>" +
										"<BR>" +
										"Måndagen den 15/9, kl 14:00-15:30" +
										"<BR>" +
										"Konferensrum 2, HR-avdelningen CI 77" +
										"<BR>" +
										"<BR>" +
										"<B>Solna:</B>" +
										"<BR>" +
										"Tisdagen den 16/9, kl 14:00-15:30" +
										"<BR>" +
										"Thoraxaulan" +
										"<BR>" +
										"<BR>" +
										"<B>Föreläsare:</B>" +
										"<BR>" +
										"Mariette Weideskog, Hälsopedagog" +
										"<BR>" +
										"Sektionen för arbetsmiljö och hälsa, HR-avdelningen, Karolinska" +
										"<BR><BR>" +
										"Du behöver inte anmäla dig till föreläsningen, det är bara att komma. Du får gå på arbetstid och förutsätter medgivande från din närmsta chef." +
										"</DIV>");
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR>" +
										"Mer information finns på vårdguiden: <A HREF=\"http://www.vardguiden.se/Theme_Startpage.asp?c=3586\" TARGET=\"_blank\">http://www.vardguiden.se/Theme_Startpage.asp?c=3586</A>." +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider är måndag-torsdag kl 14:00-19:00 och fredag kl 14:00-17:00." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Previa</B>" +
										"<BR><BR>" +
										"Kontakta företagssköterskan för rådgivning i alkohol- och drogfrågor." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper. " +
											"Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper. " +
											"Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}

									#region Samtalsgrupper
									FB.Append("<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stresshanteringsgrupp</B>" +
										"<BR><BR>" +
										"Upplevd stress hanteras på många olika sätt av olika individer och det är inte alls säkert att det behöver innebära något negativt, men det kan också tolkas som signaler på att något bör göras åt det." +
										"<BR>" +
										"Det finns inte <B><U>en</U></B> enkel lösning på problemet med stress och förebyggande åtgärder måste därför också ske inom många olika områden. Det krävs insatser såväl inom organisationen, på arbetsplatsen, i samhället i stort, som för den enskilde individen. Du som individ ges nu möjligheten att delta i;" +
										"<BR><BR>" +
										"<B>Reflekterande, kollegiala samtalsgrupper</B>" +
										"<BR>" +
										"Reflekterande kollegiala samtalsgrupper sker utifrån en pedagogisk metod och är ett sätt att förebygga utveckling av arbetsrelaterad stress och utmattning. I tidigare studier med liknande grupper har man konstaterat att kollegialt stöd, tid för reflektion och erfarenhetsutbyte mellan kollegor visat sig vara mycket värdefullt för deltagarna. Kollegor från olika arbetsplatser har ofta gemensamma yrkesrelaterade problem och erfarenheter, men samtidigt olika infallsvinklar och lösningar på dessa." +
										"<BR><BR>" +
										"<B>Genomförande</B>" +
										"<BR>" +
										"Vi kommer att skapa grupper med 8 personer ur samma eller liknande yrkesgrupp och leds av en handledare. Man träffas under 11 veckor, 2 timmar vid varje tillfälle. Efter förankring hos arbetsledare, sker en av timmarna på betald arbetstid, den andra timmen får du ta av din fritid." +
										"<BR><BR>" +
										"<B>Anmälan och förfrågningar</B>" +
										"<BR>" +
										"Kurserna kommer att starta under hösten och hållas mellan 14:00-16:00. Vi kommer att försöka starta grupper efter yrke, därför kan vi inte säga vilken dag som är aktuell. Eventuella frågor besvaras av Mariette Weideskog, 585 868 43. Anmälan görs på: <A HREF=\"http://inuti.karolinska.se/templates/form____95536.aspx\" TARGET=\"_blank\">http://inuti.karolinska.se/KI-LIME kursanmälan</A>, senast den 17/8." +
										"</DIV>" +
										"<BR>");
									#endregion

									#region Enskilda samtal
									FB.Append("<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Enskilda samtal</B>" +
										"<BR><BR>" +
										"Vi som arbetar i Sjukhuskyrkan har lång erfarenhet av att möta människor i sorg och kris. Att lyssna och tala om det riktigt svåra är en av våra allra viktigaste uppgifter. Syftet med samtalen är att stödja och hjälpa, ge hopp och mod. Samtalen kan ske vid ett eller flera tillfällen. " +
										"<BR><BR>" +
										"Sjukhuskyrkans enskilda samtal erbjuds alla, oavsett tro och livsåskådning. Många av dem vi träffar har i vanliga fall ingen anknytning till kyrkan. " +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Kontakta Hans-Peter Rasmussen, ank 740 73 för bokning av samtal." +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Kontakta Leena Widén, sjukhusdiakon ank 802 90 eller Ingegärd Martinsson, sjukhuspräst, ank 802 93 för bokning av samtal." +
										"</DIV>" +
										"<BR>");
									#endregion

									#region Stödsamtal
									FB.Append("<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stödsamtal hos Previa</B>" +
										"<BR><BR>" +
										"Du som medarbetare har rätt till upp till <i>två</i> besök hos beteendevetare/psykolog, därefter skall ytterligare besök sanktioneras av ansvarig chef." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
									#endregion
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
										"<BR><BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									bool QsleepI = false, QpreviaI = false;

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
										case 312: QsleepI = true; FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
										case 314: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
									}
									if(QsleepI || QpreviaI)
									{
										FB.Append("<BR>");
										if(QsleepI)
										{
											FB.Append("<BR>" +
												"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
												"<B STYLE=\"font-size:16px;\">&quot;Hur sover du egentligen?&quot;</B>" +
												"<BR><BR>" +
												"Tillhör du den kategorin som räknar får på natten så ska du komma på denna föreläsning. Vad är sömn egentligen? När ska man ta tupplurar? Är det bra att räkna får? Du kommer få kunskap om hur vår sömncykel fungerar och få tips och idéer på vad du själv kan göra för att förbättra din sömn." +
												"<BR><BR>" +
												"<B>Solna</B>:" +
												"<BR>" +
												"Tisdagen den 9/9, kl 14:00-15:30, Thoraxaulan" +
												"<BR><BR>" +
												"<B>Huddinge</B>:" +
												"<BR>" +
												"Onsdagen den 4/9, kl 14:00-15:30, R 64" +
												"<BR><BR>" +
												"<B>Föreläsare</B>: Mariette Weideskog, Hälsopedagog, Sektionen för arbetsmiljö och hälsa, HR-avdelningen" +
												"<BR><BR>" +
												"Du behöver inte anmäla dig till föreläsningen, det är bara att komma. Du får gå på arbetstid och förutsätter medgivande från din närmsta chef." +
												"</DIV>");
										}
										if(1==0 && QpreviaI)
										{
											FB.Append("<BR>" +
												"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
												"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
												"<BR><BR>" +
												"För dig som arbetar på Karolinska, Solna:" +
												"<BR>" +
												"<B>Previa Haga</B>" +
												"<BR>" +
												"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
												"<BR>" +
												"Öppet:	Mån-fre 08.00-16.45" +
												"<BR>" +
												"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
												"<BR>" +
												"Tfn vxl: 08-728 51 40" +
												"<BR><BR>" +
												"För dig som arbetar på Karolinska, Huddinge:" +
												"<BR>" +
												"<B>Previa Huddinge</B>" +
												"<BR>" +
												"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
												"<BR>" +
												"Öppet: Mån-fre 08.00-16.45" +
												"<BR>" +
												"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
												"<BR>" +
												"Tfn vxl: 08-608 63 80" +
												"<BR><BR>" +
												"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
												"<BR>" +
												"<B>Previa Gullmarsplan</B>" +
												"<BR>" +
												"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
												"<BR>" +
												"Öppet: Mån-fre 08.00-16.45" +
												"<BR>" +
												"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
												"<BR>" +
												"Tfn vxl: 08 - 722 24 00" +
												"</DIV>");
										}
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									bool QpreviaI = false;

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: QpreviaI = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
										case 317: QpreviaI = true; FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
									}
									if(1==0 && QpreviaI)
									{
										FB.Append("<BR><BR>" +
											"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
											"<BR><BR>" +
											"För dig som arbetar på Karolinska, Solna:" +
											"<BR>" +
											"<B>Previa Haga</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
											"<BR>" +
											"Öppet:	Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
											"<BR>" +
											"Tfn vxl: 08-728 51 40" +
											"<BR><BR>" +
											"För dig som arbetar på Karolinska, Huddinge:" +
											"<BR>" +
											"<B>Previa Huddinge</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
											"<BR>" +
											"Öppet: Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
											"<BR>" +
											"Tfn vxl: 08-608 63 80" +
											"<BR><BR>" +
											"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
											"<BR>" +
											"<B>Previa Gullmarsplan</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
											"<BR>" +
											"Öppet: Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
											"<BR>" +
											"Tfn vxl: 08 - 722 24 00" +
											"</DIV>");
									}

								}
								#endregion


								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");

									if(Qscore >= 12)
									{
										FB.Append("<BR><BR>" +
											"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Individuell träningsrådgivning</B>" +
											"<BR><BR>" +
											"Som anställd på Karolinska erbjuds du hjälp med individuell träningsrådgivning. Det kan vara att få en styrketränings introduktion i vårt personalgym, hjälp med rörlighets- eller konditionsträning, stretchövningar m.m. Allt efter dina behov." +
											"<BR><BR>" +
											"För bokning av träningsrådgivning i <B>Solna</B>" +
											"<BR>" +
											"Tomas Hernvall, Friskvårdskonsulent/Gymföreståndare, HR-avdelningen, ank 757 10." +
											"<BR><BR>" +
											"För bokning av träningsrådgivning i <B>Huddinge</B>" +
											"<BR>" +
											"Marie Hammarström, Friskvårdskonsulent/Gymföreståndare, HR-avdelningen, ank 868 42." +
											"<BR><BR>" +
											"Du får gå på träningsrådgivningen på arbetstid och förutsätter medgivande av din närmsta chef." +
											"</DIV>" +
											"<BR>" +
											"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">&quot;Kost, Rörelse, Hälsa&quot;</B>" +
											"<BR><BR>" +
											"Vill du lära dig mer om kost och motion? Hur påverkar kosten och rörelsen ditt välbefinnande och din hälsa? Börjar favoritbyxorna sitta lite tight i midjan?  Nu har du chansen att på ett bra sätt hitta en hälsosam vikt och få bra vanor genom att lära dig mer om kostens och rörelsens betydelse." +
											"<BR><BR>" +
											"Kursen består av 9 gruppträffar á 1 timme. På träffarna kommer vi bland annat att diskutera våra mat- och motionsvanor och beteenden. Inom kosten kommer vi bland annat att prata om våra energikällor, måltidssammansättning, fettkällor samt kosttrender. Du kommer inte att följa någon diet, utan tanken är att du ska lära dig så mycket om kost så att du kan sätta samman en bra måltid själv. Fysisk aktivitet och rörelse är en viktig grundpelare i en hälsosam livsstil och en hjälp till att få energibalans och därmed en hälsosam vikt. Vi kommer bland annat att prata om positiva effekter av fysisk aktivitet och praktisera detta på ett enklare sätt. Hur lite kan du &quot;komma undan med&quot;?" +
											"<BR><BR>" +
											"Vid varje kurstillfälle har samtliga möjlighet att väga sig." +
											"<BR><BR>" +
											"<B>Datum, Tid & Lokal</B>" +
											"<BR><BR>" +
											"<B>Solna</B>" +
											"<BR>" +
											"Torsdagar, kl 11:00-12:00, start vecka 37. AGA-salen i Eugeniahemmet vid samtliga tillfällen förutom den 9/10 då vi träffas i lilla salen, ALB." +
											"<BR><BR>" +
											"<B>Huddinge</B>" +
											"<BR>" +
											"Torsdagar, kl 14:00-15:00, start vecka 37. Konferensrum 2, HR-avdelningen CI 77." +
											"<BR><BR>" +
											"<B>Kursledare</B>" +
											"<BR>" +
											"Hälsopedagog från HR-avdelningen." +
											"<BR><BR>" +
											"<B>Kostnad</B>" +
											"<BR>" +
											"Kursen är avgiftsfri och sker på arbetstid och förutsätter medgivande från din närmsta chef." +
											"<BR><BR>" +
											"<B>Anmälan</B>" +
											"<BR>" +
											"Anmälan görs på <A HREF=\"http://inuti.karolinska.se/templates/form____95536.aspx\" TARGET=\"_blank\">http://inuti.karolinska.se/KI-LIME kursanmälan</A>, senast den 17/8. Har ni frågor om kursverksamheten kan ni ringa till Charlotte Ovefelt, 585 894 82." +
											"</DIV>");
									}
								}
								#endregion

								if(!Qalco && !Qdepr && !Qburnout && Qscore < 12)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Friskvård</B><BR>Du är välkommen att delta i friskvårdens vanliga utbud. Klicka på länken för mer information:<BR><A HREF=\"http://inuti.karolinskauniversitetssjukhuset.se/templates/Page____8345.aspx\" TARGET=\"_blank\">http://inuti.karolinskauniversitetssjukhuset.se/templates/Page____8345.aspx</A>");
								}

								#endregion

								if(surveyID == 44 || surveyID == 46)
								{
									string emailMsg = "Tack för din medverkan i chefsstudien KI-LIME!" +
										"\r\n\r\n" +
										"Gör så här för att få din personliga återkoppling:" +
										"\r\n\r\n" +
										"1. Gå in på http://www.webbqps.se" +
										"\r\n" +
										"2. Klicka på \"För projektdeltagare\"" +
										"\r\n" +
										"3. Skriv din e-postadress i rutan och klicka på \"Skicka\"" +
										"\r\n" +
										"4. Länken till din återkoppling skickas till din e-postadress" +
										"\r\n\r\n" +
										"Du får då också vid behov erbjudanden om hälsofrämjande aktiviteter, t ex stresshanteringsgrupp, kost- och rörelsekurs, sluta röka-kurs eller föreläsningar om sömn." +
										"\r\n\r\n" +
										"Tänk på att avsätta lite tid för att gå igenom dina resultat. Det är inte säkert att du hinner läsa allt på en gång just nu.";

									int previous = 0;
									rs = Db.sqlRecordSet("SELECT " +
										"TOP 1 a.AnswerID " +
										"FROM ProjectRoundUserCompare usr " +
										"INNER JOIN Answer a ON usr.CompareProjectRoundUserID = a.ProjectRoundUserID AND a.EndDT IS NOT NULL " +
										"WHERE usr.ProjectRoundUserID = " + projectRoundUserID);
									if(rs.Read())
									{
										previous = rs.GetInt32(0);
									}
									rs.Close();

									try
									{
										rs = Db.sqlRecordSet("SELECT usr.Email, pr.EmailFromAddress " +
											"FROM ProjectRoundUser usr " +
											"INNER JOIN ProjectRoundUnit pru ON usr.ProjectRoundUnitID = pru.ProjectRoundUnitID " +
											"INNER JOIN ProjectRound pr ON pru.ProjectRoundID = pr.ProjectRoundID " +
											"WHERE usr.ProjectRoundUserID = " + projectRoundUserID);
										if(rs.Read())
										{
											System.Web.Mail.MailMessage msg = new System.Web.Mail.MailMessage();
											msg.To = rs.GetString(0);
											msg.From = rs.GetString(1);
											msg.Subject = "Personlig återkoppling på årets webbenkät";
											msg.Body = emailMsg;
											msg.BodyFormat = System.Web.Mail.MailFormat.Text;
											msg.BodyEncoding = System.Text.Encoding.GetEncoding(1252);
											System.Web.Mail.SmtpMail.SmtpServer = System.Configuration.ConfigurationSettings.AppSettings["SmtpServer"];
											System.Web.Mail.SmtpMail.Send(msg);
										}
										rs.Close();
									}
									catch(Exception) {}

									FB.Append("<div style=\"page-break-before:always\">&nbsp;</div>");
									FB.Append(feedback.renderFeedback(1,surveyID,"KUS 2007","KUS 2007, kliniska enheter",20,"",true,previous,answerID,"Ditt svar 2007","Ditt svar 2008","FFFFFF"));

									SurveyIntro.Text += emailMsg.Replace("\r\n","<br>");
								}
								else if(surveyID == 48)
								{
									FB.Append("<div style=\"page-break-before:always\">&nbsp;</div>");
									FB.Append(feedback.renderFeedback(1,surveyID,"Org X","Org X",20,"",true,0,answerID,"","Ditt svar","FFFFFF"));

									SurveyIntro.Text += FB.ToString().Replace("class=\"eform_area\"","").Replace(" class=\"eform_ques_outer\"","").Replace(" class=\"eform_ques\"","").Replace("BGCOLOR=FFFFFF&","");

									if(projectRoundUserID == 0)
									{
										FB = new System.Text.StringBuilder();
									}
								}
								else
								{
									SurveyIntro.Text += FB.ToString();
								}
							}
							else
							{
								#region webbqps annotated
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = true;
								bool Qneck = true;
								bool QbnSleep = true;
								bool QbnWork = true;
								bool QbnWorse = true;
								if(Qback || Qneck)
								{
									for(int i1=0; i1<2; i1++)
									{
										Qback = !Qback;
										for(int i2=0; i2<2; i2++)
										{
											Qneck = !Qneck;
											for(int i3=0; i3<2; i3++)
											{
												QbnSleep = !QbnSleep;
												for(int i4=0; i4<2; i4++)
												{
													QbnWork = !QbnWork;
													for(int i5=0; i5<2; i5++)
													{
														QbnWorse = !QbnWorse;

														if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
														{

															FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
															if(Qback)
															{
																FB.Append("Rygg <SPAN STYLE=\"color:#CC0000\">(om rygg)</SPAN>");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("Nacke <SPAN STYLE=\"color:#CC0000\">(om nacke)</SPAN>");
															}
															FB.Append("</B><BR>Du har angivit att du har besvär från ");
															if(Qback)
															{
																FB.Append("ryggen <SPAN STYLE=\"color:#CC0000\">(om rygg)</SPAN>");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("nacken <SPAN STYLE=\"color:#CC0000\">(om nacke)</SPAN>");
															}
															FB.Append(" samt att dessa besvär ");
															if(QbnWorse)
															{
																FB.Append("förvärras av arbetet <SPAN STYLE=\"color:#CC0000\">(om förvärras arbetet)</SPAN>");
																if(QbnSleep || QbnWork)
																{
																	FB.Append(" och att besvären ");
																}
															}
															if(QbnSleep || QbnWork)
															{
																FB.Append("varit så pass svåra att du haft svårt ");
																if(QbnSleep)
																{
																	FB.Append("att sova <SPAN STYLE=\"color:#CC0000\">(svårt sova)</SPAN>");
																	if(QbnWork)
																	{
																		FB.Append(" och ");
																	}
																}
																if(QbnWork)
																{
																	FB.Append("utföra ditt arbete <SPAN STYLE=\"color:#CC0000\">(svårt utföra arbete)</SPAN>");
																}
															}
															FB.Append(". Du rekommenderas att kontakta personalsjukgymnast.");
														}
													}
												}
											}
										}
									}
	
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sjukgymnastik</B> <SPAN STYLE=\"color:#CC0000\">(om rygg eller nacke)</SPAN>" +
										"<BR><BR>" +
										"Som en del av det förebyggande hälso- och arbetsmiljöarbetet finns det sjukgymnaster som arbetar med belastnings- och stressrelaterade besvär hos de anställda, både i Huddinge och i Solna. Syftet är att kunna göra en tidig insats vid arbetsrelaterade besvär." +
										"<BR><BR>" +
										"Du har möjlighet att få hjälp av en sjukgymnast om du har drabbats av smärta eller led-, rygg- eller muskelbesvär. Vi erbjuder en sjukgymnastisk bedömning, behandling och uppföljning. Du kan erbjudas olika former av friskvårdsträning alternativt remitteras till en annan vårdgivare." +
										"<BR>" +
										"Sjukgymnasterna arbetar på uppdrag av HR-avdelningen och samarbetar med Sektionen för arbetsmiljö och hälsa, samt med företagshälsovården." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Susanne Sandström och Eva Ajax, Leg sjukgymnast, 585 818 26." +
										"<BR>" +
										"Sjukgymnastikkliniken, R 41" +
										"<BR>" +
										"Telefontid: måndag kl. 12:30-13:30, torsdag kl. 09:45-10:45." +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Ulla Oxelbeck, Leg sjukgymnast 517 727 55." +
										"<BR>" +
										"Sjukgymnastiken, huvudbyggnaden, gå in i huvudentrén, gå rakt fram och ta hissarna efter cafeterian, 1 tr ner (U1)." +
										"</DIV>");
								}
								#endregion

								#region Smoke/Hosta/Pip

								if(1==1)
								{
									if(1==1)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(1==1)
										{
											FB.Append("Långvarig hosta <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om hosta)</SPAN>");
											if(1==1)
											{
												FB.Append(" och ");
											}
										}
										if(1==1)
										{
											FB.Append("Pip i bröstet <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om pip)</SPAN>");
										}
										FB.Append("</B> <B STYLE=\"color:#CC0000;\">+ Om röker</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									if(1==1)
									{
										FB.Append("<BR>");
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B> <B STYLE=\"color:#CC0000;\">Om röker, ej hosta ej pip</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Har du bestämt dig för att sluta röka eller snusa?<BR>Internetbaserad kurs med stöd via e-post</B> <B STYLE=\"color:#CC0000;\">Om röker</B>" +
										"<BR><BR>" +
										"Ni kommer att på egen hand arbeta med materialet &quot;Sluta nu&quot;, vilket Cancerfonden, Folkhälsoinstitutet, Hjärt- och Lungfonden samt Läkare mot tobak står bakom." +
										"<BR><BR>" +
										"Varje vecka får du ett veckobrev av oss och mellan dem arbetar du med en internetbaserad sluta-röka/snusa skola själv. Du kan när som helst få stöd av oss via e-post. Du kommer under den första hälften av kursen förbereda dig mentalt på att sluta röka eller snusa, samt få information om nikotinhjälpmedel. Fimpardatum sker efter några veckor. Efter &quot;fimpardatumet&quot; kommer du att lära dig vad som händer vid nikotinstoppet och hur du kan ta hand om dig själv." +
										"<BR><BR>" +
										"<B>Start</B>: 1/9" +
										"<BR>" +
										"<B>Anmälan</B>: senast 25/8" +
										"<BR><BR>" +
										"<B>Så här anmäler du dig till kursen</B>" +
										"<BR>" +
										"Anmälan görs på: <A TARGET=\"_blank\" HREF=\"http://inuti.karolinska.se/templates/form____95536.aspx\">http://inuti.karolinska.se/KI-LIME kursanmälan</A>." +
										"<BR><BR>" +
										"Har ni frågor om kursverksamheten kan ni ringa till Mariette Veideskog, 585 868 43." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Den svåra konsten att sluta röka<br>Föreläsning</B> <B STYLE=\"color:#CC0000;\">Om röker</B>" +
										"<BR><BR>" +
										"Har du någon gång funderat på att sluta röka? Det har de flesta som röker. Oavsett om du har funderat på att sluta eller ej är du välkommen på denna föreläsning. " +
										"<BR>" +
										"Vi kommer att diskutera de svårigheter vi får när vi försöker sluta röka, men också om olika möjligheter som kan underlätta beslutet och stoppet. Du får verktyg du kan använda dig av om och när du bestämt dig för att sluta. " +
										"<BR>" +
										"<B>Huddinge:</B>" +
										"<BR>" +
										"Måndagen den 15/9, kl 14:00-15:30" +
										"<BR>" +
										"Konferensrum 2, HR-avdelningen CI 77" +
										"<BR>" +
										"<BR>" +
										"<B>Solna:</B>" +
										"<BR>" +
										"Tisdagen den 16/9, kl 14:00-15:30" +
										"<BR>" +
										"Thoraxaulan" +
										"<BR>" +
										"<BR>" +
										"<B>Föreläsare:</B>" +
										"<BR>" +
										"Mariette Weideskog, Hälsopedagog" +
										"<BR>" +
										"Sektionen för arbetsmiljö och hälsa, HR-avdelningen, Karolinska" +
										"<BR><BR>" +
										"Du behöver inte anmäla dig till föreläsningen, det är bara att komma. Du får gå på arbetstid och förutsätter medgivande från din närmsta chef." +
										"</DIV>");
								}
								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(1==1)
									{
										FB.Append("Långvarig hosta <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om hosta)</SPAN>");
										if(1==1)
										{
											FB.Append(" och ");
										}
									}
									if(1==1)
									{
										FB.Append("Pip i bröstet <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om pip)</SPAN>");
									}
									FB.Append("</B> <B STYLE=\"color:#CC0000;\">+ Om EJ röker</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion

								#region Alkohol

								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B> <B STYLE=\"color:#CC0000;\">Om 2-3 ggr/v eller oftare på fråga 31 SAMT varje månad eller oftare på fråga 31a ELLER 31b ELLER Ja, senaste året på fråga 31c</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR>" +
										"Mer information finns på vårdguiden: <A HREF=\"http://www.vardguiden.se/Theme_Startpage.asp?c=3586\" TARGET=\"_blank\">http://www.vardguiden.se/Theme_Startpage.asp?c=3586</A>." +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider är måndag-torsdag kl 14:00-19:00 och fredag kl 14:00-17:00." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Previa</B>" +
										"<BR><BR>" +
										"Kontakta företagssköterskan för rådgivning i alkohol- och drogfrågor." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B> <SPAN STYLE=\"color:#CC0000;\">Om 3 el. 4 på någon av 47-52 + ja på 53 (depression) samt om medel > 2.6 på fråga 38,40,41,44,45 (utbränd)</SPAN>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
										"<BR><BR>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B> <B STYLE=\"color:#CC0000;\">Om ej ovan samt medel > 2.6 på fråga 38,40,41,44,45 samt om medel > 3.25 på fråga 55-58</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper. " +
										"Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
										"<BR><BR>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B> <B STYLE=\"color:#CC0000;\">Om ej någon av de 2 ovan men medel > 2.6 på fråga 38,40,41,44,45</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder, t ex kollegiala samtalsgrupper. " +
										"Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården.<BR><BR>");

									FB.Append("<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stresshanteringsgrupp</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Upplevd stress hanteras på många olika sätt av olika individer och det är inte alls säkert att det behöver innebära något negativt, men det kan också tolkas som signaler på att något bör göras åt det." +
										"<BR>" +
										"Det finns inte <B><U>en</U></B> enkel lösning på problemet med stress och förebyggande åtgärder måste därför också ske inom många olika områden. Det krävs insatser såväl inom organisationen, på arbetsplatsen, i samhället i stort, som för den enskilde individen. Du som individ ges nu möjligheten att delta i;" +
										"<BR><BR>" +
										"<B>Reflekterande, kollegiala samtalsgrupper</B>" +
										"<BR>" +
										"Reflekterande kollegiala samtalsgrupper sker utifrån en pedagogisk metod och är ett sätt att förebygga utveckling av arbetsrelaterad stress och utmattning. I tidigare studier med liknande grupper har man konstaterat att kollegialt stöd, tid för reflektion och erfarenhetsutbyte mellan kollegor visat sig vara mycket värdefullt för deltagarna. Kollegor från olika arbetsplatser har ofta gemensamma yrkesrelaterade problem och erfarenheter, men samtidigt olika infallsvinklar och lösningar på dessa." +
										"<BR><BR>" +
										"<B>Genomförande</B>" +
										"<BR>" +
										"Vi kommer att skapa grupper med 8 personer ur samma eller liknande yrkesgrupp och leds av en handledare. Man träffas under 11 veckor, 2 timmar vid varje tillfälle. Efter förankring hos arbetsledare, sker en av timmarna på betald arbetstid, den andra timmen får du ta av din fritid." +
										"<BR><BR>" +
										"<B>Anmälan och förfrågningar</B>" +
										"<BR>" +
										"Kurserna kommer att starta under hösten och hållas mellan 14:00-16:00. Vi kommer att försöka starta grupper efter yrke, därför kan vi inte säga vilken dag som är aktuell. Eventuella frågor besvaras av Mariette Weideskog, 585 868 43. Anmälan görs på: <A HREF=\"http://inuti.karolinska.se/templates/form____95536.aspx\" TARGET=\"_blank\">http://inuti.karolinska.se/KI-LIME kursanmälan</A>, senast den 17/8." +
										"</DIV>" +
										"<BR>" +

										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Enskilda samtal</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Vi som arbetar i Sjukhuskyrkan har lång erfarenhet av att möta människor i sorg och kris. Att lyssna och tala om det riktigt svåra är en av våra allra viktigaste uppgifter. Syftet med samtalen är att stödja och hjälpa, ge hopp och mod. Samtalen kan ske vid ett eller flera tillfällen. " +
										"<BR><BR>" +
										"Sjukhuskyrkans enskilda samtal erbjuds alla, oavsett tro och livsåskådning. Många av dem vi träffar har i vanliga fall ingen anknytning till kyrkan. " +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Kontakta Hans-Peter Rasmussen, ank 740 73 för bokning av samtal." +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Kontakta Leena Widén, sjukhusdiakon ank 802 90 eller Ingegärd Martinsson, sjukhuspräst, ank 802 93 för bokning av samtal." +
										"</DIV>" +
										"<BR>" +

										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stödsamtal hos Previa</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Du som medarbetare har rätt till upp till <i>två</i> besök hos beteendevetare/psykolog, därefter skall ytterligare besök sanktioneras av ansvarig chef." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B> <SPAN STYLE=\"color:#CC0000;\">Om ej någon av de 3 ovan samt om 3 el. 4 på någon av 47-52 + ja på 53 (depression)</SPAN>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården.");
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-16.45" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									for(int i=0; i<5; i++)
									{
										string h = "";
										int a = 0;
										switch(i)
										{
											case 0: h = "Bra"; a = 310; break;
											case 1: h = "Ganska bra"; a = 311; break;
											case 2: h = "Varken är bra eller dålig"; a = 312; break;
											case 3: h = "Ganska dålig"; a = 313; break;
											case 4: h = "Dålig"; a = 314; break;
										}
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B> <B STYLE=\"color:#CC0000;\">= " + h + "</B>" +
											"<BR>" +
											"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
											"<BR><BR>");

										//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										switch(a)
										{
											case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
											case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
											case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
											case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
											case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
										}
									}
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">&quot;Hur sover du egentligen?&quot;</B> <B STYLE=\"color:#CC0000;\">Om Sömn = Varken är bra eller dålig, Ganska dålig, Dålig</B>" +
										"<BR><BR>" +
										"Tillhör du den kategorin som räknar får på natten så ska du komma på denna föreläsning. Vad är sömn egentligen? När ska man ta tupplurar?  Är det bra att räkna får? Du kommer få kunskap om hur vår sömncykel fungerar och få tips och idéer på vad du själv kan göra för att förbättra din sömn." +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Tisdagen den 9/9, kl 14:00-15:30, Thoraxaulan" +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Onsdagen den 4/9, kl 14:00-15:30, R 64" +
										"<BR><BR>" +
										"<B>Föreläsare</B>: Mariette Weideskog, Hälsopedagog, Sektionen för arbetsmiljö och hälsa, HR-avdelningen " +
										"<BR><BR>" +
										"Du behöver inte anmäla dig till föreläsningen, det är bara att komma. Du får gå på arbetstid och förutsätter medgivande från din närmsta chef." +
										"</DIV>");
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									for(int i=0; i<5; i++)
									{
										string h = "";
										int a = 0;
										switch(i)
										{
											case 0: h = "Bra"; a = 310; break;
											case 1: h = "Ganska bra"; a = 311; break;
											case 2: h = "Varken är bra eller dålig"; a = 315; break;
											case 3: h = "Ganska dålig"; a = 316; break;
											case 4: h = "Dålig"; a = 317; break;
										}
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B> <B STYLE=\"color:#CC0000;\">= " + h + "</B>" +
											"<BR>" +
											"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
											"<BR><BR>");

										//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										switch(a)
										{
											case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
											case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
											case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
										}
									}
								}
								#endregion

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är XX,X</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								#region Findrisk
								int Qscore = 0;
								for(int i=0; i<5; i++)
								{
									switch(i)
									{
										case 0: Qscore = 0; break;
										case 1: Qscore = 7; break;
										case 2: Qscore = 12; break;
										case 3: Qscore = 15; break;
										case 4: Qscore = 21; break;
									}
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B> <B STYLE=\"color:#CC0000;\">Ej diabetes diagnos, Findrisk score = " + Qscore + "</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
								}
								FB.Append("<BR><BR><B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos)</B><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");

								if(Qscore >= 12)
								{
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Individuell träningsrådgivning</B> <B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos, Findrisk score >= 12)</B>" +
										"<BR><BR>" +
										"Som anställd på Karolinska erbjuds du hjälp med individuell träningsrådgivning. Det kan vara att få en styrketränings introduktion i vårt personalgym, hjälp med rörlighets- eller konditionsträning, stretchövningar m.m. Allt efter dina behov." +
										"<BR><BR>" +
										"För bokning av träningsrådgivning i <B>Solna</B>" +
										"<BR>" +
										"Tomas Hernvall, Friskvårdskonsulent/Gymföreståndare, HR-avdelningen, ank 757 10." +
										"<BR><BR>" +
										"För bokning av träningsrådgivning i <B>Huddinge</B>" +
										"<BR>" +
										"Marie Hammarström, Friskvårdskonsulent/Gymföreståndare, HR-avdelningen, ank 868 42." +
										"<BR><BR>" +
										"Du får gå på träningsrådgivningen på arbetstid och förutsätter medgivande av din närmsta chef." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">&quot;Kost, Rörelse, Hälsa&quot;</B> <B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos, Findrisk score >= 12)</B>" +
										"<BR><BR>" +
										"Vill du lära dig mer om kost och motion? Hur påverkar kosten och rörelsen ditt välbefinnande och din hälsa? Börjar favoritbyxorna sitta lite tight i midjan?  Nu har du chansen att på ett bra sätt hitta en hälsosam vikt och få bra vanor genom att lära dig mer om kostens och rörelsens betydelse." +
										"<BR><BR>" +
										"Kursen består av 9 gruppträffar á 1 timme. På träffarna kommer vi bland annat att diskutera våra mat- och motionsvanor och beteenden. Inom kosten kommer vi bland annat att prata om våra energikällor, måltidssammansättning, fettkällor samt kosttrender. Du kommer inte att följa någon diet, utan tanken är att du ska lära dig så mycket om kost så att du kan sätta samman en bra måltid själv. Fysisk aktivitet och rörelse är en viktig grundpelare i en hälsosam livsstil och en hjälp till att få energibalans och därmed en hälsosam vikt. Vi kommer bland annat att prata om positiva effekter av fysisk aktivitet och praktisera detta på ett enklare sätt. Hur lite kan du &quot;komma undan med&quot;?" +
										"<BR><BR>" +
										"Vid varje kurstillfälle har samtliga möjlighet att väga sig." +
										"<BR><BR>" +
										"<B>Datum, Tid & Lokal</B>" +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Torsdagar, kl 11:00-12:00, start vecka 37. AGA-salen i Eugeniahemmet vid samtliga tillfällen förutom den 9/10 då vi träffas i lilla salen, ALB." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Torsdagar, kl 14:00-15:00, start vecka 37. Konferensrum 2, HR-avdelningen CI 77." +
										"<BR><BR>" +
										"<B>Kursledare</B>" +
										"<BR>" +
										"Hälsopedagog från HR-avdelningen." +
										"<BR><BR>" +
										"<B>Kostnad</B>" +
										"<BR>" +
										"Kursen är avgiftsfri och sker på arbetstid och förutsätter medgivande från din närmsta chef." +
										"<BR><BR>" +
										"<B>Anmälan</B>" +
										"<BR>" +
										"Anmälan görs på <A HREF=\"http://inuti.karolinska.se/templates/form____95536.aspx\" TARGET=\"_blank\">http://inuti.karolinska.se/KI-LIME kursanmälan</A>, senast den 17/8. Har ni frågor om kursverksamheten kan ni ringa till Charlotte Ovefelt, 585 894 82." +
										"</DIV>");
								}
								#endregion

								#region Bra värden
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Friskvård</B> <SPAN STYLE=\"color:#CC0000\">(om bra hälsa, sover bra, ingen diabetesrisk)</SPAN><BR>Du är välkommen att delta i friskvårdens vanliga utbud. Klicka på länken för mer information:<BR><A HREF=\"http://inuti.karolinskauniversitetssjukhuset.se/templates/Page____8345.aspx\" TARGET=\"_blank\">http://inuti.karolinskauniversitetssjukhuset.se/templates/Page____8345.aspx</A>");
								#endregion
								
								#endregion
								
								SurveyIntro.Text += FB.ToString();
							}
							#endregion
						}
						else if(surveyID == 85 || surveyID == 86)
						{
							#region KS 2009

							showPDF = false;

							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Du rekommenderas att kontakta personalsjukgymnast.");
		
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sjukgymnastik</B>" +
										"<BR><BR>" +
										"Som en del av det förebyggande hälso- och arbetsmiljöarbetet finns det sjukgymnaster som arbetar med belastnings- och stressrelaterade besvär hos de anställda, både i Huddinge och i Solna. Syftet är att kunna göra en tidig insats vid arbetsrelaterade besvär." +
										"<BR><BR>" +
										"Du har möjlighet att få hjälp av en sjukgymnast om du har drabbats av smärta eller led-, rygg- eller muskelbesvär. Vi erbjuder en sjukgymnastisk bedömning, behandling och uppföljning. Du kan erbjudas olika former av friskvårdsträning alternativt remitteras till en annan vårdgivare." +
										"<BR><BR>" +
										"Sjukgymnasterna arbetar på uppdrag av HR-avdelningen." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Susanne Sandström och Ulf Molin, Leg sjukgymnast, 585 818 26." +
										"<BR>" +
										"Sjukgymnastikkliniken, R 41" +
										"<BR>" +
										"Telefontid: måndag kl. 12:30-13:30, torsdag kl. 09:45-10:45." +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Ulla Oxelbeck, Leg sjukgymnast, 517 727 55." +
										"<BR>" +
										"Sjukgymnastiken, huvudbyggnaden, gå in i huvudentrén, gå rakt fram och ta hissarna efter cafeterian, 1 tr ner (U1)." +
										"</DIV>");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sluta röka eller snusa med hjälp av Internet och e-post</B>" +
										"<BR><BR>" +
										"Ni kommer att på egen hand arbeta med materialet &quot;Sluta nu&quot;, vilket Cancerfonden, Folkhälsoinstitutet, Hjärt- och Lungfonden samt Läkare mot tobak står bakom." +
										"<BR><BR>" +
										"Varje vecka får du ett veckobrev av oss med instruktioner och uppgifter. Mellan veckobreven arbetar du med den internetbaserade sluta-röka/snusa skolan på internet själv. Du kan när som helst få stöd av oss via e-post. Du kommer under den första hälften av kursen förbereda dig mentalt på att sluta röka eller snusa, samt få information om nikotinhjälpmedel. Fimpardatum sker efter några veckor. Efter &quot;fimpardatumet&quot; kommer du att lära dig vad som händer vid nikotinstoppet och hur du kan ta hand om dig själv." +
										"<BR><BR>" +
										"<B>Start</B>: 1/2" +
										"<BR>" +
										"<B>Anmälan</B>: senast 25/1" +
										"<BR><BR>" +
										"<B>Så här anmäler du dig till kursen</B>" +
										"<BR>" +
										"Anmälan görs till <A TARGET=\"_blank\" HREF=\"mailto:mariette.veideskog@karolinska.se?subject=Sluta röka/snusakurs\">mariette.veideskog@karolinska.se</A>." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Föreläsning<br>Den svåra konsten att sluta röka</B>" +
										"<BR><BR>" +
										"Har du någon gång funderat på att sluta röka? Det har de flesta som röker. Oavsett om du har funderat på att sluta eller ej är du välkommen på denna föreläsning." +
										"<BR><BR>" +
										"Vi kommer att diskutera de svårigheter vi får när vi försöker sluta röka, men också om olika möjligheter som kan underlätta beslutet och stoppet. Du får verktyg du kan använda dig av om och när du bestämt dig för att sluta." +
										"<BR><BR>" +
										"<B>Huddinge:</B>" +
										"<BR>" +
										"Onsdagen den 10/2, kl 14:00-15:30" +
										"<BR>" +
										"Lokal meddelas efter anmälan." +
										"<BR>" +
										"<BR>" +
										"<B>Solna:</B>" +
										"<BR>" +
										"Tisdagen den 16/2, kl 14:00-15:30" +
										"<BR>" +
										"Lokal meddelas efter anmälan." +
										"<BR>" +
										"<BR>" +
										"<B>Föreläsare:</B>" +
										"<BR>" +
										"Mariette Weideskog, Hälsopedagog, " +
										"<BR>" +
										"Sektionen för arbetsmiljö och hälsa, HR-avdelningen, Karolinska" +
										"<BR><BR>" +
										"Du får gå på arbetstid och förutsätter medgivande från din närmsta chef." +
										"<BR><BR>" +
										"Anmälan görs till <A TARGET=\"_blank\" HREF=\"mailto:mariette.veideskog@karolinska.se?subject=sluta röka föreläsning\">mariette.veideskog@karolinska.se</A>." +
										"</DIV>");
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR>" +
										"Mer information finns på vårdguiden: <A HREF=\"http://www.vardguiden.se/Tema/Alkohol\" TARGET=\"_blank\">http://www.vardguiden.se/Tema/Alkohol</A>." +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider är måndag-torsdag kl 12:00-19:00 och fredag kl 12:00-17:00." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Previa</B>" +
										"<BR><BR>" +
										"Kontakta företagssköterskan för rådgivning i alkohol- och drogfrågor." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-15.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. " +
											"Är dina problem arbetsrelaterade kan du kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder. " +
											"Är dina problem arbetsrelaterade kan du kontakta Previa, företagshälsovården." +
											"<BR><BR>");
									}

									#region Föreläsningsserie om stress & stresshantering
									FB.Append("<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Föreläsningsserie om stress & stresshantering</B>" +
										"<BR><BR>" +
										"Under tre föreläsningar kommer vi att prata om är vad stress är, vad som sker i kroppen vid pressade situationer och vad det ger för symptom. Att bli medveten om sin egen kropps signaler/symptom är första steget i stresshantering. Du kommer att få tid att fundera över vad du själv får för symptom, samt vilka situationer som är pressande för dig." +
										"<BR><BR>" +
										"Ni kommer få en del tips om olika former av copingstrategier, dvs. hur ni kan lära er att hantera er stress. Vi kommer att varva teori med olika övningar kring stress och prova på olika typer av avspänningsövningar/stressreducerande övningar. Vi kommer också att diskutera tankens kraft." +
										"<BR><BR>" +
										"Föreläsningsserien består av tre tillfällen, det är av största vikt att du medverkar vid samtliga tre tillfällen. Alla tillfällen bygger på aktiv medverkan. Mellan föreläsningarna arbetar du på egen hand med hemuppgifter." +
										"<BR><BR>" +
										"<B>Solna</B><BR>" +
										"Torsdagen den 4/2, kl 14:00-15:30<BR>" +
										"Torsdagen den 18/2, kl 14:00-15:30<BR>" +
										"Tordagen den 4/3, kl 14:00-15:30<BR>" +
										"<BR><BR>" +
										"<B>Huddinge</B><BR>" +
										"Onsdagen den 3/2, kl 14:00-15:30<BR>" +
										"Onsdagen den 17/2, kl 14:00-15:30<BR>" +
										"Onsdagen den 3/3, kl 14:00-15:30<BR>" +
										"<BR>" +
										"Lokal meddelas efter anmälan<BR><BR>" +
										"Anmäl dig till Huddinge eller Solna, senast den 28/1. Anmälan görs till <A HREF=\"mailto:mariette.veideskog@karolinska.se?subject=föreläsningsserie om stress\">mariette.veideskog@karolinska.se</A>" +
										"</DIV>" +
										"<BR>");
									#endregion

									#region Enskilda samtal
									FB.Append("<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Enskilda samtal</B>" +
										"<BR><BR>" +
										"Vi som arbetar i Sjukhuskyrkan har lång erfarenhet av att möta människor i sorg och kris. Att lyssna och tala om det riktigt svåra är en av våra allra viktigaste uppgifter. Syftet med samtalen är att stödja och hjälpa, ge hopp och mod. Samtalen kan ske vid ett eller flera tillfällen." +
										"<BR><BR>" +
										"Sjukhuskyrkans enskilda samtal erbjuds alla, oavsett tro och livsåskådning. Många av dem vi träffar har i vanliga fall ingen anknytning till kyrkan." +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Kontakta Hans-Peter Rasmussen, ank 740 73 för bokning av samtal." +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Kontakta Ingegärd Martinsson, sjukhuspräst, ank 802 93 för bokning av samtal." +
										"</DIV>" +
										"<BR>");
									#endregion

									#region Stödsamtal
									FB.Append("<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stödsamtal hos Previa</B>" +
										"<BR><BR>" +
										"Du som medarbetare har rätt till upp till <i>två</i> besök hos beteendevetare/psykolog, därefter skall ytterligare besök sanktioneras av ansvarig chef." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-15.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
									#endregion
								}
								else if(Qdepr)
								{
									#region Previa
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
										"<BR><BR>" +
										"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-15.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
									#endregion
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									bool QsleepI = false, QpreviaI = false;

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
										case 312: QsleepI = true; FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
										case 314: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
									}
									if(QsleepI || QpreviaI)
									{
										FB.Append("<BR>");
										if(QsleepI)
										{
											FB.Append("<BR>" +
												"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
												"<B STYLE=\"font-size:16px;\">Föreläsning<BR>&quot;Hur sover du egentligen?&quot;</B>" +
												"<BR><BR>" +
												"Tillhör du den kategorin som räknar får på natten så ska du komma på denna föreläsning. Hur ser en normal sömn ut?  Är det bra med  tupplurar?  Är det bra att räkna får? Du kommer få kunskap om hur vår sömncykel fungerar och få tips och idéer på vad du själv kan göra för att förbättra din sömn." +
												"<BR><BR>" +
												"<B>Solna</B>:" +
												"<BR>" +
												"Torsdagen den 28/1, kl 14:00-15:30" +
												"<BR><BR>" +
												"<B>Huddinge</B>:" +
												"<BR>" +
												"Onsdagen den 27/1, kl 14:00-15:30" +
												"<BR><BR>" +
												"<B>Föreläsare</B>: Mariette Weideskog, Hälsopedagog, HR-avdelningen" +
												"<BR><BR>" +
												"Du får gå på arbetstid och förutsätter medgivande från din närmsta chef.<BR>" +
												"Anmälan görs till <A HREF=\"mailto:mariette.veideskog@karolinska.se?subject=Sömnföreläsning\">mariette.veideskog@karolinska.se</A><BR>" +
												"Lokal meddelas efter anmälan." +
												"</DIV>");
										}
										if(1==0 && QpreviaI)
										{
											FB.Append("<BR>" +
												"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
												"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
												"<BR><BR>" +
												"För dig som arbetar på Karolinska, Solna:" +
												"<BR>" +
												"<B>Previa Haga</B>" +
												"<BR>" +
												"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-15.00 för rådgivning och tidbokning 08-728 51 55" +
												"<BR>" +
												"Öppet:	Mån-fre 08.00-17.00" +
												"<BR>" +
												"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
												"<BR>" +
												"Tfn vxl: 08-728 51 40" +
												"<BR><BR>" +
												"För dig som arbetar på Karolinska, Huddinge:" +
												"<BR>" +
												"<B>Previa Huddinge</B>" +
												"<BR>" +
												"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
												"<BR>" +
												"Öppet: Mån-fre 08.00-17.00" +
												"<BR>" +
												"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
												"<BR>" +
												"Tfn vxl: 08-608 63 80" +
												"<BR><BR>" +
												"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
												"<BR>" +
												"<B>Previa Gullmarsplan</B>" +
												"<BR>" +
												"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
												"<BR>" +
												"Öppet: Mån-fre 08.00-17.00" +
												"<BR>" +
												"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
												"<BR>" +
												"Tfn vxl: 08 - 722 24 00" +
												"</DIV>");
										}
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									bool QpreviaI = false;

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: QpreviaI = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
										case 317: QpreviaI = true; FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
									}
									if(1==0 && QpreviaI)
									{
										FB.Append("<BR><BR>" +
											"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
											"<BR><BR>" +
											"För dig som arbetar på Karolinska, Solna:" +
											"<BR>" +
											"<B>Previa Haga</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-12.00 samt 15.00-16.00 för rådgivning och tidbokning 08-728 51 55" +
											"<BR>" +
											"Öppet:	Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
											"<BR>" +
											"Tfn vxl: 08-728 51 40" +
											"<BR><BR>" +
											"För dig som arbetar på Karolinska, Huddinge:" +
											"<BR>" +
											"<B>Previa Huddinge</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
											"<BR>" +
											"Öppet: Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
											"<BR>" +
											"Tfn vxl: 08-608 63 80" +
											"<BR><BR>" +
											"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
											"<BR>" +
											"<B>Previa Gullmarsplan</B>" +
											"<BR>" +
											"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
											"<BR>" +
											"Öppet: Mån-fre 08.00-16.45" +
											"<BR>" +
											"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
											"<BR>" +
											"Tfn vxl: 08 - 722 24 00" +
											"</DIV>");
									}

								}
								#endregion


								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");

									if(Qscore >= 12)
									{
										FB.Append("<BR><BR>" +
											"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">Individuell träningsrådgivning</B>" +
											"<BR><BR>" +
											"Som anställd på Karolinska erbjuds du hjälp med individuell träningsrådgivning.  Det kan vara att få en styrketräningsintroduktion i vårt personalgym, hjälp med rörlighets- eller konditionsträning, stretchövningar, hemträningsprogram m.m.  Allt efter dina behov." +
											"<BR><BR>" +
											"<B>Solna</B>" +
											"<BR>" +
											"För bokning av träningsrådgivning kontakta: Tomas Hernvall, Friskvårdskonsulent/Gymföreståndare, HR-avdelningen, ank 757 10." +
											"<BR><BR>" +
											"<B>Huddinge</B>" +
											"<BR>" +
											"För bokning av träningsrådgivning kontakta Marie Hammarström, friskvårdskonsulent/Gymföreståndare, HR-avdelningen, ank 868 42." +
											"<BR><BR>" +
											"Du får gå på träningsrådgivningen på arbetstid och förutsätter medgivande av din närmsta chef." +
											"</DIV>" +
											"<BR>" +
											"<DIV STYLE=\"page-break-inside:avoid;background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
											"<B STYLE=\"font-size:16px;\">&quot;Kost, Rörelse, Hälsa&quot;</B>" +
											"<BR><BR>" +
											"Vill du lära dig mer om kost och motion? Hur påverkar kosten och rörelsen ditt välbefinnande och din hälsa? Börjar favoritbyxorna sitta lite tight i midjan?  Nu har du chansen att på ett bra sätt hitta en hälsosam vikt och få bra vanor genom att lära dig mer om kostens och rörelsens betydelse." +
											"<BR><BR>" +
											"Kursen består av 8 gruppträffar och en timme vid varje tillfälle. På träffarna kommer vi bland annat att diskutera våra mat- och motionsvanor, samt beteenden. Inom kosten kommer vi bland annat att prata om våra energikällor, måltidssammansättning, fettkällor samt kosttrender. Du kommer inte att följa någon diet, utan tanken är att du ska lära dig så mycket om kost så att du kan sätta samman en bra måltid själv. Fysisk aktivitet och rörelse är en viktig grundpelare i en hälsosam livsstil och en hjälp till att få energibalans och därmed en hälsosam vikt. Vi kommer bland annat att prata om positiva effekter av fysisk aktivitet och praktisera detta på ett enklare sätt. Hur lite kan du &quot;komma undan med&quot;?" +
											"<BR><BR>" +
											"Vid varje kurstillfälle har samtliga möjlighet att väga sig." +
											"<BR><BR>" +
											"<B>Datum, Tid & Lokal</B>" +
											"<BR><BR>" +
											"<B>Solna</B>" +
											"<BR>" +
											"Måndagar, kl 14:30-15:30, start vecka 6. Lokal: meddelas efter anmälan." +
											"<BR><BR>" +
											"<B>Huddinge</B>" +
											"<BR>" +
											"Måndagar, kl 11:00-12:00, start vecka 6. Lokal: meddelas efter anmälan." +
											"<BR><BR>" +
											"<B>Kursledare</B>" +
											"<BR>" +
											"Henrik Tangen, Hälsopedagog, HR-avdelningen." +
											"<BR><BR>" +
											"Kursen är avgiftsfri och sker på arbetstid och förutsätter medgivande från din närmsta chef." +
											"<BR><BR>" +
											"<B>Anmälan</B>" +
											"<BR>" +
											"Anmälan görs på senast den 29/1 till <A HREF=\"mailto:mariette.veideskog@karolinska.se?subject=Kost och rörelsekurs\">mariette.veideskog@karolinska.se</A>." +
											"</DIV>");
									}
								}
								#endregion

								if(!Qalco && !Qdepr && !Qburnout && Qscore < 12)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Friskvård</B><BR>Du är välkommen att delta i friskvårdens vanliga utbud. Klicka på länken för mer information:<BR><A HREF=\"http://inuti.karolinska.se/templates/Page____100041.aspx\" TARGET=\"_blank\">http://inuti.karolinska.se/templates/Page____100041.aspx</A>");
								}

								#endregion

								string emailMsg = "Tack för din medverkan i chefsstudien KI-LIME!" +
									"\r\n\r\n" +
									"Gör så här för att få din personliga återkoppling:" +
									"\r\n\r\n" +
									"1. Gå in på http://www.webbqps.se" +
									"\r\n" +
									"2. Klicka på \"För projektdeltagare\"" +
									"\r\n" +
									"3. Skriv din e-postadress i rutan och klicka på \"Skicka\"" +
									"\r\n" +
									"4. Länken till din återkoppling skickas till din e-postadress" +
									"\r\n\r\n" +
									"Du får då också vid behov erbjudanden om hälsofrämjande aktiviteter, t ex föreläsningar om stress, kost- och rörelsekurs, sluta röka-kurs eller föreläsningar om sömn." +
									"\r\n\r\n" +
									"Tänk på att avsätta lite tid för att gå igenom dina resultat. Det är inte säkert att du hinner läsa allt på en gång just nu.";

								int previous = 0;
								rs = Db.sqlRecordSet("SELECT " +
									"TOP 1 a.AnswerID " +
									"FROM ProjectRoundUserCompare usr " +
									"INNER JOIN Answer a ON usr.CompareProjectRoundUserID = a.ProjectRoundUserID AND a.EndDT IS NOT NULL " +
									"WHERE usr.ProjectRoundUserID = " + projectRoundUserID);
								if(rs.Read())
								{
									previous = rs.GetInt32(0);
								}
								rs.Close();

								try
								{
									rs = Db.sqlRecordSet("SELECT usr.Email, pr.EmailFromAddress " +
										"FROM ProjectRoundUser usr " +
										"INNER JOIN ProjectRoundUnit pru ON usr.ProjectRoundUnitID = pru.ProjectRoundUnitID " +
										"INNER JOIN ProjectRound pr ON pru.ProjectRoundID = pr.ProjectRoundID " +
										"WHERE usr.ProjectRoundUserID = " + projectRoundUserID);
									if(rs.Read())
									{
										System.Web.Mail.MailMessage msg = new System.Web.Mail.MailMessage();
										msg.To = rs.GetString(0);
										msg.From = rs.GetString(1);
										msg.Subject = "Personlig återkoppling på årets webbenkät";
										msg.Body = emailMsg;
										msg.BodyFormat = System.Web.Mail.MailFormat.Text;
										msg.BodyEncoding = System.Text.Encoding.GetEncoding(1252);
										System.Web.Mail.SmtpMail.SmtpServer = System.Configuration.ConfigurationSettings.AppSettings["SmtpServer"];
										System.Web.Mail.SmtpMail.Send(msg);
									}
									rs.Close();
								}
								catch(Exception) {}

								FB.Append("<div style=\"page-break-before:always\">&nbsp;</div>");
								FB.Append(feedback.renderFeedback(1,surveyID,"Karolinska 2008","Karolinska 2008, kliniska enheter",30,"",true,previous,answerID,"Ditt svar 2008","Ditt svar 2009","FFFFFF"));

								SurveyIntro.Text += emailMsg.Replace("\r\n","<br>");
							}
							else
							{
								#region webbqps annotated
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = true;
								bool Qneck = true;
								bool QbnSleep = true;
								bool QbnWork = true;
								bool QbnWorse = true;
								if(Qback || Qneck)
								{
									for(int i1=0; i1<2; i1++)
									{
										Qback = !Qback;
										for(int i2=0; i2<2; i2++)
										{
											Qneck = !Qneck;
											for(int i3=0; i3<2; i3++)
											{
												QbnSleep = !QbnSleep;
												for(int i4=0; i4<2; i4++)
												{
													QbnWork = !QbnWork;
													for(int i5=0; i5<2; i5++)
													{
														QbnWorse = !QbnWorse;

														if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
														{

															FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
															if(Qback)
															{
																FB.Append("Rygg <SPAN STYLE=\"color:#CC0000\">(om rygg)</SPAN>");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("Nacke <SPAN STYLE=\"color:#CC0000\">(om nacke)</SPAN>");
															}
															FB.Append("</B><BR>Du har angivit att du har besvär från ");
															if(Qback)
															{
																FB.Append("ryggen <SPAN STYLE=\"color:#CC0000\">(om rygg)</SPAN>");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("nacken <SPAN STYLE=\"color:#CC0000\">(om nacke)</SPAN>");
															}
															FB.Append(" samt att dessa besvär ");
															if(QbnWorse)
															{
																FB.Append("förvärras av arbetet <SPAN STYLE=\"color:#CC0000\">(om förvärras arbetet)</SPAN>");
																if(QbnSleep || QbnWork)
																{
																	FB.Append(" och att besvären ");
																}
															}
															if(QbnSleep || QbnWork)
															{
																FB.Append("varit så pass svåra att du haft svårt ");
																if(QbnSleep)
																{
																	FB.Append("att sova <SPAN STYLE=\"color:#CC0000\">(svårt sova)</SPAN>");
																	if(QbnWork)
																	{
																		FB.Append(" och ");
																	}
																}
																if(QbnWork)
																{
																	FB.Append("utföra ditt arbete <SPAN STYLE=\"color:#CC0000\">(svårt utföra arbete)</SPAN>");
																}
															}
															FB.Append(". Du rekommenderas att kontakta personalsjukgymnast.");
														}
													}
												}
											}
										}
									}
	
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sjukgymnastik</B> <SPAN STYLE=\"color:#CC0000\">(om rygg eller nacke)</SPAN>" +
										"<BR><BR>" +
										"Som en del av det förebyggande hälso- och arbetsmiljöarbetet finns det sjukgymnaster som arbetar med belastnings- och stressrelaterade besvär hos de anställda, både i Huddinge och i Solna. Syftet är att kunna göra en tidig insats vid arbetsrelaterade besvär." +
										"<BR><BR>" +
										"Du har möjlighet att få hjälp av en sjukgymnast om du har drabbats av smärta eller led-, rygg- eller muskelbesvär. Vi erbjuder en sjukgymnastisk bedömning, behandling och uppföljning. Du kan erbjudas olika former av friskvårdsträning alternativt remitteras till en annan vårdgivare." +
										"<BR><BR>" +
										"Sjukgymnasterna arbetar på uppdrag av HR-avdelningen." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Susanne Sandström och Ulf Molin, Leg sjukgymnast, 585 818 26." +
										"<BR>" +
										"Sjukgymnastikkliniken, R 41" +
										"<BR>" +
										"Telefontid: måndag kl. 12:30-13:30, torsdag kl. 09:45-10:45." +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Ulla Oxelbeck, Leg sjukgymnast, 517 727 55." +
										"<BR>" +
										"Sjukgymnastiken, huvudbyggnaden, gå in i huvudentrén, gå rakt fram och ta hissarna efter cafeterian, 1 tr ner (U1)." +
										"</DIV>");
								}
								#endregion

								#region Smoke/Hosta/Pip

								if(1==1)
								{
									if(1==1)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(1==1)
										{
											FB.Append("Långvarig hosta <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om hosta)</SPAN>");
											if(1==1)
											{
												FB.Append(" och ");
											}
										}
										if(1==1)
										{
											FB.Append("Pip i bröstet <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om pip)</SPAN>");
										}
										FB.Append("</B> <B STYLE=\"color:#CC0000;\">+ Om röker</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									if(1==1)
									{
										FB.Append("<BR>");
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B> <B STYLE=\"color:#CC0000;\">Om röker, ej hosta ej pip</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka, kan du få det genom arbetsplatsen.");
									}
									FB.Append("" +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Sluta röka eller snusa med hjälp av Internet och e-post</B> <B STYLE=\"color:#CC0000;\">Om röker</B>" +
										"<BR><BR>" +
										"Ni kommer att på egen hand arbeta med materialet &quot;Sluta nu&quot;, vilket Cancerfonden, Folkhälsoinstitutet, Hjärt- och Lungfonden samt Läkare mot tobak står bakom." +
										"<BR><BR>" +
										"Varje vecka får du ett veckobrev av oss med instruktioner och uppgifter. Mellan veckobreven arbetar du med den internetbaserade sluta-röka/snusa skolan på internet själv. Du kan när som helst få stöd av oss via e-post. Du kommer under den första hälften av kursen förbereda dig mentalt på att sluta röka eller snusa, samt få information om nikotinhjälpmedel. Fimpardatum sker efter några veckor. Efter &quot;fimpardatumet&quot; kommer du att lära dig vad som händer vid nikotinstoppet och hur du kan ta hand om dig själv." +
										"<BR><BR>" +
										"<B>Start</B>: 1/2" +
										"<BR>" +
										"<B>Anmälan</B>: senast 25/1" +
										"<BR><BR>" +
										"<B>Så här anmäler du dig till kursen</B>" +
										"<BR>" +
										"Anmälan görs till <A TARGET=\"_blank\" HREF=\"mailto:mariette.veideskog@karolinska.se?subject=Sluta röka/snusakurs\">mariette.veideskog@karolinska.se</A>." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:14px;\">Föreläsning<br>Den svåra konsten att sluta röka</B> <B STYLE=\"color:#CC0000;\">Om röker</B>" +
										"<BR><BR>" +
										"Har du någon gång funderat på att sluta röka? Det har de flesta som röker. Oavsett om du har funderat på att sluta eller ej är du välkommen på denna föreläsning." +
										"<BR><BR>" +
										"Vi kommer att diskutera de svårigheter vi får när vi försöker sluta röka, men också om olika möjligheter som kan underlätta beslutet och stoppet. Du får verktyg du kan använda dig av om och när du bestämt dig för att sluta." +
										"<BR><BR>" +
										"<B>Huddinge:</B>" +
										"<BR>" +
										"Onsdagen den 10/2, kl 14:00-15:30" +
										"<BR>" +
										"Lokal meddelas efter anmälan." +
										"<BR>" +
										"<BR>" +
										"<B>Solna:</B>" +
										"<BR>" +
										"Tisdagen den 16/2, kl 14:00-15:30" +
										"<BR>" +
										"Lokal meddelas efter anmälan." +
										"<BR>" +
										"<BR>" +
										"<B>Föreläsare:</B>" +
										"<BR>" +
										"Mariette Weideskog, Hälsopedagog, " +
										"<BR>" +
										"Sektionen för arbetsmiljö och hälsa, HR-avdelningen, Karolinska" +
										"<BR><BR>" +
										"Du får gå på arbetstid och förutsätter medgivande från din närmsta chef." +
										"<BR><BR>" +
										"Anmälan görs till <A TARGET=\"_blank\" HREF=\"mailto:mariette.veideskog@karolinska.se?subject=sluta röka föreläsning\">mariette.veideskog@karolinska.se</A>." +
										"</DIV>");
								}
								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(1==1)
									{
										FB.Append("Långvarig hosta <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om hosta)</SPAN>");
										if(1==1)
										{
											FB.Append(" och ");
										}
									}
									if(1==1)
									{
										FB.Append("Pip i bröstet <SPAN STYLE=\"color:#CC0000;font-size:11px;\">(Om pip)</SPAN>");
									}
									FB.Append("</B> <B STYLE=\"color:#CC0000;\">+ Om EJ röker</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.<BR>");
								}
								#endregion

								#region Alkohol

								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B> <B STYLE=\"color:#CC0000;\">Om 2-3 ggr/v eller oftare på fråga 31 SAMT varje månad eller oftare på fråga 31a ELLER 31b ELLER Ja, senaste året på fråga 31c</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR>" +
										"Mer information finns på vårdguiden: <A HREF=\"http://www.vardguiden.se/Tema/Alkohol\" TARGET=\"_blank\">http://www.vardguiden.se/Tema/Alkohol</A>." +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider är måndag-torsdag kl 12:00-19:00 och fredag kl 12:00-17:00." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Previa</B>" +
										"<BR><BR>" +
										"Kontakta företagssköterskan för rådgivning i alkohol- och drogfrågor." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-15.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.00-12.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								if(1==1)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B> <SPAN STYLE=\"color:#CC0000;\">Om 3 el. 4 på någon av 47-52 + ja på 53 (depression) samt om medel > 2.6 på fråga 38,40,41,44,45 (utbränd)</SPAN>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården." +
										"<BR><BR>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B> <B STYLE=\"color:#CC0000;\">Om ej ovan samt medel > 2.6 på fråga 38,40,41,44,45 samt om medel > 3.25 på fråga 55-58</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder. " +
										"Är dina problem arbetsrelaterade kan du kontakta Previa, företagshälsovården." +
										"<BR><BR>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B> <B STYLE=\"color:#CC0000;\">Om ej någon av de 2 ovan men medel > 2.6 på fråga 38,40,41,44,45</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Man kan ha hjälp av olika metoder. " +
										"Är dina problem arbetsrelaterade kan du kontakta Previa, företagshälsovården.<BR><BR>");

									FB.Append("<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Föreläsningsserie om stress & stresshantering</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Under tre föreläsningar kommer vi att prata om är vad stress är, vad som sker i kroppen vid pressade situationer och vad det ger för symptom. Att bli medveten om sin egen kropps signaler/symptom är första steget i stresshantering. Du kommer att få tid att fundera över vad du själv får för symptom, samt vilka situationer som är pressande för dig." +
										"<BR><BR>" +
										"Ni kommer få en del tips om olika former av copingstrategier, dvs. hur ni kan lära er att hantera er stress. Vi kommer att varva teori med olika övningar kring stress och prova på olika typer av avspänningsövningar/stressreducerande övningar. Vi kommer också att diskutera tankens kraft." +
										"<BR><BR>" +
										"Föreläsningsserien består av tre tillfällen, det är av största vikt att du medverkar vid samtliga tre tillfällen. Alla tillfällen bygger på aktiv medverkan. Mellan föreläsningarna arbetar du på egen hand med hemuppgifter." +
										"<BR><BR>" +
										"<B>Solna</B><BR>" +
										"Torsdagen den 4/2, kl 14:00-15:30<BR>" +
										"Torsdagen den 18/2, kl 14:00-15:30<BR>" +
										"Tordagen den 4/3, kl 14:00-15:30<BR>" +
										"<BR><BR>" +
										"<B>Huddinge</B><BR>" +
										"Onsdagen den 3/2, kl 14:00-15:30<BR>" +
										"Onsdagen den 17/2, kl 14:00-15:30<BR>" +
										"Onsdagen den 3/3, kl 14:00-15:30<BR>" +
										"<BR>" +
										"Lokal meddelas efter anmälan<BR><BR>" +
										"Anmäl dig till Huddinge eller Solna, senast den 28/1. Anmälan görs till <A HREF=\"mailto:mariette.veideskog@karolinska.se?subject=föreläsningsserie om stress\">mariette.veideskog@karolinska.se</A>" +
										"</DIV>" +
										"<BR>" +

										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Enskilda samtal</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Vi som arbetar i Sjukhuskyrkan har lång erfarenhet av att möta människor i sorg och kris. Att lyssna och tala om det riktigt svåra är en av våra allra viktigaste uppgifter. Syftet med samtalen är att stödja och hjälpa, ge hopp och mod. Samtalen kan ske vid ett eller flera tillfällen." +
										"<BR><BR>" +
										"Sjukhuskyrkans enskilda samtal erbjuds alla, oavsett tro och livsåskådning. Många av dem vi träffar har i vanliga fall ingen anknytning till kyrkan." +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Kontakta Hans-Peter Rasmussen, ank 740 73 för bokning av samtal." +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Kontakta Ingegärd Martinsson, sjukhuspräst, ank 802 93 för bokning av samtal." +
										"</DIV>" +
										"<BR>" +

										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stödsamtal hos Previa</B> <B STYLE=\"color:#CC0000;\">Om någon av de 3 ovan</B>" +
										"<BR><BR>" +
										"Du som medarbetare har rätt till upp till <i>två</i> besök hos beteendevetare/psykolog, därefter skall ytterligare besök sanktioneras av ansvarig chef." +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-15.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Depression</B> <SPAN STYLE=\"color:#CC0000;\">Om ej någon av de 3 ovan samt om 3 el. 4 på någon av 47-52 + ja på 53 (depression)</SPAN>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare för en undersökning. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården.");
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Previa, företagshälsovården</B>" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Solna:" +
										"<BR>" +
										"<B>Previa Haga</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-15.00 för rådgivning och tidbokning 08-728 51 55" +
										"<BR>" +
										"Öppet:	Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gävlegatan 22, plan 6, 113 30 Stockholm" +
										"<BR>" +
										"Tfn vxl: 08-728 51 40" +
										"<BR><BR>" +
										"För dig som arbetar på Karolinska, Huddinge:" +
										"<BR>" +
										"<B>Previa Huddinge</B>" +
										"<BR>" +
										"Tfn tid: Mån-tors 09.00-12.00 och fre 10.0012.00 för rådgivning och tidbokning 08-608 63 90" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Patron Pehrs väg 4, 141 35 Huddinge" +
										"<BR>" +
										"Tfn vxl: 08-608 63 80" +
										"<BR><BR>" +
										"För dig som arbetar på Södersjukhuset och närbelägen vårdcentral:" +
										"<BR>" +
										"<B>Previa Gullmarsplan</B>" +
										"<BR>" +
										"Tfn tid: Mån-fre 09.00-11.00 samt 14.00-16.00 för rådgivning och tidbokning 08-722 24 01" +
										"<BR>" +
										"Öppet: Mån-fre 08.00-17.00" +
										"<BR>" +
										"Adress: Gullmarsplan 13, 121 40 Johanneshov" +
										"<BR>" +
										"Tfn vxl: 08 - 722 24 00" +
										"</DIV>");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									for(int i=0; i<5; i++)
									{
										string h = "";
										int a = 0;
										switch(i)
										{
											case 0: h = "Bra"; a = 310; break;
											case 1: h = "Ganska bra"; a = 311; break;
											case 2: h = "Varken är bra eller dålig"; a = 312; break;
											case 3: h = "Ganska dålig"; a = 313; break;
											case 4: h = "Dålig"; a = 314; break;
										}
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B> <B STYLE=\"color:#CC0000;\">= " + h + "</B>" +
											"<BR>" +
											"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
											"<BR><BR>");

										//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
										switch(a)
										{
											case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
											case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
											case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
											case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
											case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare. Är dina problem arbetsrelaterade kan du även kontakta Previa, företagshälsovården."); break;
										}
									}
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Föreläsning<BR>&quot;Hur sover du egentligen?&quot;</B> <B STYLE=\"color:#CC0000;\">Om Sömn = Varken är bra eller dålig, Ganska dålig, Dålig</B>" +
										"<BR><BR>" +
										"Tillhör du den kategorin som räknar får på natten så ska du komma på denna föreläsning. Hur ser en normal sömn ut?  Är det bra med  tupplurar?  Är det bra att räkna får? Du kommer få kunskap om hur vår sömncykel fungerar och få tips och idéer på vad du själv kan göra för att förbättra din sömn." +
										"<BR><BR>" +
										"<B>Solna</B>:" +
										"<BR>" +
										"Torsdagen den 28/1, kl 14:00-15:30" +
										"<BR><BR>" +
										"<B>Huddinge</B>:" +
										"<BR>" +
										"Onsdagen den 27/1, kl 14:00-15:30" +
										"<BR><BR>" +
										"<B>Föreläsare</B>: Mariette Weideskog, Hälsopedagog, HR-avdelningen" +
										"<BR><BR>" +
										"Du får gå på arbetstid och förutsätter medgivande från din närmsta chef.<BR>" +
										"Anmälan görs till <A HREF=\"mailto:mariette.veideskog@karolinska.se?subject=Sömnföreläsning\">mariette.veideskog@karolinska.se</A><BR>" +
										"Lokal meddelas efter anmälan." +
										"</DIV>");
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									for(int i=0; i<5; i++)
									{
										string h = "";
										int a = 0;
										switch(i)
										{
											case 0: h = "Bra"; a = 310; break;
											case 1: h = "Ganska bra"; a = 311; break;
											case 2: h = "Varken är bra eller dålig"; a = 315; break;
											case 3: h = "Ganska dålig"; a = 316; break;
											case 4: h = "Dålig"; a = 317; break;
										}
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B> <B STYLE=\"color:#CC0000;\">= " + h + "</B>" +
											"<BR>" +
											"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
											"<BR><BR>");

										//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
										switch(a)
										{
											case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
											case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
											case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
											case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det. Är dina problem arbetsrelaterade kan du även kontakta företagshälsovården, Previa."); break;
										}
									}
								}
								#endregion

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är XX,X</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								#region Findrisk
								int Qscore = 0;
								for(int i=0; i<5; i++)
								{
									switch(i)
									{
										case 0: Qscore = 0; break;
										case 1: Qscore = 7; break;
										case 2: Qscore = 12; break;
										case 3: Qscore = 15; break;
										case 4: Qscore = 21; break;
									}
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B> <B STYLE=\"color:#CC0000;\">Ej diabetes diagnos, Findrisk score = " + Qscore + "</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du deltar i något av eller båda alternativen nedan samt kontaktar din husläkare för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
								}
								FB.Append("<BR><BR><B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos)</B><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");

								if(Qscore >= 12)
								{
									FB.Append("<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Individuell träningsrådgivning</B> <B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos, Findrisk score >= 12)</B>" +
										"<BR><BR>" +
										"Som anställd på Karolinska erbjuds du hjälp med individuell träningsrådgivning.  Det kan vara att få en styrketräningsintroduktion i vårt personalgym, hjälp med rörlighets- eller konditionsträning, stretchövningar, hemträningsprogram m.m.  Allt efter dina behov." +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"För bokning av träningsrådgivning kontakta: Tomas Hernvall, Friskvårdskonsulent/Gymföreståndare, HR-avdelningen, ank 757 10." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"För bokning av träningsrådgivning kontakta Marie Hammarström, friskvårdskonsulent/Gymföreståndare, HR-avdelningen, ank 868 42." +
										"<BR><BR>" +
										"Du får gå på träningsrådgivningen på arbetstid och förutsätter medgivande av din närmsta chef." +
										"</DIV>" +
										"<BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">&quot;Kost, Rörelse, Hälsa&quot;</B> <B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos, Findrisk score >= 12)</B>" +
										"<BR><BR>" +
										"Vill du lära dig mer om kost och motion? Hur påverkar kosten och rörelsen ditt välbefinnande och din hälsa? Börjar favoritbyxorna sitta lite tight i midjan?  Nu har du chansen att på ett bra sätt hitta en hälsosam vikt och få bra vanor genom att lära dig mer om kostens och rörelsens betydelse." +
										"<BR><BR>" +
										"Kursen består av 8 gruppträffar och en timme vid varje tillfälle. På träffarna kommer vi bland annat att diskutera våra mat- och motionsvanor, samt beteenden. Inom kosten kommer vi bland annat att prata om våra energikällor, måltidssammansättning, fettkällor samt kosttrender. Du kommer inte att följa någon diet, utan tanken är att du ska lära dig så mycket om kost så att du kan sätta samman en bra måltid själv. Fysisk aktivitet och rörelse är en viktig grundpelare i en hälsosam livsstil och en hjälp till att få energibalans och därmed en hälsosam vikt. Vi kommer bland annat att prata om positiva effekter av fysisk aktivitet och praktisera detta på ett enklare sätt. Hur lite kan du &quot;komma undan med&quot;?" +
										"<BR><BR>" +
										"Vid varje kurstillfälle har samtliga möjlighet att väga sig." +
										"<BR><BR>" +
										"<B>Datum, Tid & Lokal</B>" +
										"<BR><BR>" +
										"<B>Solna</B>" +
										"<BR>" +
										"Måndagar, kl 14:30-15:30, start vecka 6. Lokal: meddelas efter anmälan." +
										"<BR><BR>" +
										"<B>Huddinge</B>" +
										"<BR>" +
										"Måndagar, kl 11:00-12:00, start vecka 6. Lokal: meddelas efter anmälan." +
										"<BR><BR>" +
										"<B>Kursledare</B>" +
										"<BR>" +
										"Henrik Tangen, Hälsopedagog, HR-avdelningen." +
										"<BR><BR>" +
										"Kursen är avgiftsfri och sker på arbetstid och förutsätter medgivande från din närmsta chef." +
										"<BR><BR>" +
										"<B>Anmälan</B>" +
										"<BR>" +
										"Anmälan görs på senast den 29/1 till <A HREF=\"mailto:mariette.veideskog@karolinska.se?subject=Kost och rörelsekurs\">mariette.veideskog@karolinska.se</A>." +
										"</DIV>");
								}
								#endregion

								#region Bra värden
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Friskvård</B> <SPAN STYLE=\"color:#CC0000\">(om bra hälsa, sover bra, ingen diabetesrisk)</SPAN><BR>Du är välkommen att delta i friskvårdens vanliga utbud. Klicka på länken för mer information:<BR><A HREF=\"http://inuti.karolinska.se/templates/Page____100041.aspx\" TARGET=\"_blank\">http://inuti.karolinska.se/templates/Page____100041.aspx</A>");
								#endregion
								
								#endregion
								
								SurveyIntro.Text += FB.ToString();
							}
							#endregion
						}
						else if(1==0 && surveyID == 66)
						{
							// Neutral, ingen Findrisk
							// + FÖREGÅENDE MÄTNING

							#region webbqps
							FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

							#region Rygg/nacke
							bool Qback = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
								);
							bool Qneck = 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								(
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
								|| 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
								|| 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
								);
							bool QbnSleep = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
							bool QbnWork = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
							bool QbnWorse = 
								oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
								&& 
								oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
								|| 
								oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
								&& 
								oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
							if(Qback || Qneck)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qback)
								{
									FB.Append("Rygg");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("Nacke");
								}
								FB.Append("</B><BR>Du har angivit att du har besvär från ");
								if(Qback)
								{
									FB.Append("ryggen");
									if(Qneck)
									{
										FB.Append(" och ");
									}
								}
								if(Qneck)
								{
									FB.Append("nacken");
								}
								FB.Append(" samt att dessa besvär ");
								if(QbnWorse)
								{
									FB.Append("förvärras av arbetet");
									if(QbnSleep || QbnWork)
									{
										FB.Append(" och att besvären ");
									}
								}
								if(QbnSleep || QbnWork)
								{
									FB.Append("varit så pass svåra att du haft svårt ");
									if(QbnSleep)
									{
										FB.Append("att sova");
										if(QbnWork)
										{
											FB.Append(" och ");
										}
									}
									if(QbnWork)
									{
										FB.Append("utföra ditt arbete");
									}
								}
								FB.Append(". Om du inte redan har behandling, rekommenderas du att kontakta sjukgymnast.");
							}
							#endregion

							#region Smoke/Hosta/Pip
							bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
							bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
							bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

							if(Qsmoke)
							{
								if(Qhosta || Qpip)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan.");
								}
							}
							else if(Qpip || Qhosta)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
								if(Qhosta)
								{
									FB.Append("Långvarig hosta");
									if(Qpip)
									{
										FB.Append(" och ");
									}
								}
								if(Qpip)
								{
									FB.Append("Pip i bröstet");
								}
								FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare för en bedömning.");
							}
							#endregion
	
							#region Alkohol
							bool Qalco = 
								(
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
								||
								oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
								) 
								&& 
								(
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
								||
								oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
								||
								oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
								||
								oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
								);
							if(Qalco)
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
									"<BR>" +
									"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
									"<BR><BR>" +
									"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>.");
							}
							#endregion

							#region Utbrändhet
							bool Qburnout = false;
							float score = 0f;
							string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 1; break;
										case 362: score += 2; break;
										case 363: score += 3; break;
										case 360: score += 4; break;
									}
								}
							}
							qos = ("Q382O114,Q383O114").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 361: score += 4; break;
										case 362: score += 3; break;
										case 363: score += 2; break;
										case 360: score += 1; break;
									}
								}
							}
							if(score/5 > 2.6)
							{
								Qburnout = true;
							}

							bool Qpbs = false;
							score = 0f;
							qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
							foreach(string s in qos)
							{
								if(oldValues.Contains(s))
								{
									switch(Convert.ToInt32("0" + (string)oldValues[s]))
									{
										case 367: score += 5; break;
										case 363: score += 4; break;
										case 368: score += 3; break;
										case 369: score += 2; break;
										case 361: score += 1; break;
									}
								}
							}
							if(score/qos.Length > 3.25)
							{
								Qpbs = true;
							}

							bool Qdepr = 
								oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
								&& 
								(
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
								||
								oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
								||
								oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
								||
								oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
								||
								oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
								||
								oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
								||
								oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
								);

							if(Qburnout)
							{
								if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
										"<BR>" +
										"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder känna sig sliten och nedstämd av olika skäl, men om du haft besvär en längre tid och inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
								}
								else if(Qpbs)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Stress</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. " +
										"Det är helt normalt att vid enstaka tillfällen eller under kortare perioder känna sig stressad och sliten av olika skäl, men om du haft besvär en längre tid och inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
								}
								else
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Stress</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. " +
										"Det är helt normalt att vid enstaka tillfällen eller under kortare perioder känna sig stressad och sliten av olika skäl, men om du haft besvär en längre tid och inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
								}
							}
							else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder känna sig nedstämd av olika skäl, men om du haft besvär en längre tid och inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare.");
							}
							#endregion

							#region Sleep
							if(oldValues.Contains("Q374O86"))
							{
								bool QsleepI = false, QpreviaI = false;

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								{
									case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
									case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar.<BR>"); break;
									case 312: QsleepI = true; FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
									case 313: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
									case 314: QsleepI = true; QpreviaI = true; FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare."); break;
								}
							}
							#endregion

							#region Health
							if(oldValues.Contains("Q331O98"))
							{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								bool QpreviaI = false;

								switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								{
									case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
									case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
									case 316: QpreviaI = true; FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									case 317: QpreviaI = true; FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
								}
							}
							#endregion

							#region BMI
							double Qbmi = 0;
							if(
								oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
								&&
								oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
								)
							{
								Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.");
								if(HttpContext.Current.Request.QueryString["PAID"] != null)
								{
									rs = Db.sqlRecordSet("SELECT " +
										"a1.ValueDecimal, " +
										"a2.ValueDecimal " +
										"FROM Answer a " +
										"INNER JOIN AnswerValue a1 ON a1.AnswerID = a.AnswerID " +
										"INNER JOIN AnswerValue a2 ON a2.AnswerID = a.AnswerID " +
										"WHERE a.AnswerID = " + Convert.ToInt32(HttpContext.Current.Request.QueryString["PAID"]) + " " +
										"AND a1.QuestionID = 314 " +
										"AND a1.OptionID = 83 " +
										"AND a2.QuestionID = 313 " +
										"AND a2.OptionID = 82 " +
										"AND a1.DeletedSessionID IS NULL " +
										"AND a2.DeletedSessionID IS NULL");
									if(rs.Read())
									{
										FB.Append(" Vid förra mätningen var ditt BMI " + Math.Round(rs.GetDecimal(0) / (rs.GetDecimal(1)/100 * rs.GetDecimal(1)/100),1) + ".");
									}
									rs.Close();
								}
								FB.Append("<BR><BR>" +
									"<TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5>" +
									"<TR><TD style=\"font-size:9px;\"><B>Klassifikation</B></td><TD style=\"font-size:9px;\"><B>(alternativ benämning)</B></td><TD style=\"font-size:9px;\"><B>BMI (kg/m2)</B></td><TD style=\"font-size:9px;\"><B>Hälsorisk</B></TD></TR>" +
									"<TR><TD style=\"font-size:9px;\">Undervikt</td><TD style=\"font-size:9px;\">&nbsp;</td><TD style=\"font-size:9px;\">&lt; 18,5</td><TD style=\"font-size:9px;\">Riskerna varierar beroende på orsak till undervikten</TD></TR>" +
									"<TR><TD style=\"font-size:9px;\">Normalvikt</td><TD style=\"font-size:9px;\">&nbsp;</td><TD style=\"font-size:9px;\">18,5 - 24,9</td><TD style=\"font-size:9px;\">Normalrisk</TD></TR>" +
									"<TR><TD style=\"font-size:9px;\">Övervikt</td><TD style=\"font-size:9px;\">&nbsp;</td><TD style=\"font-size:9px;\">25 - 29,9</td><TD style=\"font-size:9px;\">Lätt ökad</TD></TR>" +
									"<TR><TD style=\"font-size:9px;\"><I>Fetma</I></td><TD style=\"font-size:9px;\"><I>Obesitas/ kraftig övervikt</I></td><TD style=\"font-size:9px;\"><I>&ge; 30</I></td><TD style=\"font-size:9px;\"><I>Måttligt till mycket ökad</I></TD></TR>" +
									"<TR><TD style=\"font-size:9px;\">Fetma klass I</td><TD style=\"font-size:9px;\">Fetma</td><TD style=\"font-size:9px;\">30,0 - 34,9</td><TD style=\"font-size:9px;\">Måttligt ökad, ökad risk</TD></TR>" +
									"<TR><TD style=\"font-size:9px;\">Fetma klass II</td><TD style=\"font-size:9px;\">Kraftig/svar fetma</td><TD style=\"font-size:9px;\">35,0 - 39,9</td><TD style=\"font-size:9px;\">Hög, kraftigt ökad risk</TD></TR>" +
									"<TR><TD style=\"font-size:9px;\">Fetma klass III</td><TD style=\"font-size:9px;\">Extrem fetma</td><TD style=\"font-size:9px;\">&ge; 40</td><TD style=\"font-size:9px;\">Mycket hög, extrem riskökning</TD></TR>" +
									"</TABLE>");
							}
							#endregion
							#endregion

							string PREV = "";
							if(HttpContext.Current.Request.QueryString["PPRID"] != null && HttpContext.Current.Request.QueryString["PAID"] != null)
							{
								string unitLast = "Samtliga svarande, förra mätningen";
								string youLast = "Ditt förra svar";
								string youNow = "Ditt svar nu";
								unitLast = HttpContext.Current.Server.HtmlEncode(unitLast).Replace("&", "_0_").Replace("#", "_1_");
								youLast = HttpContext.Current.Server.HtmlEncode(youLast).Replace("&", "_0_").Replace("#", "_1_");
								youNow = HttpContext.Current.Server.HtmlEncode(youNow).Replace("&", "_0_").Replace("#", "_1_");

								PREV = feedback.renderFeedback(1,surveyID,unitLast,unitLast,Convert.ToInt32(HttpContext.Current.Request.QueryString["PPRID"]),"",false,Convert.ToInt32(HttpContext.Current.Request.QueryString["PAID"]),answerID,youLast,youNow,"FFFFFF");

								SurveyIntro.Text += FB.ToString() + 
									"<BR><BR><B STYLE=\"font-size:16px;\">Frågor och svar</B><br>Här nedan följer en redovisning av hur du svarade denna gång respektive vid förra enkättillfället (om du besvarade enkäten vid förra tillfället). Utöver detta redovisas även snittvärden där samtliga svaranden vid förra enkättillfället ingår som underlag." +
									PREV.Replace("class=\"eform_area\"","").Replace(" class=\"eform_ques_outer\"","").Replace(" class=\"eform_ques\"","").Replace("BGCOLOR=FFFFFF&","");
							}
							else
							{
								SurveyIntro.Text += FB.ToString();
							}
							
							FB.Append("<div style=\"page-break-before:always\">&nbsp;</div>");
							FB.Append(PREV.Replace("<br><br>","").Replace("<p>","<br>").Replace("</p>",""));
								
						}
						else if(surveyID == 97)
						{
							// Tyréns

							if(HttpContext.Current.Request.QueryString["ShowAllFeedback"] == null)
							{
								#region webbqps
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294
									);
								bool Qneck = 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									(
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294 
									|| 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294 
									|| 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294
									);
								bool QbnSleep = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q341O90") && Convert.ToInt32("0" + (string)oldValues["Q341O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q346O90") && Convert.ToInt32("0" + (string)oldValues["Q346O90"]) == 294;
								bool QbnWork = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q342O90") && Convert.ToInt32("0" + (string)oldValues["Q342O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q347O90") && Convert.ToInt32("0" + (string)oldValues["Q347O90"]) == 294;
								bool QbnWorse = 
									oldValues.Contains("Q337O90") && Convert.ToInt32("0" + (string)oldValues["Q337O90"]) == 294 
									&& 
									oldValues.Contains("Q343O90") && Convert.ToInt32("0" + (string)oldValues["Q343O90"]) == 294 
									|| 
									oldValues.Contains("Q339O90") && Convert.ToInt32("0" + (string)oldValues["Q339O90"]) == 294 
									&& 
									oldValues.Contains("Q348O90") && Convert.ToInt32("0" + (string)oldValues["Q348O90"]) == 294;
								if(Qback || Qneck)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qback)
									{
										FB.Append("Rygg");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("Nacke");
									}
									FB.Append("</B><BR>Du har angivit att du har besvär från ");
									if(Qback)
									{
										FB.Append("ryggen");
										if(Qneck)
										{
											FB.Append(" och ");
										}
									}
									if(Qneck)
									{
										FB.Append("nacken");
									}
									FB.Append(" samt att dessa besvär ");
									if(QbnWorse)
									{
										FB.Append("förvärras av arbetet");
										if(QbnSleep || QbnWork)
										{
											FB.Append(" och att besvären ");
										}
									}
									if(QbnSleep || QbnWork)
									{
										FB.Append("varit så pass svåra att du haft svårt ");
										if(QbnSleep)
										{
											FB.Append("att sova");
											if(QbnWork)
											{
												FB.Append(" och ");
											}
										}
										if(QbnWork)
										{
											FB.Append("utföra ditt arbete");
										}
									}
									FB.Append(". Du rekommenderas att kontakta sjukgymnast via vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510.");
								}
								#endregion

								#region Smoke/Hosta/Pip
								bool Qhosta = oldValues.Contains("Q349O90") && Convert.ToInt32("0" + (string)oldValues["Q349O90"]) == 294;
								bool Qpip = oldValues.Contains("Q350O90") && Convert.ToInt32("0" + (string)oldValues["Q350O90"]) == 294;
								bool Qsmoke = oldValues.Contains("Q370O90") && Convert.ToInt32("0" + (string)oldValues["Q370O90"]) == 294;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det. Vår sjukvårdsförsäkring Skandia Lifeline Access har telefon 020-515510 (vårdplanering).");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510.");
									}
								}
								else if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = 
									(
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 340 
									||
									oldValues.Contains("Q364O108") && Convert.ToInt32("0" + (string)oldValues["Q364O108"]) == 341
									) 
									&& 
									(
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 133
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 134
									||
									oldValues.Contains("Q208O41") && Convert.ToInt32("0" + (string)oldValues["Q208O41"]) == 135
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 133
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 134
									||
									oldValues.Contains("Q210O41") && Convert.ToInt32("0" + (string)oldValues["Q210O41"]) == 135
									||
									oldValues.Contains("Q213O42") && Convert.ToInt32("0" + (string)oldValues["Q213O42"]) == 138
									);
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = false;
								float score = 0f;
								string[] qos = ("Q380O114,Q381O114,Q384O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 1; break;
											case 362: score += 2; break;
											case 363: score += 3; break;
											case 360: score += 4; break;
										}
									}
								}
								qos = ("Q382O114,Q383O114").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 361: score += 4; break;
											case 362: score += 3; break;
											case 363: score += 2; break;
											case 360: score += 1; break;
										}
									}
								}
								if(score/5 > 2.6)
								{
									Qburnout = true;
								}

								bool Qpbs = false;
								score = 0f;
								qos = ("Q401O116,Q402O116,Q403O116,Q404O116").Split(',');
								foreach(string s in qos)
								{
									if(oldValues.Contains(s))
									{
										switch(Convert.ToInt32("0" + (string)oldValues[s]))
										{
											case 367: score += 5; break;
											case 363: score += 4; break;
											case 368: score += 3; break;
											case 369: score += 2; break;
											case 361: score += 1; break;
										}
									}
								}
								if(score/qos.Length > 3.25)
								{
									Qpbs = true;
								}

								bool Qdepr = 
									oldValues.Contains("Q393O122") && Convert.ToInt32("0" + (string)oldValues["Q393O122"]) == 294 
									&& 
									(
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 364
									||
									oldValues.Contains("Q387O115") && Convert.ToInt32("0" + (string)oldValues["Q387O115"]) == 365
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 364
									||
									oldValues.Contains("Q388O115") && Convert.ToInt32("0" + (string)oldValues["Q388O115"]) == 365
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 364
									||
									oldValues.Contains("Q389O115") && Convert.ToInt32("0" + (string)oldValues["Q389O115"]) == 365
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 364
									||
									oldValues.Contains("Q390O115") && Convert.ToInt32("0" + (string)oldValues["Q390O115"]) == 365
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 364
									||
									oldValues.Contains("Q391O115") && Convert.ToInt32("0" + (string)oldValues["Q391O115"]) == 365
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 364
									||
									oldValues.Contains("Q392O115") && Convert.ToInt32("0" + (string)oldValues["Q392O115"]) == 365
									);

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en undersökning.");
									}
									else if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en undersökning.");
									}
									else
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en undersökning.");
									}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en undersökning.");
								}
								#endregion

								#region Sleep
								if(oldValues.Contains("Q374O86"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
										"<BR>" +
										"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510."); break;
									}
								}
								#endregion

								#region Health
								if(oldValues.Contains("Q331O98"))
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
										"<BR>" +
										"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
										"<BR><BR>");

									switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
								}
								#endregion

								double Qbmi = 0;
								if(
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									)
								{
									Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
										"<BR>" +
										"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är " + Math.Round(Qbmi,1) + "</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");
								}

								int Qscore = 0;

								#region Findrisk
								if(
									(
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 295 
									||
									oldValues.Contains("Q354O104") && Convert.ToInt32("0" + (string)oldValues["Q354O104"]) == 334 
									)
									&&
									oldValues.Contains("Q314O83") && (string)oldValues["Q314O83"] != ""	// weight
									&&
									oldValues.Contains("Q313O82") && (string)oldValues["Q313O82"] != ""	// height
									&&
									oldValues.Contains("Q538O82") && (string)oldValues["Q538O82"] != ""	// waist
									&&
									oldValues.Contains("Q310O79") && (string)oldValues["Q310O79"] != ""	// gender
									&&
									oldValues.Contains("Q311O81") && (string)oldValues["Q311O81"] != ""	// age
									&&
									oldValues.Contains("Q368O109") && (string)oldValues["Q368O109"] != ""	// act1, A=342, B=343
									&&
									oldValues.Contains("Q369O110") && (string)oldValues["Q369O110"] != ""	// act2, A=322,346, B=322
									)
								{
									int Qage = Convert.ToInt32(Convert.ToDouble(strFloatToStr((string)oldValues["Q311O81"])));
									bool Qfemale = ((string)oldValues["Q310O79"] == "255");
		
									//double Qbmi = Convert.ToDouble(strFloatToStr((string)oldValues["Q314O83"])) / (Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100 * Convert.ToDouble(strFloatToStr((string)oldValues["Q313O82"]))/100);
									double Qwaist = Convert.ToDouble(strFloatToStr((string)oldValues["Q538O82"]));
									bool Qnomotion = false;
									if(((string)oldValues["Q368O109"] == "342") && (((string)oldValues["Q369O110"] == "322") || ((string)oldValues["Q369O110"] == "346")))
									{
										Qnomotion = true;
									}
									if(((string)oldValues["Q368O109"] == "343") && ((string)oldValues["Q369O110"] == "322"))
									{
										Qnomotion = true;
									}
									bool Qnoveggies = oldValues.Contains("Q539O134") && Convert.ToInt32("0" + (string)oldValues["Q539O134"]) == 417;
									bool Qbp = 
										oldValues.Contains("Q352O104") && Convert.ToInt32("0" + (string)oldValues["Q352O104"]) == 294 
										&& 
										oldValues.Contains("Q356O90") && Convert.ToInt32("0" + (string)oldValues["Q356O90"]) == 294;
									bool Qbs = oldValues.Contains("Q638O90") && Convert.ToInt32("0" + (string)oldValues["Q638O90"]) == 294;

									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 428)
										Qscore += 3;
									if(oldValues.Contains("Q639O137") && Convert.ToInt32("0" + (string)oldValues["Q639O137"]) == 429)
										Qscore += 5;

									if(Qage >= 65)
									{
										Qscore += 4;
									}
									else if(Qage >= 55)
									{
										Qscore += 3;
									}
									else if(Qage >= 45)
									{
										Qscore += 2;
									}

									if(Qbmi > 30)
									{
										Qscore += 3;
									}
									else if(Qbmi >= 25)
									{
										Qscore += 1;
									}
		
									if(Qfemale && Qwaist > 88 || !Qfemale && Qwaist > 102)
									{
										Qscore += 4;
									}
									else if(Qfemale && Qwaist >= 80 || !Qfemale && Qwaist >= 94)
									{
										Qscore += 3;
									}
									if(Qnomotion)
									{
										Qscore += 2;
									}
									if(Qnoveggies)
									{
										Qscore += 1;
									}
									if(Qbp)
									{
										Qscore += 2;
									}
									if(Qbs)
									{
										Qscore += 5;
									}

									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									FB.Append("<BR><BR>" +
										"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
										"<BR><BR>" +
										"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								}
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
							else
							{
								#region webbqps all
								FB.Append("<B STYLE=\"font-size:20px;\">Återkoppling</B>");

								#region Rygg/nacke
								bool Qback = true;
								bool Qneck = true;
								bool QbnSleep = true;
								bool QbnWork = true;
								bool QbnWorse = true;
								if(Qback || Qneck)
								{
									for(int i1=0; i1<2; i1++)
									{
										Qback = !Qback;
										for(int i2=0; i2<2; i2++)
										{
											Qneck = !Qneck;
											for(int i3=0; i3<2; i3++)
											{
												QbnSleep = !QbnSleep;
												for(int i4=0; i4<2; i4++)
												{
													QbnWork = !QbnWork;
													for(int i5=0; i5<2; i5++)
													{
														QbnWorse = !QbnWorse;

														if((Qback || Qneck) && (QbnSleep || QbnWork || QbnWorse))
														{
															FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
															if(Qback)
															{
																FB.Append("Rygg");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("Nacke");
															}
															FB.Append("</B><BR>Du har angivit att du har besvär från ");
															if(Qback)
															{
																FB.Append("ryggen");
																if(Qneck)
																{
																	FB.Append(" och ");
																}
															}
															if(Qneck)
															{
																FB.Append("nacken");
															}
															FB.Append(" samt att dessa besvär ");
															if(QbnWorse)
															{
																FB.Append("förvärras av arbetet");
																if(QbnSleep || QbnWork)
																{
																	FB.Append(" och att besvären ");
																}
															}
															if(QbnSleep || QbnWork)
															{
																FB.Append("varit så pass svåra att du haft svårt ");
																if(QbnSleep)
																{
																	FB.Append("att sova");
																	if(QbnWork)
																	{
																		FB.Append(" och ");
																	}
																}
																if(QbnWork)
																{
																	FB.Append("utföra ditt arbete");
																}
															}
															FB.Append(". Du rekommenderas att kontakta sjukgymnast via vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510.");
														}
													}
												}
											}
										}
									}
								}
								#endregion
								
								FB.Append("<BR>");
								
								#region Smoke/Hosta/Pip
								bool Qhosta = true;
								bool Qpip = true;
								bool Qsmoke = true;

								if(Qsmoke)
								{
									if(Qhosta || Qpip)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
										if(Qhosta)
										{
											FB.Append("Långvarig hosta");
											if(Qpip)
											{
												FB.Append(" och ");
											}
										}
										if(Qpip)
										{
											FB.Append("Pip i bröstet");
										}
										FB.Append("</B><BR>Dina svar visar att du har symtom som skulle kunna bero på din rökning. Om du inte redan har sökt läkarhjälp, rekommenderar vi att du gör det. Vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Rökning</B><BR>Som du säkert vet, är rökning riskabelt för hälsan. Om du vill ha hjälp med att sluta röka rekommenderas du att kontakta din husläkare eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510.");
									//}
								}
								//else if(Qpip || Qhosta)
								if(Qpip || Qhosta)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">");
									if(Qhosta)
									{
										FB.Append("Långvarig hosta");
										if(Qpip)
										{
											FB.Append(" och ");
										}
									}
									if(Qpip)
									{
										FB.Append("Pip i bröstet");
									}
									FB.Append("</B><BR>Symtomen långvarig hosta och pip i bröstet kan vara symtom på astma. Om du inte du redan har behandling, rekommenderar vi att du söker din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en bedömning.<BR>");
								}
								#endregion
	
								#region Alkohol
								bool Qalco = true;
								if(Qalco)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Alkohol</B>" +
										"<BR>" +
										"I vår kultur ingår ofta alkohol i den sociala samvaron och kan ha flera positiva effekter. Dina svar talar för att alkoholen medför problem i ditt liv. Om du gör något åt situationen nu kan du få god hjälp. Om du väntar för länge med att ta i tu med detta kan problemen bli långvariga och förvärras." +
										"<BR><BR>" +
										"Du kan läsa mer om alkoholvanor på följande länkar: <A TARGET=\"_blank\" HREF=\"http://www.alna.se\">www.alna.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.stressochalkohol.se\">www.stressochalkohol.se</A>, <A TARGET=\"_blank\" HREF=\"http://www.escreen.se\">www.escreen.se</A>." +
										"<BR><BR>" +
										"Nedan finns information om vart du kan vända dig för råd och stöd." +
										"<BR><BR>" +
										"<DIV STYLE=\"background-color:#FFFFFF;padding:15px;border:1px solid #888888;\">" +
										"<B STYLE=\"font-size:16px;\">Stöd från Alkohollinjen</B>" +
										"<BR><BR>" +
										"Alkohollinjen erbjuder stöd per telefon." +
										"<BR><BR>" +
										"Funderar du över dina alkoholvanor? Ring oss så får du prata med våra behandlare. Om du behöver hjälp för att förändra dina vanor kan vi ge dig stöd. Det är kostnadsfritt." +
										"<BR><BR>" +
										"De som vänder sig till Alkohollinjen kan välja mellan två alternativ:" +
										"<BR>" +
										"- Att antingen ringa för rådgivning när du själv tycker att du behöver det, eller" +
										"<BR>" +
										"- Att vid ett antal tillfällen bli uppringd för rådgivning och uppföljning." +
										"<BR><BR>" +
										"Telefon 020-84 44 48" +
										"<BR>" +
										"Mejladress: <A HREF=\"mailto:info@alkohollinjen.se\">info@alkohollinjen.se</A>" +
										"<BR><BR>" +
										"Vilka svarar på Alkohollinjen?" +
										"<BR>" +
										"Bland rådgivarna finns allmänläkare, sjuksköterskor, mentalskötare, psykologer, hälsopedagoger och folkhälsovetare." +
										"<BR><BR>" +
										"Alkohollinjens öppettider kommer inledningsvis att vara måndag-torsdag kl 16:00-19:00." +
										"</DIV>");
								}
								#endregion

								#region Utbrändhet
								bool Qburnout = true;
								bool Qpbs = true;
								bool Qdepr = true;

								if(Qburnout)
								{
									if(Qdepr)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utmattningsdepression</B>" +
											"<BR>" +
											"Dina svar talar för att du kan ha symtom på depression. Nuförtiden kan depressioner behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en undersökning.");
									}
									//else if(Qpbs)
									if(Qpbs)
									{
										FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
											"<BR>" +
											"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
											"Risken för långvariga besvär ökar påtagligt om man har så höga krav på sig själv att man inte tar sig tid för att vila och återhämta sig. " +
											"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en undersökning.");
									}
									//else
									//{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Utbrändhet</B>" +
										"<BR>" +
										"Dina svar visar att du har symtom som tyder på en hög stressnivå. Långvarig stress utan tillräcklig återhämtning kan leda till utbrändhet eller utmattningssyndrom. " +
										"Det finns bra belägg för att en utbränningsprocess kan stoppas upp. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en undersökning.");
									//}
								}
								else if(Qdepr)
								{
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Nedstämdhet</B>" +
										"<BR>" +
										"Dina svar tyder på att du verkar känna dig nedstämd just nu. Nuförtiden kan nedstämdhet behandlas med mycket gott resultat. Om du inte redan har en läkarkontakt, föreslår vi att du tar kontakt med din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en undersökning.");
								}
								#endregion

								FB.Append("<BR>");

								#region Sleep
								//if(oldValues.Contains("Q374O86"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Sömn</B>" +
									"<BR>" +
									"Sömnen är vår viktigaste resurs för återhämtning och är väsentlig bland annat för att bevara hälsa, välbefinnande och prestationsförmåga. Under sömnen insöndras flera viktiga hormoner som reparerar, läker och bygger upp kroppen. Om sömnen under en längre period är störd löper man stor risk för att på sikt drabbas av olika stressrelaterade sjukdomar." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q374O86"]))
								for(int i=310; i<=314; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din sömn är Bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 311: FB.Append("Du har angivit att din sömn är Ganska bra, vilket tyder på att din sömn och återhämtning är god; att du generellt sett somnar lätt, sover gott och känner dig utvilad när du vaknar."); break;
										case 312: FB.Append("Du har angivit att din sömn är varken är bra eller dålig. Om du upplever att du återkommande har svårt att somna, sova gott eller inte är utvilad när du vaknar finns det anledning att förbättra din sömn för att på sikt bevara hälsa och välbefinnande. Det är i sådana fall viktigt att tänka på att varva ned minst två timmar före sänggåendet. Man kan dessutom förbättra sömnkvaliteten genom att regelbundet genomföra andnings- och avslappningsövningar före sänggåendet."); break;
										case 313: FB.Append("Du har angivit att din sömn är Ganska dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510."); break;
										case 314: FB.Append("Du har angivit att din sömn är Dålig, vilket generellt sett speglar något/några av följande symtom: svårigheter att somna, dålig sömnkvalitet, trötthet vid uppvaknande och att man inte känner sig utvilad. Dessa symtom signalerar ett tydligt behov av att se över sömnen. Det är helt normalt att vid enstaka tillfällen eller under kortare perioder sova dåligt av olika skäl, men om du haft sömnbesvär en längre tid behöver dessa signaler tas på allvar. Du kan börja med att reflektera över om det finns uppenbara anledningar till att du sover dåligt. Om du är osäker på hur du ska hantera dina sömnproblem rekommenderar vi dig att kontakta din husläkare eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510."); break;
									}
									if(i != 314)
									{
										FB.Append("<BR>");
									}
									FB.Append("<BR>");
								}
								//}
								#endregion

								#region Health
								//if(oldValues.Contains("Q331O98"))
								//{
								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Hälsa</B>" +
									"<BR>" +
									"Det är numer väletablerat att självskattad hälsa är en viktig indikator för hur man kommer att må i framtiden. Om man bedömer sin hälsa som ganska bra eller bra har man betydligt större chans att bevara/förbättra sin hälsa i framtiden jämfört med dem som skattat den egna hälsan som dålig." +
									"<BR><BR>");

								//switch(Convert.ToInt32("0" + (string)oldValues["Q331O98"]))
								for(int i=310; i<=317; i++)
								{
									switch(i)
									{
										case 310: FB.Append("Du har angivit att din hälsa är Bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 311: FB.Append("Du har angivit att din hälsa är Ganska bra och verkar således ha en hälsosam livsstil och/eller må ganska bra. Personer med din skattning har störst sannolikhet att bevara eller öka sin hälsa i framtiden."); break;
										case 315: FB.Append("Du har angivit att din hälsa varken är bra eller dålig, vilket betyder att det kan finnas en risk för att din hälsa försämras ytterligare i framtiden. Eftersom självskattad hälsa är ett sammanfattande mått på både fysiskt och mentalt välbefinnande rekommenderar vi att du ser över din livsstil, till exempel vad gäller motion, sömn, och matvanor."); break;
										case 316: FB.Append("Du har angivit att din hälsa är Ganska dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
										case 317: FB.Append("Du har angivit att din hälsa är Dålig. Om det inte är fråga om en tillfällig nedgång i hur du mår, och om du inte redan har läkarkontakt, rekommenderar vi att du kontaktar din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en diskussion av ditt hälsotillstånd och vad som eventuellt kan göras för att förbättra det."); break;
									}
									if(i != 312 && i != 313 && i != 314 && i != 317)
									{
										FB.Append("<BR><BR>");
									}
								}
								//}
								#endregion

								FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">BMI</B>" +
									"<BR>" +
									"Body-mass index (BMI) eller kroppsmasseindex är det mått man oftast använder för att definiera övervikt. <B>Ditt BMI är XX</B>.<BR><BR><TABLE CELLSPACING=0 BORDER=1 CELLPADDING=5><TR><TD><B>Klassifikation</B></td><TD><B>(alternativ benämning)</B></td><TD><B>BMI (kg/m2)</B></td><TD><B>Hälsorisk</B></TD></TR><TR><TD>Undervikt</td><TD>&nbsp;</td><TD>&lt; 18,5</td><TD>Riskerna varierar beroende på orsak till undervikten</TD></TR><TR><TD>Normalvikt</td><TD>&nbsp;</td><TD>18,5 - 24,9</td><TD>Normalrisk</TD></TR><TR><TD>Övervikt</td><TD>&nbsp;</td><TD>25 - 29,9</td><TD>Lätt ökad</TD></TR><TR><TD><I>Fetma</I></td><TD><I>Obesitas/ kraftig övervikt</I></td><TD><I>&ge; 30</I></td><TD><I>Måttligt till mycket ökad</I></TD></TR><TR><TD>Fetma klass I</td><TD>Fetma</td><TD>30,0 - 34,9</td><TD>Måttligt ökad, ökad risk</TD></TR><TR><TD>Fetma klass II</td><TD>Kraftig/svar fetma</td><TD>35,0 - 39,9</td><TD>Hög, kraftigt ökad risk</TD></TR><TR><TD>Fetma klass III</td><TD>Extrem fetma</td><TD>&ge; 40</td><TD>Mycket hög, extrem riskökning</TD></TR></TABLE>");

								#region Findrisk
								int Qscore = 0;
								for(int i=0; i<5; i++)
								{
									switch(i)
									{
										case 0: Qscore = 0; break;
										case 1: Qscore = 7; break;
										case 2: Qscore = 12; break;
										case 3: Qscore = 15; break;
										case 4: Qscore = 21; break;
									}
									FB.Append("<BR><BR><B STYLE=\"font-size:16px;\">Diabetes</B> <B STYLE=\"color:#CC0000;\">Ej diabetes diagnos, Findrisk score = " + Qscore + "</B>" +
										"<BR>");
									if(Qscore > 20)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper mycket stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 50% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en noggrannare bedömning av blodsocker (både fasteglukos och glukosbelastning alternativt blodsockret efter en måltid). Det visar om du eventuellt har symtomfri diabetes.");
									}
									else if(Qscore >= 15)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du löper stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 33% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes. Vi föreslår därför att du kontaktar din husläkare, eller vår sjukvårdsförsäkring: Skandia Lifeline Access, vårdplanering 020-515510, för en noggrannare bedömning av risken.");
									}
									else if(Qscore >= 12)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en måttlig risk att drabbas av typ-2 diabetes. Uppskattningsvis 17% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else if(Qscore >= 7)
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du har en något förhöjd risk att drabbas av typ-2 diabetes. Uppskattningsvis 4% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
									else
									{
										FB.Append("Dina sammanvägda poäng av livsstil och ärftliga faktorer antyder att du inte löper särskilt stor risk att drabbas av typ-2 diabetes. Uppskattningsvis 1% insjuknar. Regelbunden och måttlig motion samt god kosthållning reducerar risken att insjukna i diabetes.");
									}
								}
								FB.Append("<BR><BR><B STYLE=\"color:#CC0000;\">(Ej diabetes diagnos)</B><BR>" +
									"Typ 2-diabetes (vuxendiabetes, åldersdiabetes) är en allvarlig och ärftlig sjukdom. Men man kan i hög grad påverka diabetesrisken genom livsstilen. Övervikt, särskilt bukfetma, fysisk inaktivitet, dåliga matvanor och rökning ökar risken att få typ 2-diabetes." +
									"<BR><BR>" +
									"Både högre ålder och ärftliga faktorer kan öka risken för typ 2-diabetes och dessa faktorer kan man inte påverka. Däremot kan man påverka de övriga riskfaktorerna såsom till exempel övervikt, bukfetma, fysisk inaktivitet, matvanor och rökning. Genom livsstilen kan man helt och hållet förhindra eller åtminstone skjuta upp typ 2-diabetes så långt fram i tiden som möjligt. Om man har diabetes i släkten ska man vara extra noga med att hålla vikten med åren. Fett runt midjan, så kallad bukfetma, utgör en extra stor risk. Det kan ta tid innan man märker av symtom från typ 2-diabetes.");
								#endregion

								#endregion

								SurveyIntro.Text += FB.ToString();
							}
						}
							#endregion
						else
						{
							#region Generic
							rs = Db.sqlRecordSet("SELECT " +
								"rp.ReportPartID, " +
								"ISNULL(rpl.SubjectJapaneseUnicode,rpl.Subject), " +
								"ISNULL(rpl.HeaderJapaneseUnicode,rpl.Header), " +
								"ISNULL(rpl.FooterJapaneseUnicode,rpl.Footer), " +
								"rp.Type " +
								"FROM ProjectRound pr " +
								"INNER JOIN Report r ON pr.IndividualReportID = r.ReportID " +
								"INNER JOIN ReportPart rp ON rp.ReportID = r.ReportID " +
								"INNER JOIN ReportPartLang rpl ON rp.ReportPartID = rpl.ReportPartID AND rpl.LangID = " + langID + " " +
								"WHERE pr.ProjectRoundID = " + projectRoundID);
							if(rs.Read())
							{
								do
								{
									if(rs.GetInt32(4) != 8 || 1 < Db.sqlGetInt32("SELECT COUNT(DISTINCT dbo.cf_yearMonthDay(a.EndDT)) FROM Answer a WHERE a.EndDT IS NOT NULL AND a.ProjectRoundUserID = " + projectRoundUserID))
									{
										FB.Append((SurveyIntro.Text != "" ? "<br><br>" : "") + "<b style=\"font-size:18px;\">" + rs.GetString(1) + "</b><br>");

										if(!rs.IsDBNull(2) && rs.GetString(2) != "")
											FB.Append("<br>" + rs.GetString(2).Replace("\r","").Replace("\n","<br>") + "<br>");
					
										FB.Append("<img src=\"" + surveyURL + "/reportImage.aspx?RPID=" + rs.GetInt32(0) + "&AK=" + answerKey + "\"><br>");
					
										if(!rs.IsDBNull(3) && rs.GetString(3) != "")
											FB.Append(rs.GetString(3).Replace("\r","").Replace("\n","<br>") + "<br>");
									}
								}
								while(rs.Read());

								SurveyIntro.Text += FB.ToString();
							}
							else
							{
								SurveyIntro.Text = thankYou;
							}
							rs.Close();
							#endregion
						}

						if(FB.Length > 0)
						{
							exportPDF(FB.ToString(),answerKey,(HttpContext.Current.Request.QueryString["GenerateDownloadFeedback"] != null ? HttpContext.Current.Request.QueryString["GenerateDownloadFeedback"].ToString() : ""));

							((HtmlAnchor)FixedButtons.FindControl("DownloadPDF")).Visible = showPDF;
							((HtmlAnchor)FixedButtons.FindControl("SendPDF")).Visible = showPDF && hasEmail;
							((HtmlAnchor)FixedButtons.FindControl("SendPDF2")).Visible = showPDF && !hasEmail;
							((HtmlAnchor)FixedButtons.FindControl("PrintPage")).Visible = true;
						}

						if(feedbackAlert)
						{
							Db.sqlExecute("UPDATE Answer SET FeedbackAlert = 1 WHERE AnswerID = " + answerID);
						}


					}
					#endregion
				}
				else if(save)
				{
					if(useCode)
					{
						switch(langID)
						{
							case 1:		SurveyIntro.Text = "Enkäten har sparats men ej skickats. Du tar fram enkäten igen genom att använda samma länk och kod som tidigare."; break;
							default:	SurveyIntro.Text = "The survey has been saved, but not submitted. You can bring the form back by using the same link and code as again."; break;
						}
					}
					else
					{
						switch(langID)
						{
							case 1:		SurveyIntro.Text = "Enkäten har sparats men ej skickats. Du tar fram enkäten igen genom att använda länken nedan.<br><br><A HREF=\"" + surveyURL + "/submit.aspx?K=" + userKey + "\">" + surveyURL + "/submit.aspx?K=" + userKey + "</A>"; break;
							default:	SurveyIntro.Text = "The survey has been saved, but not submitted. You can bring the form back by using the link below.<br><br><A HREF=\"" + surveyURL + "/submit.aspx?K=" + userKey + "\">" + surveyURL + "/submit.aspx?K=" + userKey + "</A>"; break;
						}
					}
					if(hasEmail && !useCode)
					{
						switch(langID)
						{
							case 1:		SurveyIntro.Text += "<br><br>Du kan även klicka på knappen här till höger för att få länken skickad till dig."; break;
							default:	SurveyIntro.Text += "<br><br>You can also click the button here on the right to have the link sent to you."; break;
						}
						((HtmlAnchor)FixedButtons.FindControl("SendLink")).Visible = true;
					}
				}
				else
				{
					if(SurveyIntro.Text == "")
					{
						SurveyIntro.Text = surveyIntro;
					}

					Survey.Controls.Add(new LiteralControl(assembleSurvey(showMode,ref clearFunctions,ref globalDependency,ref pageCX,ref pageCompletedCX,ref answerKey,ref totalCX,ref pageMandatoryCX,ref pageMissingCX,ref vasArr,ref vasDict)));

					Page.RegisterStartupScript("DEPENDENCY","<script type=\"text/JavaScript\" language=\"JavaScript\">" + clearFunctions + globalDependency.ToString() + "</SCRIPT>");

					((LinkButton)FixedButtons.FindControl("SubmitButton")).Visible = (currentPage == pageCX && !showMode);
					((LinkButton)FixedButtons.FindControl("PrevButton")).Visible = !(pageCX == 1 || currentPage == 1);
					((LinkButton)FixedButtons.FindControl("NextButton")).Visible = !(pageCX == 1 || currentPage == pageCX);
				}
			}

			if(hasEmail && (currentPage > 1 || surveyID == 74 || surveyID == 76) && !showMode)
			{
				((LinkButton)FixedButtons.FindControl("FixedButton")).Visible = true;
			}

			if(save || finished || surveyID == 0 || langID == 0)
			{
				((LinkButton)FixedButtons.FindControl("FixedButton")).Visible = false;
				((LinkButton)FixedButtons.FindControl("SubmitButton")).Visible = false;
				((LinkButton)FixedButtons.FindControl("NextButton")).Visible = false;
				((LinkButton)FixedButtons.FindControl("PrevButton")).Visible = false;
				//((HtmlAnchor)FixedButtons.FindControl("Cancel")).Visible = false;
				((HtmlAnchor)FixedButtons.FindControl("Close")).Visible = true;
			}

			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"CP\" value=\"" + currentPage + "\">"));
			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"pCX\" value=\"" + pageCX + "\">"));
			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"AK\" value=\"" + answerKey + "\">"));

			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"tCX\" value=\"" + totalCX + "\">"));
			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"tcCX\" value=\"" + (showMode ? totalCX : totalCompletedCX) + "\">"));
			//Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"COMPLETEDcount\" value=\"" + pageCompletedCX + "\">"));
			//Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"AID\" value=\"" + answerID + "\">"));
			//Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"VAScount\" value=\"" + vasCX + "\">"));
			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"FORCEDcount\" value=\"" + pageMandatoryCX + "\">"));
			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"FORCEDcompleted\" value=\"" + (!newAnswer ? pageMandatoryCX - pageMissingCX : 0) + "\">"));
			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"VASinactive\" value=\"" + (showMode ? "1" : "0") + "\">"));
			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"VASarr\" value=\"" + vasArr + "\">"));
			Survey.Controls.Add(new LiteralControl("<input type=\"hidden\" name=\"Warn\" value=\"" + (warn ? "1" : "0") + "\">"));
			Survey.Controls.Add(new LiteralControl(vasDict));

			if(SurveyIntro.Text != "")
			{
				SurveyIntro.Text = "" +
					"<div class=\"eform_area\"><p>Information</p></div>" + 
					"<div class=\"eform_ques\"><TABLE class=\"eform_ques_outer\" BORDER=\"0\" CELLSPACING=\"0\" CELLPADDING=\"0\"><TR><TD>" +
					SurveyIntro.Text +
					"</TD></TR></TABLE></div>" +
					"<div id=\"footer\">&nbsp;</div>";
			}
		}

		private string assembleSurvey(bool showMode, ref string clearFunctions,ref System.Text.StringBuilder globalDependency,ref int pageCX, ref int pageCompletedCX,ref string answerKey, ref int totalCX, ref int pageMandatoryCX, ref int pageMissingCX, ref string vasArr, ref string vasDict)
		{
			int cx = 0, qCX = 0, oCX = 0;
			bool firstInBox = false;

			System.Text.StringBuilder sb = new System.Text.StringBuilder();
			System.Text.StringBuilder hidden = new System.Text.StringBuilder();

			SqlDataReader rs = Db.sqlRecordSet("SELECT " +
				"sq.SurveyQuestionID, " +	// 0
				"sq.OptionsPlacement, " +	// 1
				"q.FontFamily, " +			// 2
				"q.FontSize, " +			// 3
				"q.FontDecoration, " +		// 4
				"q.FontColor, " +			// 5
				"q.Underlined, " +			// 6
				"ISNULL(ISNULL(ql2.QuestionJapaneseUnicode,ql2.Question),ISNULL(ql.QuestionJapaneseUnicode,ql.Question)) AS Question, " +			// 7
				"q.QuestionID, " +			// 8
				"q.Box, " +					// 9
				"sq.NoCount, " +			// 10
				"sq.RestartCount, " +		// 11
				"(SELECT COUNT(*) FROM SurveyQuestionOption sqo WHERE sqo.OptionPlacement = 1 AND sqo.SurveyQuestionID = sq.SurveyQuestionID), " +	// 12
				"(SELECT COUNT(*) FROM SurveyQuestionOption sqo INNER JOIN QuestionOption qo ON sqo.QuestionOptionID = qo.QuestionOptionID WHERE qo.Hide = 1 AND sqo.SurveyQuestionID = sq.SurveyQuestionID), " +	// 13
				"sq.NoBreak, " +			// 14
				"sq.BreakAfterQuestion, " +	// 15
				"q.Internal, " +			// 16
				"q.Variablename, " +		// 17
				"sq.Variablename, " +		// 18
				(allInOnePage ? "NULL " : "sq.PageBreakBeforeQuestion ") + "," +		// 19
				"s.ClearQuestions, " +		// 20
				//"(SELECT COUNT(*) FROM SurveyQuestionOption sqo INNER JOIN QuestionOption qo ON sqo.QuestionOptionID = qo.QuestionOptionID WHERE qo.Hide = 0 AND sqo.SurveyQuestionID = sq.SurveyQuestionID) " +	// 20
				"q.LimitWidth, " +			// 21
				"q.FillRemainderWithBgColor " +	// 22
				"FROM SurveyQuestion sq " +
				"INNER JOIN Survey s ON sq.SurveyID = s.SurveyID " +
				"INNER JOIN Question q ON sq.QuestionID = q.QuestionID " +
				"INNER JOIN QuestionLang ql ON q.QuestionID = ql.QuestionID AND ql.LangID = " + langID  + " " +
				"LEFT OUTER JOIN SurveyQuestionLang ql2 ON sq.SurveyQuestionID = ql2.SurveyQuestionID AND ql2.LangID = ql.LangID " + 
				"WHERE sq.SurveyID = " + surveyID + " " +
				(!first ? "AND (sq.ExtendedFirst IS NULL OR sq.ExtendedFirst = 0) " : "" ) +
				"ORDER BY sq.SortOrder");
			while(rs.Read())
			{
				bool skip = preQuestions.Contains(rs.GetInt32(8));

				if(!rs.IsDBNull(19) && rs.GetInt32(19) == 1)
				{
					pageCX++;
				}
				if(!rs.IsDBNull(11) && rs.GetInt32(11) == 1)
				{
					// Used to number the questions
					cx = 0;
				}

				if(pageCX != currentPage || skip)
				{
					SqlDataReader rs2 = Db.sqlRecordSet("SELECT " + 
						"qo.QuestionID, " +			// 0
						"qo.OptionID " +			// 1
						"FROM SurveyQuestionOption sqo " + 
						"INNER JOIN QuestionOption qo ON sqo.QuestionOptionID = qo.QuestionOptionID " + 
						"INNER JOIN [Option] o ON qo.OptionID = o.OptionID " + 
						"WHERE qo.Hide IS NULL AND sqo.SurveyQuestionID = " + rs.GetInt32(0) + " " + 
						"ORDER BY sqo.SortOrder");
					if(rs2.Read())
					{
						if(!skip && (rs.IsDBNull(10) || rs.GetInt32(10) == 0))
						{
							cx++;
						}

						do
						{
							if(!skip)
							{
								totalCX++;
							}
							hidden.Append(("<INPUT TYPE=\"hidden\" NAME=\"Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "\" VALUE=\"" + (oldValues.Contains("Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)) ? oldValues["Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)].ToString() : "") + "\">"));
							/*SqlDataReader rs3 = Db.sqlRecordSet("SELECT " +
								"sqi.SurveyQuestionID, " +
								"sqi.OptionComponentID " +
								"FROM SurveyQuestionIf sqi " +
								"WHERE sqi.QuestionID = " + rs2.GetInt32(0) + " " +
								"AND sqi.OptionID = " + rs2.GetInt32(1) + " " +
								"AND sqi.SurveyID = " + surveyID + " " +
								"ORDER BY sqi.SurveyQuestionID");
							if(rs3.Read())
							{
								int SQID = 0;
								int nextSQID = 0;
								string tmpDependency = "";
								do
								{
									if(!dependentQuestions.Contains(rs3.GetInt32(0)))
										dependentQuestions.Add(rs3.GetInt32(0));

									nextSQID = rs3.GetInt32(0);

									if(SQID != 0 && SQID != nextSQID)
									{
										globalDependency += "vi('" + SQID + "',(" + tmpDependency + "));";
										tmpDependency = "";
									}
									else if(SQID == nextSQID)
									{
										tmpDependency += "||";
									}
									tmpDependency += "isVal(document.forms[0].Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "," + rs3.GetInt32(1) + ")";

									SQID = rs3.GetInt32(0);
								}
								while(rs3.Read());

								globalDependency += "vi('" + SQID + "',(" + tmpDependency + "));";
							}
							rs3.Close();
							*/
							if(HttpContext.Current.Request.QueryString["SAH"] == null)
							{
								// Questions depending on this question
								SqlDataReader rs3 = Db.sqlRecordSet("SELECT " +
									"DISTINCT " +
									"sqii.SurveyQuestionID, " +
									"sqii.OptionComponentID, " +
									"sqii.QuestionID, " +
									"sqii.OptionID, " +
									"sqii.ConditionAnd, " +
									"sqii.SurveyQuestionIfID " +
									"FROM SurveyQuestionIf sqi " +
									"LEFT OUTER JOIN SurveyQuestionIf sqii ON sqi.SurveyQuestionID = sqii.SurveyQuestionID " +
									"WHERE sqi.QuestionID = " + rs2.GetInt32(0) + " " +
									"AND sqi.OptionID = " + rs2.GetInt32(1) + " " +
									"AND sqi.SurveyID = " + surveyID + " " +
									"ORDER BY " +
									"sqii.SurveyQuestionID, " +
									"sqii.OptionComponentID, " +
									"sqii.QuestionID, " +
									"sqii.OptionID, " +
									"sqii.ConditionAnd, " +
									"sqii.SurveyQuestionIfID");
								if(rs3.Read())
								{
									int SQID = 0;
									int nextSQID = 0;
									string tmpDependency = "", tempScript = "";
									do
									{
										if(!dependentQuestions.Contains(rs3.GetInt32(0)))
											dependentQuestions.Add(rs3.GetInt32(0));

										nextSQID = rs3.GetInt32(0);

										if(SQID != 0 && SQID != nextSQID)
										{
											tempScript = "vi('" + SQID + "',(" + tmpDependency + "));";
											if(globalDependency.ToString().IndexOf(tempScript) < 0)
											{
												globalDependency.Append(tempScript);
											}
											tmpDependency = "";
										}
										else if(SQID == nextSQID)
										{
											tmpDependency += (rs3.IsDBNull(4) ? "||" : "&&");;
										}
										tmpDependency += "isVal(document.forms[0].Q" + rs3.GetInt32(2) + "O" + rs3.GetInt32(3) + "," + rs3.GetInt32(1) + ")";

										SQID = rs3.GetInt32(0);
									}
									while(rs3.Read());

									tempScript = "vi('" + SQID + "',(" + tmpDependency + "));";
									if(globalDependency.ToString().IndexOf(tempScript) < 0)
									{
										globalDependency.Append(tempScript);
									}
								}
								rs3.Close();
							}
						}
						while(rs2.Read());
					}
					rs2.Close();
				}
				else
				{
					// Used to determine if this is first question in box
					qCX++;

					if(qCX == 1 || rs.GetInt32(9) == 1)
					{
						if(qCX > 1)
						{
							sb.Append(("</table>"));
							sb.Append(("</div>"));
							sb.Append(("<div id=\"footer\">&nbsp;</div>"));
						}
						sb.Append(("<div id=\"Q" + rs.GetInt32(0) + "A\" class=\"eform_area\"><p>" + rs.GetString(7) + "</p></div>"));
						sb.Append(("<div id=\"Q" + rs.GetInt32(0) + "Q\" class=\"eform_ques\">"));
						sb.Append(("<TABLE class=\"eform_ques_outer\" BORDER=\"0\" CELLSPACING=\"0\" CELLPADDING=\"0\">"));

						firstInBox = true;
					}
					else
					{
						if(!firstInBox)
						{
							if(rs.IsDBNull(14))
							{
								sb.Append(("<TR id=\"Q" + rs.GetInt32(0) + "S1\"><TD colspan=\"3\"><img src=\"submitImages/null.gif\" width=\"1\" height=\"10\"></td></tr>"));
							}
							if(rs.GetInt32(6) == 1)
							{
								sb.Append(("<TR id=\"Q" + rs.GetInt32(0) + "S2\"><TD colspan=\"3\" bgcolor=\"#CECECE\"><img src=\"submitImages/null.gif\" width=\"1\" height=\"1\"></td></tr>"));
								sb.Append(("<TR id=\"Q" + rs.GetInt32(0) + "S3\"><TD colspan=\"3\"><img src=\"submitImages/null.gif\" width=\"1\" height=\"10\"></td></tr>"));
							}
						}
						firstInBox = false;

						string o = "";
						string h = "";
						int w = 0;

						bool showHeaderRow = (0 < rs.GetInt32(12));

						string clearFunction = "", clearLink = "";

						SqlDataReader rs2 = Db.sqlRecordSet("SELECT " + 
							"qo.QuestionID, " +			// 0
							"qo.OptionID, " +			// 1
							"sqo.OptionPlacement, " +	// 2
							"o.OptionType, " +			// 3
							"ISNULL(sqo.Width,o.Width), " +				// 4
							"o.Height, " +				// 5
							"sqo.Forced, " +			// 6
							"o.InnerWidth, " +			// 7
							"qo.Hide, " +				// 8
							"o.BgColor, " +				// 9
							"sqo.SurveyQuestionOptionID " +	// 10
							"FROM SurveyQuestionOption sqo " + 
							"INNER JOIN QuestionOption qo ON sqo.QuestionOptionID = qo.QuestionOptionID " + 
							"INNER JOIN [Option] o ON qo.OptionID = o.OptionID " + 
							"WHERE sqo.SurveyQuestionID = " + rs.GetInt32(0) + " " + 
							"ORDER BY sqo.SortOrder");
						while(rs2.Read())
						{
							totalCX++;
							if(missingValues.Contains("Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)))
							{
								pageMissingCX++;
							}
							if(oldValues.Contains("Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)) && oldValues["Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)].ToString() != "")
							{
								pageCompletedCX++;
							}
							if(!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1)// && !dependentQuestions.Contains(rs.GetInt32(0)))
							{
								pageMandatoryCX++;
							}

							if(dependentQuestions.Contains(rs.GetInt32(0)))
							{
								#region clear scripts
								if(rs2.IsDBNull(8))
								{
									switch(rs2.GetInt32(3))
									{
										case 1:
										{
											clearFunction += "manRad(document.forms[0].Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "," + (!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1 ? "true" : "false") + "," + (showMode ? "0" : "w") + ");";
											break;
										}
										case 2:
										{
											clearFunction += "manTxt('Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "'," + (!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1 ? "true" : "false") + "," + (showMode ? "0" : "w") + ");";
											break;
										}
										case 3:
										{
											goto case 1;
										}
										case 4:
										{
											goto case 2;
										}
										case 9:
										{
											goto case 2;
										}
									}
								}
								#endregion
							}

							string dependency = "";
							SqlDataReader rs3;
							if(HttpContext.Current.Request.QueryString["SAH"] == null)
							{
								#region Dependency
								rs3 = Db.sqlRecordSet("SELECT " +
									"DISTINCT " +
									"sqii.SurveyQuestionID, " +			// 0
									"sqii.OptionComponentID, " +		// 1
									"sqii.QuestionID, " +				// 2
									"sqii.OptionID, " +					// 3
									"sqii.ConditionAnd, " +				// 4
									"sqii.SurveyQuestionIfID, " +		// 5
									"o.OptionType, " +					// 6
									"ocs.ExportValue, " +				// 7
									"(SELECT COUNT(*) FROM OptionComponents oc WHERE oc.OptionID = sqii.OptionID) AS CX " +
									"FROM SurveyQuestionIf sqi " +
									"LEFT OUTER JOIN SurveyQuestionIf sqii ON sqi.SurveyQuestionID = sqii.SurveyQuestionID " +
									"LEFT OUTER JOIN [Option] o ON sqii.OptionID = o.OptionID " +
									"LEFT OUTER JOIN OptionComponents ocs ON sqii.OptionID = ocs.OptionID AND sqii.OptionComponentID = ocs.OptionComponentID " +
									"WHERE sqi.QuestionID = " + rs2.GetInt32(0) + " " +
									"AND sqi.OptionID = " + rs2.GetInt32(1) + " " +
									"AND sqi.SurveyID = " + surveyID + " " +
									"ORDER BY " +
									"sqii.SurveyQuestionID, " +
									"sqii.OptionComponentID, " +
									"sqii.QuestionID, " +
									"sqii.OptionID, " +
									"sqii.ConditionAnd, " +
									"sqii.SurveyQuestionIfID");
								if(rs3.Read())
								{
									int SQID = 0;
									int nextSQID = 0;
									string tmpDependency = "";
									do
									{
										if(!dependentQuestions.Contains(rs3.GetInt32(0)))
											dependentQuestions.Add(rs3.GetInt32(0));

										nextSQID = rs3.GetInt32(0);

										if(SQID != 0 && SQID != nextSQID)
										{
											dependency += "vi('" + SQID + "',(" + tmpDependency + "));";

											tmpDependency = "";
										}
										else if(SQID == nextSQID)
										{
											tmpDependency += (rs3.IsDBNull(4) ? "||" : "&&");
										}
										switch(rs3.GetInt32(6))
										{
											case 1:
											case 3:
												tmpDependency += "isVal(document.forms[0].Q" + rs3.GetInt32(2) + "O" + rs3.GetInt32(3) + "," + rs3.GetInt32(1) + ")";
												break;
											case 9:
												int segment = 100/(rs3.GetInt32(8)-1);
												int thisVal = rs3.GetInt32(7);
//												if(thisVal < segment/2) { thisVal = segment/2; }
//												if(thisVal > (100-segment/2)) { thisVal = 100-segment/2; }
												tmpDependency += "isValBetween(" +
													"document.forms[0].Q" + rs3.GetInt32(2) + "O" + rs3.GetInt32(3) + 
													"," + Convert.ToInt32(thisVal-segment/2) + 
													"," + Convert.ToInt32(thisVal+segment/2) + 
													")";
												break;
										}

										SQID = rs3.GetInt32(0);
									}
									while(rs3.Read());

									dependency += "vi('" + SQID + "',(" + tmpDependency + "));";

									if(globalDependency.ToString().IndexOf(dependency) < 0)
									{
										globalDependency.Append(dependency);
									}
								}
								rs3.Close();
								#endregion
							}

							oCX++;

							o += "<TD " + (!rs2.IsDBNull(9) ? "BGCOLOR=\"#" + rs2.GetString(9) + "\" " : "") + "VALIGN=\"TOP\" ALIGN=\"RIGHT\">";
							if(HttpContext.Current.Request.QueryString["Annotated"] != null)
							{
								o += "<div onclick=\"this.style.display='none';\" style=\"position:absolute;border:1px solid #00000; background-color:#FFFFE1; padding:3px;\">Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "</div>";
							}
							o += "<TABLE BORDER=\"0\" CELLSPACING=\"0\" CELLPADDING=\"0\">";
							if(showHeaderRow)
							{
								h += "<TD " + (!rs2.IsDBNull(9) ? "BGCOLOR=\"#" + rs2.GetString(9) + "\" " : "") + "VALIGN=\"TOP\" ALIGN=\"RIGHT\"><TABLE BORDER=\"0\" CELLSPACING=\"0\" CELLPADDING=\"0\"><TR>";
							}
							if(rs2.GetInt32(2) <= 5)
							{
								o += "<TR>";
							}
							else
							{
								w += rs2.GetInt32(4);
								if(showHeaderRow)
								{
									h += "<TD>&nbsp;</TD>";
								}
							}
					
							bool firstComponent = true;
							int compCX = 0;

							rs3 = Db.sqlRecordSet("SELECT " +
								"ocs.OptionComponentID, " +
								"ISNULL(ISNULL(sqocl.TextJapaneseUnicode,sqocl.Text),ISNULL(ocl.TextJapaneseUnicode,ocl.Text)) AS t, " +
								"ocs.ExportValue " +
								"FROM OptionComponents ocs " +
								"INNER JOIN OptionComponent oc ON ocs.OptionComponentID = oc.OptionComponentID " +
								"INNER JOIN OptionComponentLang ocl ON oc.OptionComponentID = ocl.OptionComponentID AND ocl.LangID = " + langID + " " +
								"LEFT OUTER JOIN SurveyQuestionOptionComponent sqoc ON oc.OptionComponentID = sqoc.OptionComponentID AND sqoc.SurveyQuestionOptionID = " + rs2.GetInt32(10) + " " +
								"LEFT OUTER JOIN SurveyQuestionOptionComponentLang sqocl ON sqocl.LangID = ocl.LangID AND oc.OptionComponentID = sqocl.OptionComponentID AND sqocl.SurveyQuestionOptionID = " + rs2.GetInt32(10) + " " +
								"WHERE ocs.OptionID = " + rs2.GetInt32(1) + " AND sqoc.Hide IS NULL " +
								"ORDER BY ocs.SortOrder");
							while(rs3.Read())
							{
								compCX++;

								if(showHeaderRow)
								{
									if(rs2.GetInt32(2) == 1)
									{
										h += "<TD ALIGN=\"CENTER\" WIDTH=\"" + rs2.GetInt32(4) + "\">";
										if(!rs.IsDBNull(13) && rs.GetInt32(13) > 0)
										{
											// When hide in some option, put this in to stretch
											h += "<img src=\"img/null.gif\" width=\"" + rs2.GetInt32(4) + "\" height=\"1\"><br>";
										}
										h += rs3.GetString(1);
										h += "</TD>";
									}
								}
								bool textbox = false;
								if(rs2.IsDBNull(8) && (rs2.GetInt32(3) == 2 || rs2.GetInt32(3) == 4))
								{
									textbox = true;
								}
								if(rs2.GetInt32(2) > 5)
								{
									o += "<TR><TD WIDTH=\"" + rs2.GetInt32(4) + "\"" + (textbox ? " style=\"white-space:nowrap;\"" : "") + ">";
								}
								else if(rs2.GetInt32(3) == 2 || rs2.GetInt32(3) == 4)
								{
									w += rs2.GetInt32(4);
									o += "<TD ALIGN=\"LEFT\" WIDTH=\"" + rs2.GetInt32(4) + "\"" + (textbox ? " style=\"white-space:nowrap;\"" : "") + ">";
								}
								else
								{
									w += rs2.GetInt32(4);
									o += "<TD ALIGN=\"CENTER\" WIDTH=\"" + rs2.GetInt32(4) + "\"" + (textbox ? " style=\"white-space:nowrap;\"" : "") + ">";
								}

								if(rs2.IsDBNull(8))
								{
									switch(rs2.GetInt32(3))
									{
										case 1:
										{
											if(!rs.IsDBNull(13) && rs.GetInt32(13) > 0)
											{
												o += "<img src=\"img/null.gif\" width=\"" + rs2.GetInt32(4) + "\" height=\"1\"><br>";
											}
											if(HttpContext.Current.Request.QueryString["Annotated"] != null)
											{
												o += "<div onclick=\"this.style.display='none';\" style=\"position:absolute;border:1px solid #00000; background-color:#FFFFE1; padding:3px;\">" + rs3.GetInt32(2) + " (" + rs3.GetInt32(0) + ")</div>";
											}
											o += "<INPUT" + (oldValues.Contains("Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)) && oldValues["Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)].ToString() == rs3.GetInt32(0).ToString() ? " CHECKED" : "") + " TYPE=\"radio\" ONFOCUS=\"setRad(document.forms[0].Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + ");\" ONCLICK=\"" + dependency + "chkRad(document.forms[0].Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "," + (!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1 ? "true" : "false") + ");\" NAME=\"Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "\" VALUE=\"" + rs3.GetInt32(0) + "\"" + (showMode ? " DISABLED" : "") + ">";
											break;
										}
										case 2:
										{
											if(rs2.GetInt32(5) <= 1)
											{
												o += "<INPUT" + (oldValues.Contains("Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)) ? " VALUE=\"" + oldValues["Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)].ToString() + "\"" : "") + " TYPE=\"text\" ONFOCUS=\"setTxt(this.value);\" ONKEYUP=\"chkTxt(this.value," + (!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1 ? "true" : "false") + ");\" NAME=\"Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "\" STYLE=\"width:" + (!rs2.IsDBNull(7) && rs2.GetInt32(7) > 0 ? rs2.GetInt32(7) : rs2.GetInt32(4)) + "px;\"" + (showMode ? " DISABLED" : "") + ">";
											}
											else
											{
												o += "<TEXTAREA NAME=\"Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "\" ONFOCUS=\"setTxt(this.value);\" ONKEYUP=\"chkTxt(this.value," + (!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1 ? "true" : "false") + ");\" STYLE=\"height:" + rs2.GetInt32(5) + "px;width:" + (!rs2.IsDBNull(7) && rs2.GetInt32(7) > 0 ? rs2.GetInt32(7) : rs2.GetInt32(4)) + "px;\"" + (showMode ? " DISABLED" : "") + ">" + (oldValues.Contains("Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)) ? oldValues["Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)].ToString() : "") + "</TEXTAREA>";
											}
											break;
										}
										case 3:
										{
											o += "<INPUT" + (oldValues.Contains("Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)) && oldValues["Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1)].ToString() == rs3.GetInt32(0).ToString() ? " CHECKED" : "") + " TYPE=\"checkbox\" ONFOCUS=\"setRad(document.forms[0].Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + ");\" ONCLICK=\"" + dependency + "chkRad(document.forms[0].Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "," + (!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1 ? "true" : "false") + ");\" NAME=\"Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "\" VALUE=\"" + rs3.GetInt32(0) + "\"" + (showMode ? " DISABLED" : "") + ">";
											break;
										}
										case 4:
										{
											goto case 2;
										}
										case 9:
										{
											if(firstComponent)
											{
												string VAS = "Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1);
												vasArr += (vasArr != "" ? "," : "") + VAS;
												vasDict += "" +
													"<script type=\"text/javascript\">function vas" + VAS + "(){" + dependency + "}</script>" +
													"<input type=\"hidden\" name=\"" + VAS + "\" value=\"" + (oldValues.Contains(VAS) ? oldValues[VAS].ToString() : "NULL") + "\">" +
													"<input type=\"hidden\" name=\"VASf" + VAS + "\" value=\"" + (!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1 ? "1" : "0") + "\">";

												o += "" +
													"<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">" +
													"<tr><td colspan=\"4\"><img src=\"submitImages/null.gif\" width=\"1\" height=\"8\"></td></tr>" +
													"<tr>" +
													"<td width=\"6\"><img src=\"submitImages/VASdot_l.gif\" width=\"6\" height=\"15\"></td>" +
													"<td width=\"330\"><img id=\"VASl" + VAS + "\" src=\"submitImages/VASline.gif\" width=\"330\" height=\"15\" border=\"0\"><img style=\"position:absolute;visibility:hidden;\" id=\"VASk" + VAS + "\" src=\"submitImages/VASknob4.gif\" width=\"4\" height=\"15\"></td>" +
													"<td width=\"6\"><img src=\"submitImages/VASdot_r.gif\" width=\"6\" height=\"15\"></td>" +
													"<td width=\"4\"><input type=\"text\" style=\"display:none;\" name=\"VASv" + VAS + "\" value=\"" + (oldValues.Contains(VAS) ? oldValues[VAS].ToString() : "NULL") + "\"></td>" +
													"</tr>" +
													"<tr>" +
													"<td colspan=\"3\">" +
													"<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">" +
													"<tr>" +
													"<td align=\"left\" style=\"width:[VAS_LEFT_SIZE]px;font-size:11px;\">" + rs3.GetString(1) + "</td>" +
													"[VAS_DESC]" +
													"</tr>" +
													"</table>" +
													"</td>" +
													"</tr>" +
													"</table>";
											}
											else
											{
												o = o.Replace("[VAS_ALIGN]","center").Replace("[VAS_RIGHT_SIZE]","[VAS_MIDDLE_SIZE]").Replace("[VAS_DESC]","<td align=\"[VAS_ALIGN]\" style=\"width:[VAS_RIGHT_SIZE]px;font-size:11px;\">" + rs3.GetString(1) + "</td>[VAS_DESC]");
											}
										}
											break;
									}
									if(rs2.GetInt32(2) == 3 || rs2.GetInt32(2) == 8)
									{
										o += rs3.GetString(1);
									}
								}
								else
								{
									o += "<img src=\"img/null.gif\" width=\"" + rs2.GetInt32(4) + "\" height=\"1\">";
								}
			
								o += "</TD>";

								if(rs2.GetInt32(2) > 5)
								{
									o += "</TR>\r\n";
								}

								firstComponent = false;
							}
							rs3.Close();

							if(!rs.IsDBNull(20) && rs2.IsDBNull(8) && rs2.GetInt32(3) == 1)
							{
								clearLink += " [<a href=\"javascript:manRad(document.forms[0].Q" + rs2.GetInt32(0) + "O" + rs2.GetInt32(1) + "," + (!rs2.IsDBNull(6) && rs2.GetInt32(6) == 1 ? "true" : "false") + "," + (showMode ? "0" : "-1") + ");\">Rensa</a>]";
							}

							o = o.Replace("[VAS_ALIGN]","right").Replace("[VAS_DESC]","");
							switch(compCX)
							{
								case 2:		o = o.Replace("[VAS_LEFT_SIZE]","168").Replace("[VAS_RIGHT_SIZE]","168"); break;
								case 3:		o = o.Replace("[VAS_LEFT_SIZE]","112").Replace("[VAS_RIGHT_SIZE]","112").Replace("[VAS_MIDDLE_SIZE]","112"); break;
								case 4:		o = o.Replace("[VAS_LEFT_SIZE]","65").Replace("[VAS_RIGHT_SIZE]","65").Replace("[VAS_MIDDLE_SIZE]","105"); break;
								case 5:		o = o.Replace("[VAS_LEFT_SIZE]","58").Replace("[VAS_RIGHT_SIZE]","58").Replace("[VAS_MIDDLE_SIZE]","75"); break;
									// not sure about the below
								case 6:		o = o.Replace("[VAS_LEFT_SIZE]","34").Replace("[VAS_RIGHT_SIZE]","34").Replace("[VAS_MIDDLE_SIZE]","68"); break;
								case 7:		o = o.Replace("[VAS_LEFT_SIZE]","34").Replace("[VAS_RIGHT_SIZE]","34").Replace("[VAS_MIDDLE_SIZE]","54"); break;
							
									/*
							
											//400
											case 2:	o = o.Replace("[VAS_LEFT_SIZE]","206").Replace("[VAS_RIGHT_SIZE]","206"); break;
											case 3:	o = o.Replace("[VAS_LEFT_SIZE]","136").Replace("[VAS_RIGHT_SIZE]","136").Replace("[VAS_MIDDLE_SIZE]","140"); break;
											case 5:	o = o.Replace("[VAS_LEFT_SIZE]","71").Replace("[VAS_RIGHT_SIZE]","71").Replace("[VAS_MIDDLE_SIZE]","90"); break;
									
											//500
											case 2:	o = o.Replace("[VAS_LEFT_SIZE]","256").Replace("[VAS_RIGHT_SIZE]","256"); break;
											case 3:	o = o.Replace("[VAS_LEFT_SIZE]","156").Replace("[VAS_RIGHT_SIZE]","156").Replace("[VAS_MIDDLE_SIZE]","200"); break;
											case 5:	o = o.Replace("[VAS_LEFT_SIZE]","64").Replace("[VAS_RIGHT_SIZE]","64").Replace("[VAS_MIDDLE_SIZE]","128"); break;
							
											*/
							}

							if(showHeaderRow)
							{
								h += "</TR></TABLE></TD>";
							}
							if(rs2.GetInt32(2) <= 5)
							{
								o += "</TR>\r\n";
							}
							o += "</TABLE></TD>";
						}
						rs2.Close();

						if(dependentQuestions.Contains(rs.GetInt32(0)))
						{
							clearFunctions += "function clr" + rs.GetInt32(0) + "(w){" + clearFunction + "}";
						}

						string q = "";
						if(HttpContext.Current.Request.QueryString["Annotated"] != null)
						{
							q += "<div onclick=\"this.style.display='none';\" style=\"position:absolute;border:1px solid #00000; background-color:#FFFFE1; padding:3px;\">" + (rs.GetString(18) != "" ? rs.GetString(18) : (rs.GetString(17) != "" ? rs.GetString(17) : rs.GetString(16))) + "</div>";
						}
						q += "<SPAN STYLE=\"";
						switch(rs.GetInt32(2))
						{
							case 1:	q += "font-family: Tahoma;"; break;
							case 2:	q += "font-family: Verdana;"; break;
							case 3:	q += "font-family: Arial;"; break;
							case 4:	q += "font-family: Courier New;"; break;
							case 5:	q += "font-family: Times New Roman;"; break;
						}
						if(rs.GetInt32(3) != 0)
						{
							q += "font-size: " + rs.GetInt32(3) + "px;";
						}
						switch(rs.GetInt32(4))
						{
							case 2:	q += "font-weight: bold;"; break;
							case 3:	q += "font-weight: italic;"; break;
							case 4:	q += "text-decoration: underline;"; break;
							case 5:	q += "text-decoration: line-through;"; break;
						}
						if(missingQuestions.Contains("Q" + rs.GetInt32(8)) && !changePage && IsPostBack)
						{
							q += "color:#CC0000;";
						}
						else if(warnQuestions.Contains("Q" + rs.GetInt32(8)) && !changePage && IsPostBack)
						{
							q += "color:#0000CC;";
						}
						else if(rs.GetString(5) != "")
						{
							q += "color: " + rs.GetString(5) + ";";
						}
						q += "\">" + rs.GetString(7).Replace("\n","<br>") + (!rs.IsDBNull(15) ? "<br>&nbsp;" : "") + "</span>" +
							(clearLink != "" ? "<br/>" + clearLink : "");

						if(rs.GetInt32(6) == 1)
						{
						}

						if(o == "")
						{
							sb.Append(("<TR id=\"Q" + rs.GetInt32(0) + "Q\"><TD COLSPAN=\"2\">" + q + "</TD></TR>\r\n"));
						}
						else
						{
							bool showNum = rs.IsDBNull(10) || rs.GetInt32(10) == 0;

							if(showNum)
							{
								cx++;
							}

							if(h != "")
							{
								sb.Append(("<TR id=\"Q" + rs.GetInt32(0) + "H\">"));
								sb.Append(("<TD>&nbsp;</TD>"));
								sb.Append(("<TD>"));
						
								sb.Append(("<TABLE BORDER=\"0\" CELLSPACING=\"0\" CELLPADDING=\"0\">"));
								sb.Append(("<TR>"));
								sb.Append(("<TD WIDTH=\"" + (558-(showNum?27:0)-w) + "\">&nbsp;</TD>"));
								sb.Append(("" + h + ""));
								sb.Append(("</TR>"));
								sb.Append(("</TABLE>"));
						
								sb.Append(("</TD>"));
								sb.Append(("</TR>\r\n"));
							}

							sb.Append(("<TR id=\"Q" + rs.GetInt32(0) + "Q\">"));

							sb.Append(("<TD VALIGN=\"TOP\" ALIGN=\"RIGHT\"" + (showNum ? " style=\"width:27px;\"" : "") + ">" + (showNum ? cx + "." : "") + "&nbsp;</TD>"));
							sb.Append(("<TD>"));
					
							if(rs.GetInt32(1) == 1)
							{
								sb.Append(("<TABLE BORDER=\"0\" CELLSPACING=\"0\" CELLPADDING=\"0\">"));
								sb.Append(("<TR>"));
								sb.Append(("<TD WIDTH=\"" + (558-(showNum?27:0)-w) + "\" VALIGN=\"TOP\">" + q + "</TD>"));
								sb.Append(("" + o + ""));
								sb.Append(("</TR>"));
								sb.Append(("</TABLE>"));
							}
							else
							{
								if(!rs.IsDBNull(21))
								{
									sb.Append(("<TABLE BORDER=\"0\" CELLSPACING=\"0\" CELLPADDING=\"0\">"));
									sb.Append(("<TR>"));
									sb.Append(("<TD WIDTH=\"" + rs.GetInt32(21) + "\" VALIGN=\"TOP\">" + q + "</TD>"));
									if(!rs.IsDBNull(22))
									{
										sb.Append("<TD" + (rs.IsDBNull(21) ? "" : " WIDTH=\"" + (558-(showNum?27:0)-rs.GetInt32(21)) + "\"") + " BGCOLOR=\"#" + rs.GetString(22) + "\">&nbsp;</TD>");
									}
									sb.Append(("</TR>"));
									sb.Append(("</TABLE>"));
																									}
								else
								{
									sb.Append((q));
								}
								sb.Append(("</TD>"));
								sb.Append(("</TR>\r\n"));
								sb.Append(("<TR id=\"Q" + rs.GetInt32(0) + "A\">"));
								sb.Append(("<TD>&nbsp;</TD>"));
								sb.Append(("<TD>"));
								sb.Append(("<TABLE BORDER=\"0\" CELLSPACING=\"0\" CELLPADDING=\"0\">"));
								sb.Append(("<TR>"));
								sb.Append(("" + o + ""));
								sb.Append(("</TR>"));
								sb.Append(("</TABLE>"));
							}
						
							sb.Append(("</TD>"));
							sb.Append(("</TR>\r\n"));
						}
					}
				}
			}
			rs.Close();

			sb.Append(("</table>"));
			sb.Append(("</div>"));
					
			rs = Db.sqlRecordSet("SELECT Copyright FROM Survey WHERE SurveyID = " + surveyID);
			if(rs.Read() && !rs.IsDBNull(0))
			{
				sb.Append(("<div id=\"footer\">" + rs.GetString(0) + "</div>"));
			}
			rs.Close();

			return sb.ToString() + hidden.ToString();
		}

		private void FixedButton_Click(object sender, EventArgs e)
		{
			save = true;
		}

		private void NextButton_Click(object sender, EventArgs e)
		{
			if(missingOnCurrentPage != 0 || (!warn && warnOnCurrentPage > 0))
			{
				SurveyIntro.Text = "";
				
				if(missingOnCurrentPage > 0)
				{
					SurveyIntro.Text += "<SPAN STYLE=\"color:#CC0000;\">" + missingOnCurrentPage + " " + (missingOnCurrentPage > 1 ? "obligatoriska frågor är obesvarade. Dessa är markerade" : "obligatorisk fråga är obesvarad. Denna är markerad") + " i rött nedan.</SPAN>";
				}

				if(warnOnCurrentPage > 0)
				{
					warn = true;

					if(missingOnCurrentPage > 0)
					{
						SurveyIntro.Text += "<BR><BR>";
						SurveyIntro.Text += "<SPAN STYLE=\"color:#0000CC;\">Utöver dessa finns " + warnOnCurrentPage + " " + (warnOnCurrentPage > 1 ? "icke-obligatoriska frågor som är obesvarade. Dessa är markerade" : "icke-obligatorisk fråga som är obesvarad. Denna är markerad") + " i blått nedan.</SPAN>";
					}
					else
					{
						SurveyIntro.Text += "<SPAN STYLE=\"color:#0000CC;\">Det finns " + warnOnCurrentPage + " " + (warnOnCurrentPage > 1 ? "icke-obligatoriska frågor som är obesvarade. Dessa är markerade" : "icke-obligatorisk fråga som är obesvarad. Denna är markerad") + " i blått nedan. Tryck på nästa igen för att lämna dessa obesvarade.</SPAN>";
					}
				}			
			}
			else
			{
				warn = false;
				changePage = true;
				currentPage++;
			}
		}

		private void PrevButton_Click(object sender, EventArgs e)
		{
			changePage = true;
			warn = true;
			currentPage--;
		}

		private void LangButton_Click(object sender, EventArgs e)
		{
			if(HttpContext.Current.Request.QueryString["LID"] != null)
			{
				HttpContext.Current.Response.Redirect("submit.aspx?" + HttpContext.Current.Request.QueryString.ToString().Replace("LID=" + langID,"LID=" + (langID == 1 ? 2 : 1)),true);
			}
			else if(HttpContext.Current.Request.QueryString != null)
			{
				HttpContext.Current.Response.Redirect("submit.aspx?" + HttpContext.Current.Request.QueryString + "&LID=" + (langID == 1 ? 2 : 1),true);
			}
		}

		public static void exportPDF(string content, string ak)
		{
			exportPDF(content,ak,"");
		}
		public static void exportPDF(string content, string ak, string redirect)
		{
			exportPDF(content,ak,redirect,"");
		}

		protected override void Render(HtmlTextWriter writer)
		{
			System.IO.StringWriter customWriter = new System.IO.StringWriter();

			if(HttpContext.Current.Request.QueryString["MakePDF"] != null)
			{
				string ident = "";
				if(HttpContext.Current.Request.QueryString["Ident"] != null)
				{
//					foreach(string s in HttpContext.Current.Request.QueryString["Ident"].ToString().Split('_'))
//					{
//						ident += "<TR><TD>" + s.Split('$')[0] + "&nbsp;</TD><TD>" + s.Split('$')[1] + "</TD></TR>";
//					}
//					ident = "document.getElementById('eform_header').innerHTML+='<TABLE BORDER=0>" + ident.Replace("\"","") + "</TABLE><br><br>';";
					ident = "document.getElementById('eform_header').innerHTML+='" + HttpContext.Current.Request.QueryString["Ident"].ToString().Replace("_",": ").Replace("$",", ") + "<br><br>';";
				}

				System.IO.StreamReader r = new System.IO.StreamReader(HttpContext.Current.Server.MapPath(".") + "\\submitJs.aspx",System.Text.Encoding.UTF8);
				string scr = r.ReadToEnd();
				r.Close();

				HtmlTextWriter localWriter = new HtmlTextWriter(customWriter);
				base.Render(localWriter);
				string content = customWriter.ToString()
					.Replace("fixedButtonsInit();","" +
						"document.getElementById('fixedButtons').style.display='none';" +
						"document.getElementById('container').style.width='580px';" +
						"document.body.style.textAlign='left';" +
						"document.getElementById('container').style.position='absolute';" +
						"document.getElementById('container').style.left='125px';" +
						"" + ident)
					.Replace("updateButtons(0,true);","")
					.Replace(" onscroll=\"fixedButtonsUpdate();\"","")
					.Replace("display:none;\" name=\"VASv","\" name=\"VASv")
					.Replace(" src=\"submitJs.aspx?LID=" + lang() + "&amp;V=" + version() + "\">",">" + scr.Substring(scr.IndexOf("function VAS"),scr.IndexOf("function updateButtons")-scr.IndexOf("function VAS")))
					.Replace("tObj.style.left = xCoord","tObj.style.left = 20 + xCoord");
				localWriter.Close();
				localWriter = null;
				customWriter.Close();
				customWriter = null;

				string contentBase = "http" + (HttpContext.Current.Request.IsSecureConnection ? "s" : "") + "://" + HttpContext.Current.Request.Url.Host + "/";//"file:///" + HttpContext.Current.Server.MapPath(".").Replace("\\","/") + "/";
				content = content.Replace("URL(","URL(" + contentBase);
				content = content.Replace("href=\"","href=\"" + contentBase);
				content = content.Replace("HREF=\"","href=\"" + contentBase);
				content = content.Replace("src=\"","src=\"" + contentBase);
				content = content.Replace("SRC=\"","src=\"" + contentBase);
				content = content.Replace("background=\"","background=\"" + contentBase);
				content = content.Replace("BACKGROUND=\"","BACKGROUND=\"" + contentBase);

//				System.IO.FileStream fs = new System.IO.FileStream("c:\\temp\\deleteme.html", System.IO.FileMode.Create);
//				System.IO.StreamWriter f = new System.IO.StreamWriter(fs, System.Text.Encoding.UTF8);
//				f.Write(content.ToString());
//				f.Close();
//				fs.Close();

				WebSupergoo.ABCpdf6.Doc theDoc = new WebSupergoo.ABCpdf6.Doc();
				theDoc.HtmlOptions.UseScript = true;
				theDoc.HtmlOptions.PageCacheEnabled = false;
				//theDoc.HtmlOptions.AddLinks = true;
				theDoc.HtmlOptions.Timeout = 600000;
				theDoc.MediaBox.String = "A4";
				theDoc.Rect.String = "A4";
				theDoc.Rect.Inset(0,30);

				theDoc.Page = theDoc.AddPage();
				int obj = theDoc.AddImageHtml(content,true,850,true);
				while(theDoc.Chainable(obj)) 
				{
					theDoc.Page = theDoc.AddPage();
					obj = theDoc.AddImageToChain(obj);
				}

				theDoc.HPos = 0.5;
				theDoc.VPos = 0.5;
				theDoc.Font = theDoc.AddFont("Helvetica");
				theDoc.FontSize = 9;

				for (int i = 1; i <= theDoc.PageCount; i++) 
				{
					theDoc.PageNumber = i;
					theDoc.Flatten();
				}

				if(HttpContext.Current.Request.QueryString["ToDisk"] != null)
				{
					string fname = HttpContext.Current.Server.MapPath("/archive/" + HttpContext.Current.Request.QueryString["MakePDF"] + ".pdf");
					HttpContext.Current.Response.Write(fname);
					theDoc.Save(fname);
				}

				byte[] output = theDoc.GetData();
				theDoc.Clear();
				theDoc.Dispose();
				theDoc = null;

				if(HttpContext.Current.Request.QueryString["ToDisk"] == null)
				{
//					System.IO.FileStream fs = new System.IO.FileStream("c:\\temp\\deleteme.pdf", System.IO.FileMode.Create);
//					fs.Write(output,0,output.Length);
//					fs.Close();

					HttpContext.Current.Response.Clear();
					HttpContext.Current.Response.ClearHeaders();
					HttpContext.Current.Response.Charset = "UTF-8";
					HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.UTF8;
					HttpContext.Current.Response.ContentType = "application/pdf";
					HttpContext.Current.Response.BufferOutput = false;
					HttpContext.Current.Response.Cache.SetCacheability(System.Web.HttpCacheability.Private);	// IE < 9 ssl fix?
					HttpContext.Current.Response.AddHeader("content-length", output.LongLength.ToString());

					string ret = ""; foreach(string s in HttpContext.Current.Request.QueryString["MakePDF"].ToString().Split(' ')) { ret += (ret != "" ? " " : "") + HttpContext.Current.Server.UrlEncode(s); }

					HttpContext.Current.Response.AddHeader("content-disposition", "attachment; filename=" + ret + ".PDF");
					HttpContext.Current.Response.BinaryWrite(output);
					HttpContext.Current.Response.End();
				}
			}
			else
			{
				base.Render(writer);
			}
		}

		public static void exportPDF(string content, string ak, string redirect, string path)
		{
			content = "" +
				"<HTML>" +
				"<HEAD>" +
				"<style type=\"text/css\">" +
				"body, div, td {font-family: Arial, Helvetica, sans-serif; font-size: 12px;}" +
				"body {margin: 0;padding: 0;text-align: center;}" +
				"</style>" +
				"</HEAD>" +
				"<BODY>" +
				"<DIV style=\"text-align:left;margin: 0 auto;width:595px;\">" +
				"" + content.Replace("<br class=\"noprint\">","") + "" +
				"</DIV>" +
				"</BODY>" +
				"</HTML>";

			WebSupergoo.ABCpdf6.Doc theDoc = new WebSupergoo.ABCpdf6.Doc();
			theDoc.HtmlOptions.AddLinks = true;
			theDoc.HtmlOptions.Timeout = 600000;
			theDoc.MediaBox.String = "A4";
			theDoc.Rect.String = "A4";
			theDoc.Rect.Inset(0,30);

			theDoc.Page = theDoc.AddPage();
			int obj = theDoc.AddImageHtml(content,true,850,true);
			while(theDoc.Chainable(obj)) 
			{
				theDoc.Page = theDoc.AddPage();
				obj = theDoc.AddImageToChain(obj);
			}

			theDoc.HPos = 0.5;
			theDoc.VPos = 0.5;
			theDoc.Font = theDoc.AddFont("Helvetica");
			theDoc.FontSize = 9;

			for (int i = 1; i <= theDoc.PageCount; i++) 
			{
				theDoc.PageNumber = i;
				theDoc.Flatten();
			}

			byte[] output = theDoc.GetData();

			if(path == "")
			{
				path = HttpContext.Current.Server.MapPath("/archive");
			}

			if(!System.IO.Directory.Exists(path))
				System.IO.Directory.CreateDirectory(path);
			theDoc.Save(path + "\\" + ak + ".pdf");
			theDoc.Clear();
			theDoc.Dispose();
			theDoc = null;

			if(redirect != "")
			{
				HttpContext.Current.Response.Clear();
				HttpContext.Current.Response.ClearHeaders();
				HttpContext.Current.Response.Charset = "UTF-8";
				HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.UTF8;
				HttpContext.Current.Response.ContentType = "application/pdf";
				HttpContext.Current.Response.AddHeader("content-length", output.LongLength.ToString());
				HttpContext.Current.Response.AddHeader("content-disposition", "attachment; filename=" + redirect + ".PDF");
				HttpContext.Current.Response.BinaryWrite(output);
				HttpContext.Current.Response.End();
			}
		}
	}
}
